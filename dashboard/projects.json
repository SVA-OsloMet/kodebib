[
  {
    "title": "Alternative medier og islam",
    "authors": "Siri Frisli",
    "language": "R",
    "data": "text corpus",
    "methods": [
      "web scraping",
      "topic modeling"
    ],
    "themes": [
      "alternative medier",
      "ytre h\u00f8yre",
      "mixed-methods"
    ],
    "description": "Unders\u00f8ker diskursive trender og endringer i m\u00e5ten alternative medier tilknyttet det norske ytre h\u00f8yre har representert islam \u00e5rene 2003-2021. Les mer her: http://urn.nb.no/URN:NBN:no-98456",
    "folder": "altmedia-islam-topic-modeling",
    "files": [
      "altmedia-islam-topic-modeling/Bearbeiding.R",
      "altmedia-islam-topic-modeling/Analyse.R",
      "altmedia-islam-topic-modeling/Innsamling.R",
      "altmedia-islam-topic-modeling/README.md"
    ],
    "code": "# file: Bearbeiding.R\npakker <- c(\"rvest\", \"dplyr\", \"tibble\", \"httr\", \"writexl\", \"tm\", \"tidytext\", \"stringr\",\r\n            \"stopwords\", \"ggplot2\", \"topicmodels\", \"SnowballC\", \"quanteda\", \"lubridate\",\r\n            \"stm\", \"plotly\", \"geometry\", \"stminsights\", \"Rtsne\", \"rsvd\", \"forcats\", \"purrr\",\r\n            \"factoextra\", \"RColorBrewer\", \"wordcloud\", \"corrr\", \"labelled\", \"tidyverse\",\r\n            \"tidystm\", \"stminsights\", \"GGally\", \"ggraph\", \"igraph\", \"gridExtra\")\r\nlapply(pakker, library, character.only = TRUE)\r\nset.seed(1234)\r\n\r\n# Laster inn og fikser korpuset til Rights\r\nrights <- read.csv(\"rightscvs.csv\", colClasses = c(\"character\", \"character\", \"character\"))\r\nrights$Publiseringsdato <- dmy(rights$Publiseringsdato)\r\nrights$Publiseringsdato <- as.numeric(rights$Publiseringsdato)\r\n\r\n# Innimellom st\u00e5r navnene til Hege og Rita sammen med HRS i starten av artiklene p\u00e5 rights, som forfatternavn, vil fjerne disse\r\nrights <- rights %>%\r\n  mutate(start = tolower(str_sub(Tekst, 1, 30)),\r\n         hege = str_detect(start, pattern = \"hege\" ),\r\n         storhaug = str_detect(start, pattern = \"storhaug\" ),\r\n         rita = str_detect(start, pattern = \"rita\"),\r\n         karlsen = str_detect(start, pattern = \"karlsen\")) %>%\r\n  mutate( fjernstorhaug = (storhaug & hege) | (rita & karlsen)) %>%\r\n  mutate( Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"Storhaug\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"Hege\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"storhaug\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"hege\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"rita\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"Rita\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"karlsen\"), Tekst),\r\n          Tekst = ifelse(fjernstorhaug, str_remove(Tekst, \"Karlsen\"), Tekst))\r\n\r\nrights <- subset(rights, select = -c(start, hege, storhaug, rita, karlsen, fjernstorhaug))\r\n\r\n# Laster inn og fikser korpuset til Document\r\ndocument <- read.csv(file = \"documentcsv.csv\", colClasses = c(\"character\", \"character\",\r\n                                                              \"character\"))\r\ndocument$Publiseringsdato <- mdy(document$Publiseringsdato)\r\ndocument$Publiseringsdato <- as.numeric(document$Publiseringsdato)\r\n\r\n# Lager ekstra kolonne p\u00e5 hver dataframe med info om hvilken nettside artiklene er fra\r\ndocument <- document %>%\r\n  add_column(Nettside = \"Document\")\r\n\r\nrights <- rights %>%\r\n  add_column(Nettside = \"Rights\")\r\n\r\n# Kombinerer\r\nbegge <- rbind(document, rights)\r\nbegge <- begge[order(begge$Publiseringsdato), ] # Sorterer artiklene etter publiseringsdato\r\n\r\n# Velger \u00e5 kun inkludere ord som refererer direkte til muslimer eller islam\r\nbegge <- begge[grepl(\"muslim|muslimer|muslimene|muslimske|islam|islamistiske|islamske|islamistisk\",\r\n              begge$Tekst, ignore.case = TRUE), ]\r\n# write.csv(begge, \"begge.csv\", row.names = FALSE)\r\n# begge <- read.csv(\"begge.csv\")\r\n\r\n# Liste med ekstra stoppord\r\negne_stoppord <- c(\"m\u00e5\", \"m\u00e5tte\", \"sier\", \"f\u00e5\", \"mer\", \"f\u00e5r\", \"ta\", \"g\u00e5r\", \"gikk\", \"dag\",\r\n                   \"alts\u00e5\", \"\u00e5r\", \"nok\", \"hele\", \"mens\", \"gj\u00f8r\", \"gj\u00f8re\", \"gjort\", \"f\u00e5tt\", \"se\", \"ser\", \"sett\",\r\n                   \"st\u00e5r\", \"fikk\", \"tar\", \"tatt\", \"sa\", \"g\u00e5\", \"vet\", \"the\", \"new\", \"way\", \"all\", \"last\", \"get\",\r\n                   \"why\", \"who\", \"you\", \"me\", \"us\", \"your\", \"mine\", \"will\", \"this\", \"that\", \"u\", \"mest\", \"one\",\r\n                   \"two\", \"have\", \"are\", \"or\", \"without\", \"with\", \"his\", \"to\", \"of\", \"and\", \"in\", \"a\", \"is\", \"on\",\r\n                   \"it\", \"was\", \"as\", \"af\", \"och\", \"sig\", \"att\", \"he\", \"not\", \"be\", \"they\", \"an\", \"\u00e4r\", \"till\",\r\n                   \"inte\", \"we\", \"but\", \"their\", \"jo\", \"f\u00f6r\", \"which\", \"would\", \"its\", \"if\", \"there\", \"scanpix\",\r\n                  \"what\", \"also\", \"said\", \"has\", \"foto\", \"ntb\", \"when\", \"our\", \"than\", \"other\", \"she\", \"can\",\r\n                  \"them\", \"do\", \"by\", \"been\", \"had\", \"out\", \"how\", \"where\", \"were\", \"http\", \"any\", \"those\", \"end\",\r\n                  \"blev\", \"high\", \"blevet\", \"comes\", \"come\", \"vist\", \"del\", \"self\", \"her\", \"on\", \"once\", \"second\",\r\n                  \"if\", \"until\", \"into\", \"from\", \"does\", \"its\", \"his\", \"theirs\", \"them\", \"jag\", \"fr\u00e5n\", \"n\u00e4r\",\r\n                  \"ska\", \"hon\", \"alla\", \"d\u00e4r\", \"vad\", \"andra\", \"vara\", \"hur\", \"nu\", \"finns\", \"ocks\u00e5\", \"nu\",\r\n                  \"n\u00e5got\", \"n\u00e5gon\", \"hvad\", \"nu\", \"havde\", \"noget\", \"mig\", \"blive\", \"nogle\", \"os\", \"vores\", \"h\u00e4r\",\r\n                  \"\u00e4n\", \"\u00f6ver\", \"allt\", \"bara\", \"these\", \"than\", \"him\", \"now\", \"op\", \"ind\", \"uden\", \"g\u00f8re\", \"g\u00f8r\",\r\n                  \"blandt\", \"detta\", \"sedan\", \"efter\", \"deras\", \"mycke\", \"mycket\", \"efter\", \"\u00ebven\", \"s\u00e4ger\",\r\n                  \"utan\", \"sina\", \"fr\u00e5\", \"bliver\", \"siger\", \"fik\", \"nogen\", \"sagde\", \"sige\", \"g\u00e6rne\", \"mer\",\r\n                  \"brug\", \"brugt\", \"about\", \"only\", \"even\", \"mer\", \"brug\", \"giv\", \"giver\", \"seem\", \"like\", \"most\",\r\n                  \"andre\", \"m\u00e5nge\", \"\u00e4ven\", \"m\u00e5st\", \"m\u00e5sta\", \"n\u00e5gre\")\r\n # En del engelske og noen svenske og danske, sammen med litt ekstra norske\r\n\r\nbegge$Tekst <- str_replace_all(begge$Tekst, \"[^[:alnum:]]\", \" \")\r\nbegge$Tekst <- str_replace_all(begge$Tekst, \"[0-9]\", \" \")\r\nbegge$Tekst <- gsub('\\\\b\\\\w{1,2}\\\\b','', begge$Tekst)\r\ncorp_begge <- corpus(begge, text_field = \"Tekst\")\r\n\r\ntokens_begge <- tokens(corp_begge,\r\n remove_punct = TRUE,\r\n remove_symbols = TRUE,\r\n remove_numbers = TRUE,\r\n remove_url = TRUE) %>%\r\n tokens_remove(pattern = c(stopwords(source = \"snowball\", language = \"no\"), egne_stoppord)) %>%\r\n tokens_remove(pattern = c(stopwords(source = \"snowball\", language = \"en\")))\r\n\r\ntokens_begge <- tokens_compound(tokens_begge, phrase(c(\"hege storhaug\", \"joe biden\", \"sylvi\r\n                   listhaug\", \"human rights service\", \"paul collier\", \"abid raja\", \"erna solberg\", \"naser khader\",\r\n                   \"per willy amundsen\", \"bruce bawer\", \"flemming rose\", \"jonas gahr st\u00f8re\", \"donald trump\", \"islam\r\n                   net\", \"saudi arabia\", \"al qaida\", \"stefan l\u00f6fven\", \"islamsk r\u00e5d\", \"george w bush\", \"donald\r\n                   trump\", \"osama bin laden\", \"christian tybring gjedde\", \"hadia tajik\", \"einar gelius\", \"audun\r\n                   lysbakken\", \"theo van gogh\", \"geert wilders\", \"boris johnson\", \"mullah krekar\", \"new york\",\r\n                   \"saddam hussein\", \"charlie hebdo\", \"lars vilks\", \"kurt westergaard\", \"yom kippur\", \"arfan\r\n                   bhatti\", \"anders behring breivik\", \"jyllands posten\", case_insensitive = TRUE)))\r\ntokens_begge <- tokens_wordstem(tokens_begge, language = \"no\")\r\ndfm_begge <- dfm(tokens_begge, tolower = TRUE)\r\nbegge_stm <- convert(dfm_begge, to = \"stm\")\r\n\r\nout_begge <- prepDocuments(begge_stm$documents,\r\n begge_stm$vocab,\r\n begge_stm$meta,\r\n lower.thresh = 20)\r\n# saveRDS(out_begge, \"out_begge.rds\")\r\n# out_begge <- readRDS(\"out_begge.rds\")\r\n\r\ndocs_begge <- out_begge$documents\r\nvocab_begge <- out_begge$vocab\r\nmeta_begge <- out_begge$meta\r\n\r\nout_begge$meta$Nettside <- as.factor(out_begge$meta$Nettside)\r\n # Nettsidene som faktorvariabel med to niv\u00e5er\r\ntable(begge$Nettside)\r\n\r\n# Finne hvor mange emner som er best\r\nstmfinn_begge <- stm(documents = docs_begge,\r\n vocab = vocab_begge,\r\n K = 0,\r\n prevalence = ~Nettside + s(Publiseringsdato),\r\n content = ~Nettside,\r\n max.em.its = 1000,\r\n data = meta_begge,\r\n init.type = \"Spectral\",\r\n set.seed(1234),\r\n verbose = TRUE)\r\n# 48 emner, oppleves som for mange\r\n\r\ntm10_begge <- stm(documents = docs_begge,\r\n vocab = vocab_begge,\r\n K = 10,\r\n prevalence = ~Nettside + s(Publiseringsdato),\r\n content = ~Nettside,\r\n max.em.its = 1000,\r\n data = meta_begge,\r\n init.type = \"Spectral\",\r\n set.seed(1234),\r\n verbose = TRUE)\r\n# saveRDS(stm10_begge, \"stm10_begge.rds\")\r\n\r\nstm15_begge <- stm(documents = docs_begge,\r\n vocab = vocab_begge,\r\n K = 15,\r\n prevalence = ~Nettside + s(Publiseringsdato),\r\n content = ~Nettside,\r\n max.em.its = 1000,\r\n data = meta_begge,\r\n init.type = \"Spectral\",\r\n set.seed(1234),\r\n verbose = TRUE)\r\n# saveRDS(stm15_begge, \"stm15_begge.rds\")\r\n\r\nstm20_begge <- stm(documents = docs_begge,\r\n vocab = vocab_begge,\r\n K = 20,\r\n prevalence = ~Nettside + s(Publiseringsdato),\r\n content = ~Nettside,\r\n max.em.its = 1000,\r\n data = meta_begge,\r\n init.type = \"Spectral\",\r\n set.seed(1234),\r\n verbose = TRUE)\r\n# saveRDS(stm20_begge, \"stm20_begge.rds\")\r\n\r\nstm25_begge <- stm(documents = docs_begge,\r\n vocab = vocab_begge,\r\n K = 25,\r\n prevalence = ~Nettside + s(Publiseringsdato),\r\n content = ~Nettside,\r\n max.em.its = 1000,\r\n data = meta_begge,\r\n init.type = \"Spectral\",\r\n set.seed(1234),\r\n verbose = TRUE)\r\n# saveRDS(stm25_begge, \"stm25_begge.rds\")\r\n\r\nstm30_begge <- stm(documents = docs_begge,\r\n vocab = vocab_begge,\r\n K = 30,\r\n prevalence = ~Nettside + s(Publiseringsdato),\r\n content = ~Nettside,\r\n max.em.its = 1000,\r\n data = meta_begge,\r\n init.type = \"Spectral\",\r\n set.seed(1234),\r\n verbose = TRUE)\r\n# saveRDS(stm30_begge, \"stm30_begge.rds\")\r\n\r\n# Lagrer emnene med ord\r\nemner20 <- sageLabels(stm20_begge, n = 20) # Endre n etter hvor mange ord per emne vil ha med\r\nsink(\"emner20.txt\", append = FALSE, split = TRUE)\r\nprint(emner20)\r\nsink()\n\n# file: Analyse.R\npakker <- c(\"rvest\", \"dplyr\", \"tibble\", \"httr\", \"writexl\", \"tm\", \"tidytext\", \"stringr\",\r\n            \"stopwords\", \"ggplot2\", \"topicmodels\", \"SnowballC\", \"quanteda\", \"lubridate\",\r\n            \"stm\", \"plotly\", \"geometry\", \"stminsights\", \"Rtsne\", \"rsvd\", \"forcats\", \"purrr\",\r\n            \"factoextra\", \"RColorBrewer\", \"wordcloud\", \"corrr\", \"labelled\", \"tidyverse\",\r\n            \"tidystm\", \"stminsights\", \"GGally\", \"ggraph\", \"igraph\", \"gridExtra\")\r\nlapply(pakker, library, character.only = TRUE)\r\nset.seed(1234)\r\n\r\n# F\u00f8r koden kj\u00f8res hentes det inn en STM med 20 emner\r\n\r\n# Emnefordelinger\r\nstm20_gamma <- tidy(stm20_begge,\r\n                    matrix = \"gamma\")\r\n\r\ngamma_terms20 <- stm20_gamma %>%\r\n  group_by(topic) %>%\r\n  summarise(gamma = mean(gamma)) %>%\r\n  arrange(desc(gamma)) %>%\r\n  mutate(topic = paste0(\"Topic \", topic),\r\n         topic = reorder(topic, gamma))\r\n\r\ngamma_terms20 %>%\r\n  top_n(20, gamma) %>%\r\n  ggplot(aes(topic, gamma)) +\r\n  geom_col(fill = \"#00bfc4\", color = \"black\", show.legend = FALSE) +\r\n  labs(title = \"Emnefordeling\", y = \"\", x = \"\") +\r\n  coord_flip()\r\n\r\n# Finne artikler mest assosiert med de spesifikke emnene, brukes for tolkning og analyse\r\nfindThoughts(stm20_begge, meta_begge$Tekst, topics = 9, n = 1)\r\n# Forst\u00e5r ikke helt hvorfor jeg f\u00e5r de resultata jeg f\u00e5r, og finner lite info om\r\n# hva denne koden egentlig gj\u00f8r. Finner dokumenter assosiert med de ulike emnene p\u00e5 andre m\u00e5ter\r\n\r\ntheta <- make.dt(stm20_begge) # theta-verdiene er emneandelene til hvert enkelt dokument\r\ntheta8 <- theta %>%\r\n  arrange(desc(Topic8)) %>%\r\n  slice(1:20)\r\ntheta8 # Finner topp tre artikler med h\u00f8yest theta verdi per emne. Gir meg radnummer, ikke radnavn\r\n\r\nmeta_begge[, ] # Legg inn tall fra forrige ledd, bare for \u00e5 se hvilken nettside artikkel er fra\r\nmeta_begge[, ] #\r\n\r\n# Lagrer artikler for emnene\r\nsink(\"8.csv\", append = FALSE, split = TRUE)\r\ntheta8 <- theta %>%\r\n  arrange(desc(Topic8)) %>%\r\n  slice(1)\r\ntheta8\r\n\r\ntheta8 <- theta %>%\r\n  arrange(desc(Topic8)) %>%\r\n  slice(2)\r\ntheta8\r\nsink()\r\n\r\n# Ser p\u00e5 bruken av emnene etter nettside\r\nprep20 <- estimateEffect(1:20\r\n                         ~ Nettside + s(Publiseringsdato),\r\n                         stmobj = stm20_begge,\r\n                         metadata = meta_begge,\r\n                         set.seed(1234),\r\n                         uncertainty = \"Global\")\r\n\r\neffect_20_nett <- extract.estimateEffect(prep20,\r\n                                         \"Nettside\",\r\n                                         136\r\n                                         method = \"pointestimate\") # Henter ut estimatene fra\r\nestimateEffect\r\neffect_20_nett$topic <- reorder(x = effect_20_nett$topic,\r\n                                effect_20_nett$estimate) # Omsorterer emnene etter estimatene\r\n\r\nstm20_nett <- ggplot(effect_20_nett, aes(x = topic, y = estimate, group = covariate.value, color = covariate.value)) +\r\n  geom_point(size = 3) +\r\n  scale_y_continuous(name = \"\") +\r\n  scale_x_discrete(name = \"Emne\", limits = rev(levels(effect_20_nett$topic))) +\r\n  theme(legend.title = element_blank(),legend.position = \"top\")\r\nprint(stm20_nett)\r\n\r\n# Etter dato\r\n# Lager labels til x-aksen\r\nlabels2 <- seq(from = 12055, to = 18625, by = 730)\r\nlabels2 <- c(\"12055\" = \"2003\", \"12785\" = \"2005\", \"13515\" = \"2007\", \"14245\" = \"2009\",\r\n             \"14975\" = \"2011\", \"15705\" = \"2013\", \"16435\" = \"2015\", \"17165\" = \"2017\",\r\n             \"17895\" = \"2019\", \"18625\" = \"2021\")\r\n# Utvalgte emner, samlet for nettsidene, ikke inkludert i oppgava\r\neffect_20_dato1 <- extract.estimateEffect(prep20,\r\n                                          \"Publiseringsdato\",\r\n                                          topics = c(5, 16),\r\n                                          method = \"continuous\")\r\n\r\neffect_20_dato1 <- effect_20_dato1 %>%\r\n  mutate(topic = fct_reorder(as.factor(topic), covariate.value))\r\n\r\nstm20_dato1 <- ggplot(effect_20_dato1, aes(x = covariate.value, y = estimate, group = topic,color = topic)) +\r\n  geom_line(size = 1) +\r\n  scale_y_continuous() +\r\n  scale_x_continuous(breaks = seq(from = 12055, to = 18625, by = 730), labels = labels2) +\r\n  theme(legend.position = \"top\") +\r\n  labs(title = \"Innvandringskritikk\", y = \"\", x = \"\", color = \"Emner:\") +\r\n  scale_color_manual(labels = c(\"5: Verdibasert uforenlighet\", \"16: \u00d8konomiske konsekvenser\"), values=c(\"#F8766D\", \"#00BFC4\"))\r\nprint(stm20_dato1)\r\n# Alle emnene, ikke inkludert i oppgava\r\neffect_20_dato2 <- extract.estimateEffect(prep20,\r\n                                          \"Publiseringsdato\",\r\n                                          topics = c(1:20),\r\n                                          method = \"continuous\")\r\n\r\neffect_20_dato2 <- effect_20_dato2 %>%\r\n  mutate(topic = fct_reorder(as.factor(topic), covariate.value))\r\n\r\nstm20_dato2 <- ggplot(effect_20_dato2, aes(x = covariate.value, y = estimate, group = topic, color = topic)) +\r\n  geom_line(size = 1.5) +\r\n  scale_y_continuous() +\r\n  scale_x_continuous(breaks = seq(from = 12055, to = 18625, by = 730), labels = labels2) +\r\n  theme(legend.position = \"top\") +\r\n  labs(title = \"Emnene over tid\", y = \"\", x = \"\")\r\nprint(stm20_dato2)\r\n\r\n# Klynger\r\nout_corr20 <- topicCorr(stm20_begge, cutoff = 0.04, set.seed(1234))\r\nout_corr20$cor[out_corr20$cor<0.04] <- 0\r\n\r\nnettverk <- graph_from_adjacency_matrix(out_corr20$cor, weighted = T, mode = \"undirected\", diag =\r\n                                          F, set.seed(1234))\r\n\r\nplot(nettverk, vertex.color = \"light blue\", vertex.label.color = \"black\")\r\n\r\nout_corr20 <- topicCorr(stm20_begge, cutoff = 0.04, set.seed(1234))\r\ncluster <- eclust(scale(out_corr20$cor), \"hclust\", k=5, nboot = 500)\r\n\r\nfviz_dend(cluster, rect = TRUE) # Dendrogram\r\n\r\nclust_col <- cluster$cluster\r\nclust_col <- to_factor(clust_col)\r\n\r\nleg.txt <- c(\"Svensk/dansk\", \"Engelsk\", \"Midt\u00f8sten\", \"Politikk og lov\", \"Div\") # Labels\r\n\r\nnetverk <- graph_from_adjacency_matrix(out_corr20$cor, weighted = TRUE, mode = \"undirected\", diag = FALSE, set.seed(1234))\r\nplot(netverk, vertex.color = clust_col, vertex.label.color = \"black\",) # Med farger etter dendrogrammet\r\nlegend(\"topleft\", leg.txt, fill = c(\"dark green\", \"blue\", \"orange\", \"light blue\", \"yellow\"))\r\n\r\n# Korrelasjonsmatrix\r\nout_corr20 <- topicCorr(stm20_begge, cutoff = 0.04)\r\ncorr <- as.data.frame(out_corr20$cor)\r\n\r\nggc <- ggcorr(out_corr20$cor, hjust = .85, size = 0, label = TRUE, method = c(\"pairwise\", \"pearson\"))\r\ndat <- data.frame(x=seq(corr), y=seq(corr),\r\n                  lbs = gsub(\"V\", \"\\n\", names(corr) ))\r\n\r\nggc +\r\n  geom_text(data = dat, aes(x, y, label = lbs), nudge_x = 0.1, nudge_y = 0.21)\r\n\r\n# Ser forandring over tid mellom sidene\r\nprep <- estimateEffect(c(1:20)\r\n                       ~ Nettside * s(Publiseringsdato),\r\n                       stm20_begge,\r\n                       metadata = meta_begge,\r\n                       uncertainty = \"Global\")\r\n\r\neffect <- get_effects(prep, variable = \"Publiseringsdato\",\r\n                      type = \"continuous\",\r\n                      moderator = \"Nettside\",\r\n                      modval = \"Rights\") %>%\r\n  bind_rows(get_effects(prep, variable = \"Publiseringsdato\",\r\n                type = \"continuous\",\r\n                moderator = \"Nettside\",\r\n                modval = \"Document\"))\r\n\r\neffect_plot <- effect %>%\r\n  filter(topic==20) %>% # Endrer sammen med overskrifter for hvert emne\r\n  mutate(moderator = as.factor(moderator)) %>%\r\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\r\n  geom_line(size = 1) +\r\n  scale_x_continuous(\"\", breaks = seq(from = 12055, to = 18625, by = 730), labels = labels2) +\r\n  scale_y_continuous(limits = c(0.02,0.25)) +\r\n  theme(legend.position = \"top\") +\r\n  labs(title = \"Emne 20: Religi\u00f8sitet\", x = \"\", y = \"\", color = \"Nettside\", group = \"Nettside\", fill = \"Nettside\")\r\nprint(effect_plot)\n\n# file: Innsamling.R\npakker <- c(\"rvest\", \"dplyr\", \"tibble\", \"httr\", \"writexl\", \"tm\", \"tidytext\", \"stringr\",\r\n            \"stopwords\", \"ggplot2\", \"topicmodels\", \"SnowballC\", \"quanteda\", \"lubridate\", \"stm\", \"plotly\")\r\nlapply(pakker, library, character.only = TRUE)\r\n\r\n### Document ###\r\n## Web scraping\r\n# OBS Tar lang tid \u00e5 kj\u00f8re.\r\n# Document har endret sideoppbygning etter at jeg samlet inn tekstmaterialet, s\u00e5 denne koden fungerer ikke lenger\r\nget_doc_text <- function(doc_link) {\r\n  doc_page <- read_html(doc_link)\r\n  doc_text <- doc_page %>%\r\n    html_nodes(\"article p\") %>%\r\n    html_text() %>%\r\n    paste(collapse = \",\")\r\n  return(doc_text)\r\n  \r\n}\r\ndocument <- data.frame()\r\nfor(i in seq(from = 2003, to = 2021, by = 1)) {\r\n  fortsettloop <- TRUE\r\n  j <- 0\r\n  while(fortsettloop){\r\n    Sys.sleep(2:10) # Venter 2-10 sek mellom hver side for \u00e5 ikke overbelaste serveren\r\n    j <- j+1\r\n    if(j == 1){\r\n      link2 <- paste0(\"https://www.document.no/\", i)\r\n    } else{\r\n      link2 <- paste0(\"https://www.document.no/\", i,\"/page/\", j, \"/\")\r\n    }\r\n    fortsettloop <- httr::GET(link2)$status_code == \"200\"\r\n    if(!fortsettloop ){\r\n      next\r\n    }\r\n    \r\n    page2 <- read_html(link2)\r\n    \r\n    doc_title <- page2 %>% # Henter overskriftene\r\n      html_nodes(\"h2 > a\") %>%\r\n      html_text()\r\n    \r\n    doc_links <- page2 %>% # Henter linkene til hver atikkel\r\n      html_nodes(\"h2 > a\") %>%\r\n      html_attr(\"href\") %>%\r\n      paste(., sep = \"\")\r\n    \r\n    doc_date <- page2 %>% # Henter publiseringsdato\r\n      html_nodes(\"font a\") %>%\r\n      html_text()\r\n    \r\n    \r\n    doc_text <- sapply(doc_links, FUN = get_doc_text, USE.NAMES = FALSE)\r\n    \r\n    document <- rbind(document, data.frame(Tittel=doc_title, Publiseringsdato=doc_date,\r\n                                           Tekst=doc_text, stringsAsFactors = FALSE))\r\n    \r\n    print(paste(link2, fortsettloop))\r\n  }\r\n}\r\n\r\nView(document)\r\n# Lagrer\r\n# write.csv(document, \"documentcsv.csv\", row.names = FALSE)\r\n# document <- read.csv(file = \"documentcsv.csv\", colClasses = c(\"character\", \"character\",\"character\"))\r\n\r\n\r\n### Rights ###\r\n## Web scraping\r\n# OBS Tar lang tid \u00e5 kj\u00f8re\r\nget_rights_text <- function(rights_link) { # Henter artikkeltekstene\r\n  rights_page <- read_html(rights_link)\r\n  rights_text <- rights_page %>%\r\n    html_nodes(\".article-body > p , .article-body p+ p , .MsoNormal\") %>%\r\n    html_text() %>%\r\n    paste(collapse = \",\")\r\n  return(rights_text)\r\n}\r\n\r\nrights <- data.frame()\r\nfor(i in seq(from = 2003, to = 2021, by = 1)) {\r\n  fortsettloop2 <- TRUE\r\n  j <- 0\r\n  while(fortsettloop2){\r\n    Sys.sleep(2:10) # Venter 2-10 sek mellom hver side for \u00e5 ikke overbelaste serveren\r\n    j <- j+1\r\n    if(j == 1){\r\n      link3 <- paste0(\"https://www.rights.no/\", i)\r\n    } else{\r\n      link3 <- paste0(\"https://www.rights.no/\", i,\"/page/\", j, \"/\")\r\n    }\r\n    fortsettloop2 <- httr::GET(link3)$status_code == \"200\"\r\n    if(!fortsettloop2 ){\r\n      next\r\n    }\r\n    \r\n    page4 <- read_html(link3)\r\n    \r\n    rights_title <- page4 %>% # Henter overskrifter\r\n      html_nodes(\".title\") %>%\r\n      html_text()\r\n    \r\n    \r\n    rights_links <- page4 %>% # Henter linker\r\n      html_nodes(\"a.link-wrapper\") %>%\r\n      html_attr(\"href\") %>%\r\n      paste(., sep = \"\")\r\n    \r\n    rights_date <- page4 %>% # Henter datoer\r\n      html_nodes(\".published\") %>%\r\n      html_text()\r\n    \r\n    rights_text <- sapply(rights_links, FUN = get_rights_text, USE.NAMES = FALSE)\r\n    \r\n    rights <- rbind(rights, data.frame(Tittel=rights_title, Publiseringsdato=rights_date,\r\n                                       Tekst=rights_text, stringsAsFactors = FALSE))\r\n    \r\n    print(paste(link3, fortsettloop2))\r\n  }\r\n}\r\n\r\nView(rights)\r\n# Lagrer\r\n# write.csv(rights, \"rightscvs.csv\", row.names = FALSE)\r\n# rights <- read.csv(\"rightscvs.csv\", colClasses = c(\"character\", \"character\", \"character\"))\r\n\r\n\r\n# Lager histogrammer over publiserte artikler, totalt og kun muslim/islam\r\ndocument2 <-\r\n  document[grepl(\"muslim|muslimer|muslimene|muslimske|islam|islamistiske|islamske|islamistisk\",\r\n                 document$Tekst, ignore.case = TRUE), ]\r\nrights2 <-\r\n  rights[grepl(\"muslim|muslimer|muslimene|muslimske|islam|islamistiske|islamske|islamistisk\",\r\n               rights$Tekst, ignore.case = TRUE), ]\r\n\r\ndocument2 <- document2 %>%\r\n  add_column(Kun_muslim = \"Kun muslim/islam\")\r\n\r\ndocument <- document %>%\r\n  add_column(Kun_muslim = \"Totalt\")\r\n\r\nrights2 <- rights2 %>%\r\n  add_column(Kun_muslim = \"Kun muslim/islam\")\r\n\r\nrights <- rights %>%\r\n  add_column(Kun_muslim = \"Totalt\")\r\n\r\nrights_alle <- rbind(rights, rights2)\r\ndocument_alle <- rbind(document, document2)\r\n\r\n# Labels\r\nlabels <- seq(from = 12055, to = 18625, by = 730)\r\nlabels <- c(\"12055\" = \"2003\", \"12785\" = \"2005\", \"13515\" = \"2007\", \"14245\" = \"2009\",\r\n            \"14975\" = \"2011\", \"15705\" = \"2013\", \"16435\" = \"2015\", \"17165\" = \"2017\",\r\n            \"17895\" = \"2019\", \"18625\" = \"2021\")\r\ndoc_hist <- document_alle %>%\r\n  ggplot(aes(x = Publiseringsdato, fill = Kun_muslim)) +\r\n  geom_histogram(color=\"#e9ecef\", alpha=0.6, binwidth=92, position = \"identity\") +\r\n  scale_x_continuous(\"Publiseringsdato\", breaks = seq(from = 12055, to = 18625, by = 730), labels = labels) +\r\n  scale_fill_manual(values=c(\"#404080\", \"#00BFC4\")) +\r\n  labs(title = \"Antall artikler fra Document\", y = \"Antall\", fill = \"Artikler\")\r\nprint(doc_hist)\r\n\r\nrights_hist <- rights_alle %>%\r\n  ggplot(aes(x = Publiseringsdato, fill = Kun_muslim)) +\r\n  geom_histogram(color=\"#e9ecef\", alpha=0.6, binwidth=92, position = \"identity\") +\r\n  scale_x_continuous(\"Publiseringsdato\", breaks = seq(from = 12055, to = 18625, by = 730), labels = labels) +\r\n  scale_fill_manual(values=c(\"#404080\", \"#00BFC4\")) +\r\n  labs(title = \"Antall artikler fra Rights\", y = \"Antall\", fill = \"Artikler\")\r\nprint(rights_hist)\r\n\r\n# Lager ordskyer\r\negne_stoppord_tibble <- tibble(word = c(\"m\u00e5\", \"m\u00e5tte\", \"sier\", \"f\u00e5\", \"mer\", \"f\u00e5r\", \"ta\", \"g\u00e5r\",\r\n                                        \"gikk\", \"dag\", \"alts\u00e5\", \"\u00e5r\", \"nok\", \"hele\", \"mens\", \"gj\u00f8r\", \"gj\u00f8re\", \"gjort\", \"f\u00e5tt\", \"se\",\r\n                                        \"ser\", \"sett\", \"st\u00e5r\", \"fikk\", \"tar\", \"tatt\", \"sa\", \"g\u00e5\", \"vet\", \"the\", \"new\", \"way\", \"all\",\r\n                                        \"last\", \"get\", \"why\", \"who\", \"you\", \"me\", \"us\", \"your\", \"mine\", \"will\", \"this\", \"that\", \"u\",\r\n                                        \"mest\", \"one\", \"two\", \"have\", \"are\", \"or\", \"without\", \"with\", \"his\", \"to\", \"of\",\"and\", \"in\", \"a\",\r\n                                        \"is\", \"on\", \"it\", \"was\", \"as\", \"af\", \"och\", \"sig\", \"att\", \"he\", \"not\", \"be\", \"they\", \"an\", \"\u00e4r\",\r\n                                        \"till\", \"inte\", \"we\", \"but\", \"their\", \"jo\", \"f\u00f6r\", \"which\",\"would\", \"its\", \"if\", \"there\",\r\n                                        \"scanpix\", \"what\", \"also\", \"said\", \"has\", \"foto\", \"ntb\", \"when\", \"our\", \"than\", \"other\", \"she\",\r\n                                        \"can\", \"them\", \"do\", \"by\", \"been\", \"had\", \"out\",\"how\", \"where\", \"were\", \"http\", \"any\", \"those\",\r\n                                        \"end\", \"blev\", \"high\", \"blevet\", \"comes\", \"come\", \"vist\", \"del\", \"self\", \"her\", \"on\", \"once\",\r\n                                        \"second\", \"if\", \"until\", \"into\",\"from\", \"does\", \"its\", \"his\", \"theirs\", \"them\", \"jag\", \"fr\u00e5n\",\r\n                                        \"n\u00e4r\", \"ska\", \"hon\", \"alla\",\"d\u00e4r\", \"vad\", \"andra\", \"vara\", \"hur\", \"nu\", \"finns\", \"ocks\u00e5\", \"nu\",\r\n                                        \"n\u00e5got\", \"n\u00e5gon\", \"hvad\",\"nu\", \"havde\", \"noget\", \"mig\", \"blive\", \"nogle\", \"os\", \"vores\", \"h\u00e4r\",\r\n                                        \"\u00e4n\", \"\u00f6ver\", \"allt\", \"bara\",\"these\", \"than\", \"him\", \"now\", \"op\", \"ind\", \"uden\", \"g\u00f8re\", \"g\u00f8r\",\r\n                                        \"blandt\", \"detta\", \"sedan\", \"efter\",\"deras\", \"mycke\", \"mycket\", \"efter\", \"\u00ebven\", \"s\u00e4ger\", \"utan\",\r\n                                        \"sina\", \"fr\u00e5\", \"bliver\", \"siger\", \"fik\",\"nogen\", \"sagde\", \"sige\", \"g\u00e6rne\", \"mer\", \"brug\",\r\n                                        \"brugt\", \"about\", \"only\", \"even\", \"mer\", \"brug\",\"giv\", \"giver\", \"seem\", \"like\", \"most\", \"andre\",\r\n                                        \"m\u00e5nge\", \"\u00e4ven\", \"m\u00e5st\", \"m\u00e5sta\", \"n\u00e5gre\"))\r\nfarge <- brewer.pal(5, \"Set1\")\r\n\r\nrights_ord <- rights %>%\r\n  unnest_tokens(output = word, input = Tekst) %>%\r\n  anti_join(get_stopwords(language = \"no\", source = \"snowball\")) %>%\r\n  anti_join(get_stopwords(language = \"en\", source = \"snowball\")) %>%\r\n  anti_join(get_stopwords(language = \"swedish\", source = \"snowball\")) %>%\r\n  anti_join(get_stopwords(language = \"danish\", source = \"snowball\")) %>%\r\n  anti_join(egne_stoppord_tibble)\r\n\r\nrights_ord <- rights_ord %>%\r\n  count(word, sort = TRUE)\r\n\r\nrights_ord %>%\r\n  with(wordcloud(word, n, random.order = FALSE, max.words = 50, colors=farge))\r\n\r\ndocument_ord <- document %>%\r\n  unnest_tokens(output = word, input = Tekst) %>%\r\n  anti_join(get_stopwords(language = \"no\", source = \"snowball\")) %>%\r\n  anti_join(get_stopwords(language = \"en\", source = \"snowball\")) %>%\r\n  anti_join(get_stopwords(language = \"swedish\", source = \"snowball\")) %>%\r\n  anti_join(get_stopwords(language = \"danish\", source = \"snowball\")) %>%\r\n  anti_join(egne_stoppord_tibble)\r\n\r\ndocument_ord <- document_ord %>%\r\n  count(word, sort = TRUE)\r\n\r\ndocument_ord %>%\r\n  with(wordcloud(word, n, random.order = FALSE, max.words = 50, colors=farge))\n\n# file: README.md\n# SOS4090\n\nRepo for koden jeg skrev i forbindelse med masteroppgaven min i sosiologi ved UiO. Scriptet er delt opp i tre deler, og b\u00f8r kj\u00f8res i rekkef\u00f8lgen innsamling -> bearbeiding -> analyse. \n\nI scriptet samles det inn artikler fra to norske alternative medier. Korpuset disse tekstene utgj\u00f8r bearbeides med form\u00e5l om \u00e5 bygge STM modeller, og kj\u00f8re div andre analyser. \n\nV\u00e6r obs p\u00e5 at utformingen til nettsidene det samles inn data fra kan ha endret seg siden jeg skrev denne koden, og trolig kan ikke koden for web scraping kj\u00f8res slik den er uten justeringer."
  },
  {
    "title": "Movers from the city in the first year of covid",
    "authors": "Marianne T\u00f8nnessen",
    "language": "microdata.no",
    "data": "registerdata",
    "methods": [
      "deskriptiv statistikk",
      "regresjonsanalyse"
    ],
    "themes": [
      "innenlands flytting",
      "yrker"
    ],
    "description": "Finner trender i utflyttingen fra Oslo f\u00f8r og under korona. Se publikasjon her: https://www.scup.com/doi/10.18261/issn.2703-8866-2021-02-03",
    "folder": "microdata-covid-migration",
    "files": [
      "microdata-covid-migration/Movers from the city in the first year of Covid.txt"
    ],
    "code": "# file: Movers from the city in the first year of Covid.txt\nclear\r\nrequire no.ssb.fdb:9 as ds\r\n\r\n// Finner utflytterne fra Oslo 2016\r\ncreate-dataset ut2016\r\nimport ds/BEFOLKNING_KJOENN as kjonn\r\n\r\n// finner de som har bodd i Oslo. Hiver ut de andre for \u00e5 begrense utvalget.  \r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2016-01-01 as boddeioslo\r\nkeep if (boddeioslo == '0301')\r\n\r\n// identifiserer utvandrerne\r\nimport ds/BEFOLKNING_STATUSKODE 2017-01-01 as statusdes\r\nimport ds/BEFOLKNING_STATUSKODE 2016-01-01 as statusjan\r\nkeep if (statusjan == '1' & statusdes != '5')\r\ngenerate utv = 0\r\nreplace utv = 1 if statusjan == '1' & statusdes == '3'\r\n// Her f\u00e5r vi alts\u00e5 ikke flergangsmigrantene.\r\n\r\n// identifiserer utflytterne\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2017-01-01 as komdes\r\ngenerate utfl = 0\r\nreplace utfl = 1 if (komdes != '0301' & statusdes == '1')\r\n\r\ngenerate staygo = 0\r\nreplace staygo = 1 if utfl == 1\r\nreplace staygo = 2 if utv == 1\r\n\r\nimport ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt\r\ngenerate alder = 2015 - int(fodt / 100)\r\n//tabulate alder staygo\r\n\r\ngenerate yrkesalder = 0\r\nreplace yrkesalder = 1 if (alder >= 15 & alder <= 74)\r\n\r\nimport ds/REGSYS_ARB_YRKE_STYRK08 2015-11-16 as styrk08\r\ngenerate styrk = substr(styrk08,1,1)\r\ngenerate hartall = 0\r\nreplace hartall = 1 if styrk >= '0'\r\ngenerate yrke = 0\r\nreplace yrke = 1 if styrk == '1'\r\nreplace yrke = 2 if styrk == '2'\r\nreplace yrke = 3 if styrk == '3'\r\nreplace yrke = 4 if styrk == '4'\r\nreplace yrke = 5 if styrk == '5'\r\nreplace yrke = 6 if styrk == '7'\r\nreplace yrke = 7 if styrk == '9'\r\nreplace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')\r\nreplace yrke = 9 if hartall == 0\r\n//tabulate yrke staygo if yrkesalder == 1\r\n\r\nimport ds/BEFOLKNING_FOEDEKOMMNR as fodtkom\r\ngenerate fodtoslo = 0\r\nreplace fodtoslo = 1 if fodtkom == '0301'\r\n//tabulate fodtoslo staygo\r\n\r\nimport ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2016-01-01 as famstr\r\ngenerate fam = 0\r\nreplace fam = 1 if famstr == 1\r\nreplace fam = 2 if famstr == 2\r\nreplace fam = 3 if famstr == 3\r\nreplace fam = 4 if famstr == 4\r\nreplace fam = 5 if famstr >= 5\r\n//tabulate fam staygo\r\n\r\nimport ds/BOFORHOLD_EIE_LEIE 2016-01-01 as eieleie\r\n//tabulate eieleie staygo\r\n\r\nimport ds/BEFOLKNING_INVKAT as invkat\r\ngenerate innv = 0\r\nreplace innv = 1 if invkat == 'B'\r\nreplace innv = 2 if invkat == 'C'\r\n//tabulate innv staygo\r\n\r\nimport ds/BEFOLKNING_REGSTAT_FAMTYP 2016-01-01 as familietype\r\ngenerate famtyp = substr(familietype,1,3)\r\n//tabulate famtyp staygo\r\n\r\nimport ds/BEFOLKNING_FODELAND as fland\r\ngenerate fodeland = 0\r\nreplace fodeland = 1 if fland == '000'\r\nreplace fodeland = 2 if (fland >= '101' & fland <= '106')\r\nreplace fodeland = 3 if (fland >= '110' & fland <= '199')\r\nreplace fodeland = 4 if (fland >= '200' & fland <= '840')\r\n//tabulate fodeland staygo\r\n\r\nimport ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2016-01-01 as brn\r\ngenerate barn = brn\r\nreplace barn = 4 if brn >= 4\r\n//tabulate barn staygo\r\n\r\n// Hvor flyttet de?\r\ngenerate fylke = substr(komdes,1,2)\r\n//tabulate fylke staygo\r\n\r\n// flere kjennetegn:\r\ngenerate mann = 0\r\nreplace mann = 1 if kjonn == '1'\r\n\r\ngenerate aldgrp = 0\r\nreplace aldgrp = 1 if (alder >= 0 & alder <= 5)\r\nreplace aldgrp = 2 if (alder >= 6 & alder <= 17)\r\nreplace aldgrp = 3 if (alder >= 18 & alder <= 24)\r\nreplace aldgrp = 4 if (alder >= 25 & alder <= 34)\r\nreplace aldgrp = 5 if (alder >= 35 & alder <= 44)\r\nreplace aldgrp = 6 if alder >= 45\r\n\r\nimport ds/BEFOLKNING_INNGRUNN1 as inngrunn\r\ngenerate inngr = 0\r\nreplace inngr = 1 if inngrunn == 'ARB'\r\nreplace inngr = 2 if inngrunn == 'FAM'\r\nreplace inngr = 3 if inngrunn == 'FLU'\r\n\r\nimport ds/BEFOLKNING_FORSTDATO as forstdato\r\ngenerate forstaar = int (forstdato/10000)\r\ngenerate botid = int (2016-forstaar) \r\n\r\ngenerate botidgrp = 0\r\nreplace botidgrp = 1 if (botid == 1 & invkat =='B')\r\nreplace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')\r\nreplace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')\r\nreplace botidgrp = 4 if (botid >= 11 & invkat =='B')\r\n\r\nimport ds/INNTEKT_WSAMINNT 2015-12-31 as inntekt\r\ngenerate inntgrp = 0\r\nreplace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)\r\nreplace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)\r\nreplace inntgrp = 3 if (inntekt >= 1000000)\r\n\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv\r\n\r\nkeep if invkat == 'B'\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp\r\n\r\n//////////////////////////////////////////////////////////////////////////\r\n\r\n// Finner utflytterne fra Oslo 2017\r\ncreate-dataset ut2017\r\nimport ds/BEFOLKNING_KJOENN as kjonn\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2017-01-01 as boddeioslo\r\nkeep if (boddeioslo == '0301')\r\n\r\n// identifiserer utvandrerne\r\nimport ds/BEFOLKNING_STATUSKODE 2018-01-01 as statusdes\r\nimport ds/BEFOLKNING_STATUSKODE 2017-01-01 as statusjan\r\nkeep if (statusjan == '1' & statusdes != '5')\r\ngenerate utv = 0\r\nreplace utv = 1 if statusjan == '1' & statusdes == '3'\r\n// Her f\u00e5r vi alts\u00e5 ikke flergangsmigrantene.\r\n\r\n// identifiserer utflytterne\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2018-01-01 as komdes\r\ngenerate utfl = 0\r\nreplace utfl = 1 if (komdes != '0301' & statusdes == '1')\r\n\r\ngenerate staygo = 0\r\nreplace staygo = 1 if utfl == 1\r\nreplace staygo = 2 if utv == 1\r\n\r\nimport ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt\r\ngenerate alder = 2016 - int(fodt / 100)\r\n//tabulate alder staygo\r\ngenerate yrkesalder = 0\r\nreplace yrkesalder = 1 if (alder >= 15 & alder <= 74)\r\n\r\nimport ds/REGSYS_ARB_YRKE_STYRK08 2016-11-16 as styrk08\r\ngenerate styrk = substr(styrk08,1,1)\r\ngenerate hartall = 0\r\nreplace hartall = 1 if styrk >= '0'\r\ngenerate yrke = 0\r\nreplace yrke = 1 if styrk == '1'\r\nreplace yrke = 2 if styrk == '2'\r\nreplace yrke = 3 if styrk == '3'\r\nreplace yrke = 4 if styrk == '4'\r\nreplace yrke = 5 if styrk == '5'\r\nreplace yrke = 6 if styrk == '7'\r\nreplace yrke = 7 if styrk == '9'\r\nreplace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')\r\nreplace yrke = 9 if hartall == 0\r\n//tabulate yrke staygo if yrkesalder == 1\r\n\r\nimport ds/BEFOLKNING_FOEDEKOMMNR as fodtkom\r\ngenerate fodtoslo = 0\r\nreplace fodtoslo = 1 if fodtkom == '0301'\r\n//tabulate fodtoslo staygo\r\n\r\nimport ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2017-01-01 as famstr\r\ngenerate fam = 0\r\nreplace fam = 1 if famstr == 1\r\nreplace fam = 2 if famstr == 2\r\nreplace fam = 3 if famstr == 3\r\nreplace fam = 4 if famstr == 4\r\nreplace fam = 5 if famstr >= 5\r\n//tabulate fam staygo\r\n\r\nimport ds/BOFORHOLD_EIE_LEIE 2017-01-01 as eieleie\r\n//tabulate eieleie staygo\r\n\r\nimport ds/BEFOLKNING_INVKAT as invkat\r\ngenerate innv = 0\r\nreplace innv = 1 if invkat == 'B'\r\nreplace innv = 2 if invkat == 'C'\r\n//tabulate innv staygo \r\n\r\nimport ds/BEFOLKNING_REGSTAT_FAMTYP 2017-01-01 as familietype\r\ngenerate famtyp = substr(familietype,1,3)\r\n//tabulate famtyp staygo\r\n\r\nimport ds/BEFOLKNING_FODELAND as fland\r\ngenerate fodeland = 0\r\nreplace fodeland = 1 if fland == '000'\r\nreplace fodeland = 2 if (fland >= '101' & fland <= '106')\r\nreplace fodeland = 3 if (fland >= '110' & fland <= '199')\r\nreplace fodeland = 4 if (fland >= '200' & fland <= '840')\r\n//tabulate fodeland staygo\r\n\r\nimport ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2017-01-01 as brn\r\ngenerate barn = brn\r\nreplace barn = 4 if brn >= 4\r\n//tabulate barn staygo\r\n\r\n// Hvor flyttet de?\r\ngenerate fylke = substr(komdes,1,2)\r\n//tabulate fylke staygo\r\n\r\n// flere kjennetegn:\r\ngenerate mann = 0\r\nreplace mann = 1 if kjonn == '1'\r\n\r\ngenerate aldgrp = 0\r\nreplace aldgrp = 1 if (alder >= 0 & alder <= 5)\r\nreplace aldgrp = 2 if (alder >= 6 & alder <= 17)\r\nreplace aldgrp = 3 if (alder >= 18 & alder <= 24)\r\nreplace aldgrp = 4 if (alder >= 25 & alder <= 34)\r\nreplace aldgrp = 5 if (alder >= 35 & alder <= 44)\r\nreplace aldgrp = 6 if alder >= 45\r\n\r\nimport ds/BEFOLKNING_INNGRUNN1 as inngrunn\r\ngenerate inngr = 0\r\nreplace inngr = 1 if inngrunn == 'ARB'\r\nreplace inngr = 2 if inngrunn == 'FAM'\r\nreplace inngr = 3 if inngrunn == 'FLU'\r\n\r\nimport ds/BEFOLKNING_FORSTDATO as forstdato\r\ngenerate forstaar = int (forstdato/10000)\r\ngenerate botid = int (2017-forstaar) \r\n\r\ngenerate botidgrp = 0\r\nreplace botidgrp = 1 if (botid == 1 & invkat =='B')\r\nreplace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')\r\nreplace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')\r\nreplace botidgrp = 4 if (botid >= 11 & invkat =='B')\r\n\r\nimport ds/INNTEKT_WSAMINNT 2016-12-31 as inntekt\r\ngenerate inntgrp = 0\r\nreplace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)\r\nreplace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)\r\nreplace inntgrp = 3 if (inntekt >= 1000000)\r\n\r\n\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv\r\n\r\nkeep if invkat == 'B'\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp\r\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////\r\n\r\n// Finner utflytterne fra Oslo 2018\r\ncreate-dataset ut2018\r\nimport ds/BEFOLKNING_KJOENN as kjonn\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2018-01-01 as boddeioslo\r\nkeep if (boddeioslo == '0301')\r\n\r\n// identifiserer utvandrerne\r\nimport ds/BEFOLKNING_STATUSKODE 2019-01-01 as statusdes\r\nimport ds/BEFOLKNING_STATUSKODE 2018-01-01 as statusjan\r\nkeep if (statusjan == '1' & statusdes != '5')\r\ngenerate utv = 0\r\nreplace utv = 1 if statusjan == '1' & statusdes == '3'\r\n// Her f\u00e5r vi alts\u00e5 ikke flergangsmigrantene.\r\n\r\n// identifiserer utflytterne\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2019-01-01 as komdes\r\ngenerate utfl = 0\r\nreplace utfl = 1 if (komdes != '0301' & statusjan == '1')\r\n\r\ngenerate staygo = 0\r\nreplace staygo = 1 if utfl == 1\r\nreplace staygo = 2 if utv == 1\r\n\r\nimport ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt\r\ngenerate alder = 2017 - int(fodt / 100)\r\n//tabulate alder staygo\r\ngenerate yrkesalder = 0\r\nreplace yrkesalder = 1 if (alder >= 15 & alder <= 74)\r\n\r\nimport ds/REGSYS_ARB_YRKE_STYRK08 2017-11-16 as styrk08\r\ngenerate styrk = substr(styrk08,1,1)\r\ngenerate hartall = 0\r\nreplace hartall = 1 if styrk >= '0'\r\ngenerate yrke = 0\r\nreplace yrke = 1 if styrk == '1'\r\nreplace yrke = 2 if styrk == '2'\r\nreplace yrke = 3 if styrk == '3'\r\nreplace yrke = 4 if styrk == '4'\r\nreplace yrke = 5 if styrk == '5'\r\nreplace yrke = 6 if styrk == '7'\r\nreplace yrke = 7 if styrk == '9'\r\nreplace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')\r\nreplace yrke = 9 if hartall == 0\r\n//tabulate yrke staygo if yrkesalder == 1\r\n\r\nimport ds/BEFOLKNING_FOEDEKOMMNR as fodtkom\r\ngenerate fodtoslo = 0\r\nreplace fodtoslo = 1 if fodtkom == '0301'\r\n//tabulate fodtoslo staygo\r\n\r\nimport ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2018-01-01 as famstr\r\ngenerate fam = 0\r\nreplace fam = 1 if famstr == 1\r\nreplace fam = 2 if famstr == 2\r\nreplace fam = 3 if famstr == 3\r\nreplace fam = 4 if famstr == 4\r\nreplace fam = 5 if famstr >= 5\r\n//tabulate fam staygo\r\n\r\nimport ds/BOFORHOLD_EIE_LEIE 2018-01-01 as eieleie\r\n//tabulate eieleie staygo\r\n\r\nimport ds/BEFOLKNING_INVKAT as invkat\r\ngenerate innv = 0\r\nreplace innv = 1 if invkat == 'B'\r\nreplace innv = 2 if invkat == 'C'\r\n//tabulate innv staygo\r\n\r\nimport ds/BEFOLKNING_REGSTAT_FAMTYP 2018-01-01 as familietype\r\ngenerate famtyp = substr(familietype,1,3)\r\n//tabulate famtyp staygo\r\n\r\nimport ds/BEFOLKNING_FODELAND as fland\r\ngenerate fodeland = 0\r\nreplace fodeland = 1 if fland == '000'\r\nreplace fodeland = 2 if (fland >= '101' & fland <= '106')\r\nreplace fodeland = 3 if (fland >= '110' & fland <= '199')\r\nreplace fodeland = 4 if (fland >= '200' & fland <= '840')\r\n//tabulate fodeland staygo\r\n\r\nimport ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2018-01-01 as brn\r\ngenerate barn = brn\r\nreplace barn = 4 if brn >= 4\r\n//tabulate barn staygo\r\n\r\n// Hvor flyttet de?\r\ngenerate fylke = substr(komdes,1,2)\r\n//tabulate fylke staygo\r\n\r\n// flere kjennetegn:\r\ngenerate mann = 0\r\nreplace mann = 1 if kjonn == '1'\r\n\r\ngenerate aldgrp = 0\r\nreplace aldgrp = 1 if (alder >= 0 & alder <= 5)\r\nreplace aldgrp = 2 if (alder >= 6 & alder <= 17)\r\nreplace aldgrp = 3 if (alder >= 18 & alder <= 24)\r\nreplace aldgrp = 4 if (alder >= 25 & alder <= 34)\r\nreplace aldgrp = 5 if (alder >= 35 & alder <= 44)\r\nreplace aldgrp = 6 if alder >= 45\r\n\r\nimport ds/BEFOLKNING_INNGRUNN1 as inngrunn\r\ngenerate inngr = 0\r\nreplace inngr = 1 if inngrunn == 'ARB'\r\nreplace inngr = 2 if inngrunn == 'FAM'\r\nreplace inngr = 3 if inngrunn == 'FLU'\r\n\r\nimport ds/BEFOLKNING_FORSTDATO as forstdato\r\ngenerate forstaar = int (forstdato/10000)\r\ngenerate botid = int (2018-forstaar) \r\n\r\ngenerate botidgrp = 0\r\nreplace botidgrp = 1 if (botid == 1 & invkat =='B')\r\nreplace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')\r\nreplace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')\r\nreplace botidgrp = 4 if (botid >= 11 & invkat =='B')\r\n\r\nimport ds/INNTEKT_WSAMINNT 2017-12-31 as inntekt\r\ngenerate inntgrp = 0\r\nreplace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)\r\nreplace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)\r\nreplace inntgrp = 3 if (inntekt >= 1000000)\r\n\r\n\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv\r\n\r\nkeep if invkat == 'B'\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp\r\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////\r\n\r\n\r\n\r\n// Finner utflytterne fra Oslo 2019\r\ncreate-dataset ut2019\r\nimport ds/BEFOLKNING_KJOENN as kjonn\r\n// dette er variabelen som microdata.no anbefaler \u00e5 begynne med. Flere kjennetegn kommer lenger ned.\r\n\r\n// finner de som har bodd i Oslo. Hiver ut de andre for \u00e5 begrense utvalget.  \r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2019-01-01 as boddeioslo\r\nkeep if (boddeioslo == '0301')\r\n\r\n// identifiserer utvandrerne\r\nimport ds/BEFOLKNING_STATUSKODE 2020-01-01 as statusdes\r\nimport ds/BEFOLKNING_STATUSKODE 2019-01-01 as statusjan\r\nkeep if (statusjan == '1' & statusdes != '5')\r\ngenerate utv = 0\r\nreplace utv = 1 if statusjan == '1' & statusdes == '3'\r\n// Her f\u00e5r vi alts\u00e5 ikke flergangsmigrantene.\r\n\r\n// identifiserer utflytterne\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2020-01-01 as komdes\r\ngenerate utfl = 0\r\nreplace utfl = 1 if (komdes != '0301' & statusjan == '1')\r\n\r\ngenerate staygo = 0\r\nreplace staygo = 1 if utfl == 1\r\nreplace staygo = 2 if utv == 1\r\n\r\nimport ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt\r\ngenerate alder = 2018 - int(fodt / 100)\r\n//tabulate alder staygo\r\ngenerate yrkesalder = 0\r\nreplace yrkesalder = 1 if (alder >= 15 & alder <= 74)\r\n\r\nimport ds/REGSYS_ARB_YRKE_STYRK08 2018-11-16 as styrk08\r\ngenerate styrk = substr(styrk08,1,1)\r\ngenerate hartall = 0\r\nreplace hartall = 1 if styrk >= '0'\r\ngenerate yrke = 0\r\nreplace yrke = 1 if styrk == '1'\r\nreplace yrke = 2 if styrk == '2'\r\nreplace yrke = 3 if styrk == '3'\r\nreplace yrke = 4 if styrk == '4'\r\nreplace yrke = 5 if styrk == '5'\r\nreplace yrke = 6 if styrk == '7'\r\nreplace yrke = 7 if styrk == '9'\r\nreplace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')\r\nreplace yrke = 9 if hartall == 0\r\n//tabulate yrke staygo if yrkesalder == 1\r\n\r\nimport ds/BEFOLKNING_FOEDEKOMMNR as fodtkom\r\ngenerate fodtoslo = 0\r\nreplace fodtoslo = 1 if fodtkom == '0301'\r\n//tabulate fodtoslo staygo\r\n\r\nimport ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2019-01-01 as famstr\r\ngenerate fam = 0\r\nreplace fam = 1 if famstr == 1\r\nreplace fam = 2 if famstr == 2\r\nreplace fam = 3 if famstr == 3\r\nreplace fam = 4 if famstr == 4\r\nreplace fam = 5 if famstr >= 5\r\n//tabulate fam staygo\r\n\r\nimport ds/BOFORHOLD_EIE_LEIE 2019-01-01 as eieleie\r\n//tabulate eieleie staygo\r\n\r\nimport ds/BEFOLKNING_INVKAT as invkat\r\ngenerate innv = 0\r\nreplace innv = 1 if invkat == 'B'\r\nreplace innv = 2 if invkat == 'C'\r\n//tabulate innv staygo\r\n\r\nimport ds/BEFOLKNING_REGSTAT_FAMTYP 2019-01-01 as familietype\r\ngenerate famtyp = substr(familietype,1,3)\r\n//tabulate famtyp staygo\r\n\r\nimport ds/BEFOLKNING_FODELAND as fland\r\ngenerate fodeland = 0\r\nreplace fodeland = 1 if fland == '000'\r\nreplace fodeland = 2 if (fland >= '101' & fland <= '106')\r\nreplace fodeland = 3 if (fland >= '110' & fland <= '199')\r\nreplace fodeland = 4 if (fland >= '200' & fland <= '840')\r\n//tabulate fodeland staygo\r\n\r\nimport ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2019-01-01 as brn\r\ngenerate barn = brn\r\nreplace barn = 4 if brn >= 4\r\n//tabulate barn staygo\r\n\r\n// Hvor flyttet de?\r\n// hermer fra microdata-manualen\r\ngenerate fylke = substr(komdes,1,2)\r\ndefine-labels fylkerstring '03' 'Oslo' '11' 'Rogaland' '15' 'M\u00f8re og Romsdal' '18' 'Nordland' '30' 'Viken' '34' 'Innlandet' '38' 'Vestfold og Telemark' '42' 'Agder' '46' 'Vestland' '50' 'Tr\u00f8ndelag' '54' 'Troms og Finnmark' '99' 'Uoppgitt'\r\nassign-labels fylke fylkerstring\r\n//tabulate fylke staygo\r\n\r\n// flere kjennetegn:\r\ngenerate mann = 0\r\nreplace mann = 1 if kjonn == '1'\r\n\r\ngenerate aldgrp = 0\r\nreplace aldgrp = 1 if (alder >= 0 & alder <= 5)\r\nreplace aldgrp = 2 if (alder >= 6 & alder <= 17)\r\nreplace aldgrp = 3 if (alder >= 18 & alder <= 24)\r\nreplace aldgrp = 4 if (alder >= 25 & alder <= 34)\r\nreplace aldgrp = 5 if (alder >= 35 & alder <= 44)\r\nreplace aldgrp = 6 if alder >= 45\r\n\r\nimport ds/BEFOLKNING_INNGRUNN1 as inngrunn\r\ngenerate inngr = 0\r\nreplace inngr = 1 if inngrunn == 'ARB'\r\nreplace inngr = 2 if inngrunn == 'FAM'\r\nreplace inngr = 3 if inngrunn == 'FLU'\r\n\r\nimport ds/BEFOLKNING_FORSTDATO as forstdato\r\ngenerate forstaar = int (forstdato/10000)\r\ngenerate botid = int (2019-forstaar) \r\n\r\ngenerate botidgrp = 0\r\nreplace botidgrp = 1 if (botid == 1 & invkat =='B')\r\nreplace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')\r\nreplace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')\r\nreplace botidgrp = 4 if (botid >= 11 & invkat =='B')\r\n\r\nimport ds/INNTEKT_WSAMINNT 2018-12-31 as inntekt\r\ngenerate inntgrp = 0\r\nreplace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)\r\nreplace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)\r\nreplace inntgrp = 3 if (inntekt >= 1000000)\r\n\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv\r\n\r\nkeep if invkat == 'B'\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp\r\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////\r\n\r\n\r\n// Finner utflytterne fra Oslo 2020\r\ncreate-dataset ut2020\r\nimport ds/BEFOLKNING_KJOENN as kjonn\r\n\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2020-01-01 as boddeioslo\r\nkeep if (boddeioslo == '0301')\r\n\r\n// identifiserer utvandrerne\r\nimport ds/BEFOLKNING_STATUSKODE 2021-01-01 as statusdes\r\nimport ds/BEFOLKNING_STATUSKODE 2020-01-01 as statusjan\r\nkeep if (statusjan == '1' & statusdes != '5')\r\ngenerate utv = 0\r\nreplace utv = 1 if statusjan == '1' & statusdes == '3'\r\n// Her f\u00e5r vi alts\u00e5 ikke flergangsmigrantene.\r\n\r\n// identifiserer utflytterne\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2021-01-01 as komdes\r\ngenerate utfl = 0\r\nreplace utfl = 1 if (komdes != '0301' & statusjan == '1')\r\n\r\ngenerate staygo = 0\r\nreplace staygo = 1 if utfl == 1\r\nreplace staygo = 2 if utv == 1\r\n\r\nimport ds/BEFOLKNING_FOEDSELS_AAR_MND as fodt\r\ngenerate alder = 2019 - int(fodt / 100)\r\n// tabulate alder staygo\r\ngenerate yrkesalder = 0\r\nreplace yrkesalder = 1 if (alder >= 15 & alder <= 74)\r\n\r\nimport ds/REGSYS_ARB_YRKE_STYRK08 2019-11-16 as styrk08\r\ngenerate styrk = substr(styrk08,1,1)\r\ngenerate hartall = 0\r\nreplace hartall = 1 if styrk >= '0'\r\ngenerate yrke = 0\r\nreplace yrke = 1 if styrk == '1'\r\nreplace yrke = 2 if styrk == '2'\r\nreplace yrke = 3 if styrk == '3'\r\nreplace yrke = 4 if styrk == '4'\r\nreplace yrke = 5 if styrk == '5'\r\nreplace yrke = 6 if styrk == '7'\r\nreplace yrke = 7 if styrk == '9'\r\nreplace yrke = 8 if (styrk == '0' | styrk == '6' | styrk == '8')\r\nreplace yrke = 9 if hartall == 0\r\n//tabulate yrke staygo if yrkesalder == 1\r\n\r\nimport ds/BEFOLKNING_FOEDEKOMMNR as fodtkom\r\ngenerate fodtoslo = 0\r\nreplace fodtoslo = 1 if fodtkom == '0301'\r\n//tabulate fodtoslo staygo\r\n\r\nimport ds/BEFOLKNING_ANTPERS_I_REGSTAT_FAMNR 2020-01-01 as famstr\r\ngenerate fam = 0\r\nreplace fam = 1 if famstr == 1\r\nreplace fam = 2 if famstr == 2\r\nreplace fam = 3 if famstr == 3\r\nreplace fam = 4 if famstr == 4\r\nreplace fam = 5 if famstr >= 5\r\n//tabulate fam staygo\r\n\r\nimport ds/BOFORHOLD_EIE_LEIE 2020-01-01 as eieleie\r\n//tabulate eieleie staygo\r\n\r\nimport ds/BEFOLKNING_INVKAT as invkat\r\ngenerate innv = 0\r\nreplace innv = 1 if invkat == 'B'\r\nreplace innv = 2 if invkat == 'C'\r\n//tabulate innv staygo\r\n\r\nimport ds/BEFOLKNING_REGSTAT_FAMTYP 2020-01-01 as familietype\r\ngenerate famtyp = substr(familietype,1,3)\r\n//tabulate famtyp staygo\r\n\r\nimport ds/BEFOLKNING_FODELAND as fland\r\ngenerate fodeland = 0\r\nreplace fodeland = 1 if fland == '000' \r\nreplace fodeland = 2 if (fland >= '101' & fland <= '106')\r\nreplace fodeland = 3 if (fland >= '110' & fland <= '199')\r\nreplace fodeland = 4 if (fland >= '200' & fland <= '840')\r\n//tabulate fodeland staygo\r\n\r\nimport ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2020-01-01 as brn\r\ngenerate barn = brn\r\nreplace barn = 4 if brn >= 4\r\n//tabulate barn staygo\r\n\r\n// Hvor flyttet de?\r\ngenerate fylke = substr(komdes,1,2)\r\n//tabulate fylke staygo\r\n\r\n// flere kjennetegn:\r\ngenerate mann = 0\r\nreplace mann = 1 if kjonn == '1'\r\n\r\ngenerate aldgrp = 0\r\nreplace aldgrp = 1 if (alder >= 0 & alder <= 5)\r\nreplace aldgrp = 2 if (alder >= 6 & alder <= 17)\r\nreplace aldgrp = 3 if (alder >= 18 & alder <= 24)\r\nreplace aldgrp = 4 if (alder >= 25 & alder <= 34)\r\nreplace aldgrp = 5 if (alder >= 35 & alder <= 44)\r\nreplace aldgrp = 6 if alder >= 45\r\n\r\nimport ds/BEFOLKNING_INNGRUNN1 as inngrunn\r\ngenerate inngr = 0\r\nreplace inngr = 1 if inngrunn == 'ARB'\r\nreplace inngr = 2 if inngrunn == 'FAM'\r\nreplace inngr = 3 if inngrunn == 'FLU'\r\n\r\nimport ds/BEFOLKNING_FORSTDATO as forstdato\r\ngenerate forstaar = int (forstdato/10000)\r\ngenerate botid = int (2020-forstaar) \r\n\r\ngenerate botidgrp = 0\r\nreplace botidgrp = 1 if (botid == 1 & invkat =='B')\r\nreplace botidgrp = 2 if (botid >=2 & botid <=4 & invkat =='B')\r\nreplace botidgrp = 3 if (botid >=5 & botid <=10 & invkat =='B')\r\nreplace botidgrp = 4 if (botid >= 11 & invkat =='B')\r\n\r\nimport ds/INNTEKT_WSAMINNT 2019-12-31 as inntekt\r\ngenerate inntgrp = 0\r\nreplace inntgrp = 1 if (inntekt >= 200000 & inntekt <=499999)\r\nreplace inntgrp = 2 if (inntekt >= 500000 & inntekt <=9999999)\r\nreplace inntgrp = 3 if (inntekt >= 1000000)\r\n\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie fodtoslo i.innv\r\n\r\nkeep if invkat == 'B'\r\nmlogit staygo mann i.aldgrp i.yrke i.famtyp i.inntgrp i.eieleie i.fodeland i.inngr i.botidgrp"
  },
  {
    "title": "FD-Trygd: Vasking av mikrodata",
    "authors": [
      "\u00c5smund Hermansen"
    ],
    "language": "Stata",
    "data": [
      "FD-trygd",
      "registerdata"
    ],
    "methods": [
      "forl\u00f8psanalyse"
    ],
    "themes": [
      "sysselsetting",
      "arbeidss\u00f8kere",
      "overf\u00f8ringer"
    ],
    "description": "Tilrettelegging av mikrodata fra SSBs variabelomr\u00e5de FD-Trygd, inkl. sysselsetting, arbeidss\u00f8kere, ytelser og andre overf\u00f8ringer: AAP, sosialhjelp, sykepenger, uf\u00f8retrygd, uf\u00f8repensjon, kvalifiseringsprogrammet (KVP).",
    "folder": "FD-trygd",
    "files": [
      "FD-trygd/KVP.do",
      "FD-trygd/Uf\u00f8repensjon.do",
      "FD-trygd/Medisinsk+rehabilitering.do",
      "FD-trygd/AAP.do",
      "FD-trygd/Sykepenger.do",
      "FD-trygd/Sysselsatt.do",
      "FD-trygd/Tidsbegrenset+uf\u00f8retrygd.do",
      "FD-trygd/Sosialhjelp.do",
      "FD-trygd/Attf\u00f8ring.do",
      "FD-trygd/Arbeidss\u00f8ker.do"
    ],
    "code": "# file: KVP.do\n ****************************************************************************\r\n*** Henter opp uf\u00f8repensjon og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_kvalif.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\KVP_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\KVP_tmp.dta\", replace\r\n\r\nforvalues i=2008/2020 { \r\ngen kvp_`i'_01 = 0 \r\nreplace kvp_`i'_01 = 1 if tilgdato<=`i'01 & avgdato>=`i'01  \r\ngen kvp_`i'_02 = 0 \r\nreplace kvp_`i'_02 = 1 if tilgdato<=`i'02 & avgdato>=`i'02  \r\ngen kvp_`i'_03 = 0 \r\nreplace kvp_`i'_03 = 1 if tilgdato<=`i'03 & avgdato>=`i'03 \r\ngen kvp_`i'_04 = 0 \r\nreplace kvp_`i'_04 = 1 if tilgdato<=`i'04 & avgdato>=`i'04\r\ngen kvp_`i'_05 = 0 \r\nreplace kvp_`i'_05 = 1 if tilgdato<=`i'05 & avgdato>=`i'05\r\ngen kvp_`i'_06 = 0 \r\nreplace kvp_`i'_06 = 1 if tilgdato<=`i'06 & avgdato>=`i'06\r\ngen kvp_`i'_07 = 0 \r\nreplace kvp_`i'_07 = 1 if tilgdato<=`i'07 & avgdato>=`i'07\r\ngen kvp_`i'_08 = 0 \r\nreplace kvp_`i'_08 = 1 if tilgdato<=`i'08 & avgdato>=`i'08\r\ngen kvp_`i'_09 = 0 \r\nreplace kvp_`i'_09 = 1 if tilgdato<=`i'09 & avgdato>=`i'09\r\ngen kvp_`i'_10 = 0 \r\nreplace kvp_`i'_10 = 1 if tilgdato<=`i'10 & avgdato>=`i'10\r\ngen kvp_`i'_11 = 0 \r\nreplace kvp_`i'_11 = 1 if tilgdato<=`i'11 & avgdato>=`i'11\r\ngen kvp_`i'_12 = 0 \r\nreplace kvp_`i'_12 = 1 if tilgdato<=`i'12 & avgdato>=`i'12\r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\KVP_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\KVP_tmp.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\nforvalues i=2008/2020 {\r\negen kvp_`i'01= total (kvp_`i'_01), by (w20_0450_lopenr_person)\r\negen kvp_`i'02= total (kvp_`i'_02), by (w20_0450_lopenr_person)\r\negen kvp_`i'03= total (kvp_`i'_03), by (w20_0450_lopenr_person)\r\negen kvp_`i'04= total (kvp_`i'_04), by (w20_0450_lopenr_person)\r\negen kvp_`i'05= total (kvp_`i'_05), by (w20_0450_lopenr_person)\r\negen kvp_`i'06= total (kvp_`i'_06), by (w20_0450_lopenr_person)\r\negen kvp_`i'07= total (kvp_`i'_07), by (w20_0450_lopenr_person)\r\negen kvp_`i'08= total (kvp_`i'_08), by (w20_0450_lopenr_person)\r\negen kvp_`i'09= total (kvp_`i'_09), by (w20_0450_lopenr_person)\r\negen kvp_`i'10= total (kvp_`i'_10), by (w20_0450_lopenr_person)\r\negen kvp_`i'11= total (kvp_`i'_11), by (w20_0450_lopenr_person)\r\negen kvp_`i'12= total (kvp_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=2008/2020 {\r\nreplace kvp_`i'01= 1 if kvp_`i'01 > 1 \r\nreplace kvp_`i'02= 1 if kvp_`i'02 > 1  \r\nreplace kvp_`i'03= 1 if kvp_`i'03 > 1  \r\nreplace kvp_`i'04= 1 if kvp_`i'04 > 1 \r\nreplace kvp_`i'05= 1 if kvp_`i'05 > 1  \r\nreplace kvp_`i'06= 1 if kvp_`i'06 > 1  \r\nreplace kvp_`i'07= 1 if kvp_`i'07 > 1  \r\nreplace kvp_`i'08= 1 if kvp_`i'08 > 1  \r\nreplace kvp_`i'09= 1 if kvp_`i'09 > 1  \r\nreplace kvp_`i'10= 1 if kvp_`i'10 > 1  \r\nreplace kvp_`i'11= 1 if kvp_`i'11 > 1  \r\nreplace kvp_`i'12= 1 if kvp_`i'12 > 1   \r\n\r\n}\r\n\r\ndrop kvp_2008_01-kvp_2020_12 //fjerner de opprinnelige variablene\r\n\r\ndrop kode regdato tilgdato avgdato tomdato\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\KVP_wide.dta\", replace //lagrer filen i wide-format\r\n\r\n\n\n# file: Uf\u00f8repensjon.do\n****************************************************************************\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_ufp.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\uforepensjon_tmp_2010.dta\", replace\r\n\r\ndestring pnsjkode, replace\r\n\r\nkeep if (pnsjkode==20 | pnsjkode==21) \r\n\r\ndrop if pnsjavg== . \r\n\r\nrename pnsjavg avgang\r\n\r\nforvalues i=1992/2010 { \r\ngen uforepensjon_`i'_01 = 0 \r\nreplace uforepensjon_`i'_01 = 1 if pnsjtilg<=`i'01 & (avgang>=`i'01)\r\ngen uforepensjon_`i'_02 = 0 \r\nreplace uforepensjon_`i'_02 = 1 if pnsjtilg<=`i'02 & (avgang>=`i'02)\r\ngen uforepensjon_`i'_03 = 0 \r\nreplace uforepensjon_`i'_03 = 1 if pnsjtilg<=`i'03 & (avgang>=`i'03)\r\ngen uforepensjon_`i'_04 = 0 \r\nreplace uforepensjon_`i'_04 = 1 if pnsjtilg<=`i'04 & (avgang>=`i'04)\r\ngen uforepensjon_`i'_05 = 0 \r\nreplace uforepensjon_`i'_05 = 1 if pnsjtilg<=`i'05 & (avgang>=`i'05)\r\ngen uforepensjon_`i'_06 = 0 \r\nreplace uforepensjon_`i'_06 = 1 if pnsjtilg<=`i'06 & (avgang>=`i'06)\r\ngen uforepensjon_`i'_07 = 0 \r\nreplace uforepensjon_`i'_07 = 1 if pnsjtilg<=`i'07 & (avgang>=`i'07)\r\ngen uforepensjon_`i'_08 = 0 \r\nreplace uforepensjon_`i'_08 = 1 if pnsjtilg<=`i'08 & (avgang>=`i'08)\r\ngen uforepensjon_`i'_09 = 0 \r\nreplace uforepensjon_`i'_09 = 1 if pnsjtilg<=`i'09 & (avgang>=`i'09)\r\ngen uforepensjon_`i'_10 = 0 \r\nreplace uforepensjon_`i'_10 = 1 if pnsjtilg<=`i'10 & (avgang>=`i'10)\r\ngen uforepensjon_`i'_11 = 0 \r\nreplace uforepensjon_`i'_11 = 1 if pnsjtilg<=`i'11 & (avgang>=`i'11)\r\ngen uforepensjon_`i'_12 = 0 \r\nreplace uforepensjon_`i'_12 = 1 if pnsjtilg<=`i'12 & (avgang>=`i'12)\r\n\r\n}\r\n\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2010 {\r\negen uforepensjon_`i'01= total (uforepensjon_`i'_01), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'02= total (uforepensjon_`i'_02), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'03= total (uforepensjon_`i'_03), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'04= total (uforepensjon_`i'_04), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'05= total (uforepensjon_`i'_05), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'06= total (uforepensjon_`i'_06), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'07= total (uforepensjon_`i'_07), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'08= total (uforepensjon_`i'_08), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'09= total (uforepensjon_`i'_09), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'10= total (uforepensjon_`i'_10), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'11= total (uforepensjon_`i'_11), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'12= total (uforepensjon_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=1992/2010 {\r\nreplace uforepensjon_`i'01= 1 if uforepensjon_`i'01 > 1 \r\nreplace uforepensjon_`i'02= 1 if uforepensjon_`i'02 > 1  \r\nreplace uforepensjon_`i'03= 1 if uforepensjon_`i'03 > 1  \r\nreplace uforepensjon_`i'04= 1 if uforepensjon_`i'04 > 1 \r\nreplace uforepensjon_`i'05= 1 if uforepensjon_`i'05 > 1  \r\nreplace uforepensjon_`i'06= 1 if uforepensjon_`i'06 > 1  \r\nreplace uforepensjon_`i'07= 1 if uforepensjon_`i'07 > 1  \r\nreplace uforepensjon_`i'08= 1 if uforepensjon_`i'08 > 1  \r\nreplace uforepensjon_`i'09= 1 if uforepensjon_`i'09 > 1  \r\nreplace uforepensjon_`i'10= 1 if uforepensjon_`i'10 > 1  \r\nreplace uforepensjon_`i'11= 1 if uforepensjon_`i'11 > 1  \r\nreplace uforepensjon_`i'12= 1 if uforepensjon_`i'12 > 1  \r\n\r\n}\r\n\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\uforepensjon_2010_wide.dta\", replace //lagrer filen i wide-format\r\n\r\n\r\n\r\n***2018***\r\n\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_pensj_ufp.dta\", replace\r\n\r\ngen avgang= 0 \r\n\r\nreplace avgang= pnsjavg if avgang== 0\r\nreplace avgang= pnsjtom if avgang== .\r\n\r\n\r\nforvalues i=2011/2018 { \r\ngen uforepensjon_`i'_01 = 0 \r\nreplace uforepensjon_`i'_01 = 1 if pnsjtilg<=`i'01 & (avgang>=`i'01 | avgang== .)\r\ngen uforepensjon_`i'_02 = 0 \r\nreplace uforepensjon_`i'_02 = 1 if pnsjtilg<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen uforepensjon_`i'_03 = 0 \r\nreplace uforepensjon_`i'_03 = 1 if pnsjtilg<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen uforepensjon_`i'_04 = 0 \r\nreplace uforepensjon_`i'_04 = 1 if pnsjtilg<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen uforepensjon_`i'_05 = 0 \r\nreplace uforepensjon_`i'_05 = 1 if pnsjtilg<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen uforepensjon_`i'_06 = 0 \r\nreplace uforepensjon_`i'_06 = 1 if pnsjtilg<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen uforepensjon_`i'_07 = 0 \r\nreplace uforepensjon_`i'_07 = 1 if pnsjtilg<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen uforepensjon_`i'_08 = 0 \r\nreplace uforepensjon_`i'_08 = 1 if pnsjtilg<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen uforepensjon_`i'_09 = 0 \r\nreplace uforepensjon_`i'_09 = 1 if pnsjtilg<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen uforepensjon_`i'_10 = 0 \r\nreplace uforepensjon_`i'_10 = 1 if pnsjtilg<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen uforepensjon_`i'_11 = 0 \r\nreplace uforepensjon_`i'_11 = 1 if pnsjtilg<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen uforepensjon_`i'_12 = 0 \r\nreplace uforepensjon_`i'_12 = 1 if pnsjtilg<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2011/2018 {\r\negen uforepensjon_`i'01= total (uforepensjon_`i'_01), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'02= total (uforepensjon_`i'_02), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'03= total (uforepensjon_`i'_03), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'04= total (uforepensjon_`i'_04), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'05= total (uforepensjon_`i'_05), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'06= total (uforepensjon_`i'_06), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'07= total (uforepensjon_`i'_07), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'08= total (uforepensjon_`i'_08), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'09= total (uforepensjon_`i'_09), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'10= total (uforepensjon_`i'_10), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'11= total (uforepensjon_`i'_11), by (w20_0450_lopenr_person)\r\negen uforepensjon_`i'12= total (uforepensjon_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=2011/2018 {\r\nreplace uforepensjon_`i'01= 1 if uforepensjon_`i'01 > 1 \r\nreplace uforepensjon_`i'02= 1 if uforepensjon_`i'02 > 1  \r\nreplace uforepensjon_`i'03= 1 if uforepensjon_`i'03 > 1  \r\nreplace uforepensjon_`i'04= 1 if uforepensjon_`i'04 > 1 \r\nreplace uforepensjon_`i'05= 1 if uforepensjon_`i'05 > 1  \r\nreplace uforepensjon_`i'06= 1 if uforepensjon_`i'06 > 1  \r\nreplace uforepensjon_`i'07= 1 if uforepensjon_`i'07 > 1  \r\nreplace uforepensjon_`i'08= 1 if uforepensjon_`i'08 > 1  \r\nreplace uforepensjon_`i'09= 1 if uforepensjon_`i'09 > 1  \r\nreplace uforepensjon_`i'10= 1 if uforepensjon_`i'10 > 1  \r\nreplace uforepensjon_`i'11= 1 if uforepensjon_`i'11 > 1  \r\nreplace uforepensjon_`i'12= 1 if uforepensjon_`i'12 > 1  \r\n\r\n}\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\uforepensjon_2018_wide.dta\", replace //lagrer filen i wide-format\r\n\r\n\r\n\r\n\r\n***Kobler filene***\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\uforepensjon_2010_wide.dta\", replace \r\n\r\nmerge 1:1 w20_0450_lopenr_person using \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\uforepensjon_2018_wide.dta\"\r\n\r\ndrop _merge\r\n\r\n\r\n***Gir de som har missing verdien 0\r\n\r\nforvalues i=1992/2018 {\r\nreplace uforepensjon_`i'01= 0 if uforepensjon_`i'01 == .\r\nreplace uforepensjon_`i'02= 0 if uforepensjon_`i'02 == . \r\nreplace uforepensjon_`i'03= 0 if uforepensjon_`i'03 == . \r\nreplace uforepensjon_`i'04= 0 if uforepensjon_`i'04 == . \r\nreplace uforepensjon_`i'05= 0 if uforepensjon_`i'05 == . \r\nreplace uforepensjon_`i'06= 0 if uforepensjon_`i'06 == . \r\nreplace uforepensjon_`i'07= 0 if uforepensjon_`i'07 == . \r\nreplace uforepensjon_`i'08= 0 if uforepensjon_`i'08 == . \r\nreplace uforepensjon_`i'09= 0 if uforepensjon_`i'09 == . \r\nreplace uforepensjon_`i'10= 0 if uforepensjon_`i'10 == .\r\nreplace uforepensjon_`i'11= 0 if uforepensjon_`i'11 == . \r\nreplace uforepensjon_`i'12= 0 if uforepensjon_`i'12 == . \r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\uforepensjon_wide.dta\", replace\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n# file: Medisinsk+rehabilitering.do\n\r\n\r\n****************************************************************************\r\n*** Henter opp medisinsk rehabilitering og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_attf.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\medrehab_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\medrehab_tmp.dta\", replace\r\n\r\n \r\ndestring tilgdato_mnd, replace\r\ndestring avgdato_mnd, replace\r\n\r\ndestring attfkode, replace\r\n\r\nkeep if (attfkode==10 | attfkode_mnd==11 | attfkode_mnd==12 | attfkode_mnd==13) /// Beholder kun de p\u00e5 medisinsk rehabilitering\r\n       \r\ndrop if avgdato_mnd== . \r\n\t   \r\n\t   \r\nforvalues i=1992/2018 { \r\ngen medrehab_`i'_01 = 0 \r\nreplace medrehab_`i'_01 = 1 if tilgdato_mnd<=`i'01 & avgdato_mnd>=`i'01  \r\ngen medrehab_`i'_02 = 0 \r\nreplace medrehab_`i'_02 = 1 if tilgdato_mnd<=`i'02 & avgdato_mnd>=`i'02  \r\ngen medrehab_`i'_03 = 0 \r\nreplace medrehab_`i'_03 = 1 if tilgdato_mnd<=`i'03 & avgdato_mnd>=`i'03 \r\ngen medrehab_`i'_04 = 0 \r\nreplace medrehab_`i'_04 = 1 if tilgdato_mnd<=`i'04 & avgdato_mnd>=`i'04\r\ngen medrehab_`i'_05 = 0 \r\nreplace medrehab_`i'_05 = 1 if tilgdato_mnd<=`i'05 & avgdato_mnd>=`i'05\r\ngen medrehab_`i'_06 = 0 \r\nreplace medrehab_`i'_06 = 1 if tilgdato_mnd<=`i'06 & avgdato_mnd>=`i'06\r\ngen medrehab_`i'_07 = 0 \r\nreplace medrehab_`i'_07 = 1 if tilgdato_mnd<=`i'07 & avgdato_mnd>=`i'07\r\ngen medrehab_`i'_08 = 0 \r\nreplace medrehab_`i'_08 = 1 if tilgdato_mnd<=`i'08 & avgdato_mnd>=`i'08\r\ngen medrehab_`i'_09 = 0 \r\nreplace medrehab_`i'_09 = 1 if tilgdato_mnd<=`i'09 & avgdato_mnd>=`i'09\r\ngen medrehab_`i'_10 = 0 \r\nreplace medrehab_`i'_10 = 1 if tilgdato_mnd<=`i'10 & avgdato_mnd>=`i'10\r\ngen medrehab_`i'_11 = 0 \r\nreplace medrehab_`i'_11 = 1 if tilgdato_mnd<=`i'11 & avgdato_mnd>=`i'11\r\ngen medrehab_`i'_12 = 0 \r\nreplace medrehab_`i'_12 = 1 if tilgdato_mnd<=`i'12 & avgdato_mnd>=`i'12\r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\medrehab_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\medrehab_tmp.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2018 {\r\negen medrehab_`i'01= total (medrehab_`i'_01), by (w20_0450_lopenr_person)\r\negen medrehab_`i'02= total (medrehab_`i'_02), by (w20_0450_lopenr_person)\r\negen medrehab_`i'03= total (medrehab_`i'_03), by (w20_0450_lopenr_person)\r\negen medrehab_`i'04= total (medrehab_`i'_04), by (w20_0450_lopenr_person)\r\negen medrehab_`i'05= total (medrehab_`i'_05), by (w20_0450_lopenr_person)\r\negen medrehab_`i'06= total (medrehab_`i'_06), by (w20_0450_lopenr_person)\r\negen medrehab_`i'07= total (medrehab_`i'_07), by (w20_0450_lopenr_person)\r\negen medrehab_`i'08= total (medrehab_`i'_08), by (w20_0450_lopenr_person)\r\negen medrehab_`i'09= total (medrehab_`i'_09), by (w20_0450_lopenr_person)\r\negen medrehab_`i'10= total (medrehab_`i'_10), by (w20_0450_lopenr_person)\r\negen medrehab_`i'11= total (medrehab_`i'_11), by (w20_0450_lopenr_person)\r\negen medrehab_`i'12= total (medrehab_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=1992/2018 {\r\nreplace medrehab_`i'01= 1 if medrehab_`i'01 > 1 \r\nreplace medrehab_`i'02= 1 if medrehab_`i'02 > 1 \r\nreplace medrehab_`i'03= 1 if medrehab_`i'03 > 1 \r\nreplace medrehab_`i'04= 1 if medrehab_`i'04 > 1 \r\nreplace medrehab_`i'05= 1 if medrehab_`i'05 > 1 \r\nreplace medrehab_`i'06= 1 if medrehab_`i'06 > 1 \r\nreplace medrehab_`i'07= 1 if medrehab_`i'07 > 1 \r\nreplace medrehab_`i'08= 1 if medrehab_`i'08 > 1 \r\nreplace medrehab_`i'09= 1 if medrehab_`i'09 > 1 \r\nreplace medrehab_`i'10= 1 if medrehab_`i'10 > 1 \r\nreplace medrehab_`i'11= 1 if medrehab_`i'11 > 1 \r\nreplace medrehab_`i'12= 1 if medrehab_`i'12 > 1 \r\n\r\n}\r\n\r\n\r\ndrop medrehab_1992_01-medrehab_2018_12 //fjerner de opprinnelige variablene\r\n\r\ndrop attfkode-avgdato_mnd\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\ndrop ufg bfg attftilg_mnd attfavg_mnd ufgdato_mnd attftom_mnd\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\medrehab_wide.dta\", replace //lagrer filen i wide-format\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n# file: AAP.do\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_aap.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\AAP_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\AAP_tmp.dta\", replace\r\n\r\n\r\ntostring tilgdato, replace\r\ntostring avgdato, replace \r\n\r\ngen tilgang= tilgdato\r\ngen avgang= tomdato\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n\r\nforvalues i=2010/2018 { \r\ngen AAP_`i'_01 = 0 \r\nreplace AAP_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)\r\ngen AAP_`i'_02 = 0 \r\nreplace AAP_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen AAP_`i'_03 = 0 \r\nreplace AAP_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen AAP_`i'_04 = 0 \r\nreplace AAP_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen AAP_`i'_05 = 0 \r\nreplace AAP_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen AAP_`i'_06 = 0 \r\nreplace AAP_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen AAP_`i'_07 = 0 \r\nreplace AAP_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen AAP_`i'_08 = 0 \r\nreplace AAP_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen AAP_`i'_09 = 0 \r\nreplace AAP_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen AAP_`i'_10 = 0 \r\nreplace AAP_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen AAP_`i'_11 = 0 \r\nreplace AAP_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen AAP_`i'_12 = 0 \r\nreplace AAP_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\AAP_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\AAP_tmp.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2010/2018 {\r\negen AAP_`i'01= total (AAP_`i'_01), by (w20_0450_lopenr_person)\r\negen AAP_`i'02= total (AAP_`i'_02), by (w20_0450_lopenr_person)\r\negen AAP_`i'03= total (AAP_`i'_03), by (w20_0450_lopenr_person)\r\negen AAP_`i'04= total (AAP_`i'_04), by (w20_0450_lopenr_person)\r\negen AAP_`i'05= total (AAP_`i'_05), by (w20_0450_lopenr_person)\r\negen AAP_`i'06= total (AAP_`i'_06), by (w20_0450_lopenr_person)\r\negen AAP_`i'07= total (AAP_`i'_07), by (w20_0450_lopenr_person)\r\negen AAP_`i'08= total (AAP_`i'_08), by (w20_0450_lopenr_person)\r\negen AAP_`i'09= total (AAP_`i'_09), by (w20_0450_lopenr_person)\r\negen AAP_`i'10= total (AAP_`i'_10), by (w20_0450_lopenr_person)\r\negen AAP_`i'11= total (AAP_`i'_11), by (w20_0450_lopenr_person)\r\negen AAP_`i'12= total (AAP_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=2010/2018 {\r\nreplace AAP_`i'01= 1 if AAP_`i'01 > 1\r\nreplace AAP_`i'02= 1 if AAP_`i'02 > 1 \r\nreplace AAP_`i'03= 1 if AAP_`i'03 > 1 \r\nreplace AAP_`i'04= 1 if AAP_`i'04 > 1\r\nreplace AAP_`i'05= 1 if AAP_`i'05 > 1 \r\nreplace AAP_`i'06= 1 if AAP_`i'06 > 1 \r\nreplace AAP_`i'07= 1 if AAP_`i'07 > 1 \r\nreplace AAP_`i'08= 1 if AAP_`i'08 > 1\r\nreplace AAP_`i'09= 1 if AAP_`i'09 > 1 \r\nreplace AAP_`i'10= 1 if AAP_`i'10 > 1 \r\nreplace AAP_`i'11= 1 if AAP_`i'11 > 1 \r\nreplace AAP_`i'12= 1 if AAP_`i'12 > 1\r\n\r\n}\r\n\r\n\r\ndrop AAP_2010_01-AAP_2018_12 //fjerner de opprinnelige variablene\r\n\r\ndrop kode-avgang\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\AAP.dta\", replace //lagrer filen i wide-format\r\n\r\n\n\n# file: Sykepenger.do\n****************************************************************************\r\n*** Henter opp sykepenger og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_sp.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sykepenger_tmp\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sykepenger_tmp.dta\", replace\r\n\r\ndestring tilgdato_mnd, replace\r\ndestring avgdato_mnd, replace\r\n\r\n\r\nkeep if spkode== 10 | spkode== 20 | spkode== 30 | spkode== 40 | spkode== 50 | ///\r\n        spkode== 60 | spkode== 90 \r\n\r\n\r\nforvalues i=1992/2018 { \r\ngen sykepenger_`i'_01 = 0 \r\nreplace sykepenger_`i'_01 = 1 if tilgdato_mnd<=`i'01 & (avgdato_mnd>=`i'01 | avgdato_mnd== .)\r\ngen sykepenger_`i'_02 = 0 \r\nreplace sykepenger_`i'_02 = 1 if tilgdato_mnd<=`i'02 & (avgdato_mnd>=`i'02 | avgdato_mnd== .)\r\ngen sykepenger_`i'_03 = 0 \r\nreplace sykepenger_`i'_03 = 1 if tilgdato_mnd<=`i'03 & (avgdato_mnd>=`i'03 | avgdato_mnd== .)\r\ngen sykepenger_`i'_04 = 0 \r\nreplace sykepenger_`i'_04 = 1 if tilgdato_mnd<=`i'04 & (avgdato_mnd>=`i'04 | avgdato_mnd== .)\r\ngen sykepenger_`i'_05 = 0 \r\nreplace sykepenger_`i'_05 = 1 if tilgdato_mnd<=`i'05 & (avgdato_mnd>=`i'05 | avgdato_mnd== .)\r\ngen sykepenger_`i'_06 = 0 \r\nreplace sykepenger_`i'_06 = 1 if tilgdato_mnd<=`i'06 & (avgdato_mnd>=`i'06 | avgdato_mnd== .)\r\ngen sykepenger_`i'_07 = 0 \r\nreplace sykepenger_`i'_07 = 1 if tilgdato_mnd<=`i'07 & (avgdato_mnd>=`i'07 | avgdato_mnd== .)\r\ngen sykepenger_`i'_08 = 0 \r\nreplace sykepenger_`i'_08 = 1 if tilgdato_mnd<=`i'08 & (avgdato_mnd>=`i'08 | avgdato_mnd== .)\r\ngen sykepenger_`i'_09 = 0 \r\nreplace sykepenger_`i'_09 = 1 if tilgdato_mnd<=`i'09 & (avgdato_mnd>=`i'09 | avgdato_mnd== .)\r\ngen sykepenger_`i'_10 = 0 \r\nreplace sykepenger_`i'_10 = 1 if tilgdato_mnd<=`i'10 & (avgdato_mnd>=`i'10 | avgdato_mnd== .)\r\ngen sykepenger_`i'_11 = 0 \r\nreplace sykepenger_`i'_11 = 1 if tilgdato_mnd<=`i'11 & (avgdato_mnd>=`i'11 | avgdato_mnd== .)\r\ngen sykepenger_`i'_12 = 0 \r\nreplace sykepenger_`i'_12 = 1 if tilgdato_mnd<=`i'12 & (avgdato_mnd>=`i'12 | avgdato_mnd== .)\r\n\r\n}\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sykepenger_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sykepenger_tmp.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2018 {\r\negen sykepenger_`i'01= total (sykepenger_`i'_01), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'02= total (sykepenger_`i'_02), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'03= total (sykepenger_`i'_03), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'04= total (sykepenger_`i'_04), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'05= total (sykepenger_`i'_05), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'06= total (sykepenger_`i'_06), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'07= total (sykepenger_`i'_07), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'08= total (sykepenger_`i'_08), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'09= total (sykepenger_`i'_09), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'10= total (sykepenger_`i'_10), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'11= total (sykepenger_`i'_11), by (w20_0450_lopenr_person)\r\negen sykepenger_`i'12= total (sykepenger_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=1992/2018 {\r\nreplace sykepenger_`i'01= 1 if sykepenger_`i'01 > 1\r\nreplace sykepenger_`i'02= 1 if sykepenger_`i'02 > 1 \r\nreplace sykepenger_`i'03= 1 if sykepenger_`i'03 > 1 \r\nreplace sykepenger_`i'04= 1 if sykepenger_`i'04 > 1\r\nreplace sykepenger_`i'05= 1 if sykepenger_`i'05 > 1 \r\nreplace sykepenger_`i'06= 1 if sykepenger_`i'06 > 1 \r\nreplace sykepenger_`i'07= 1 if sykepenger_`i'07 > 1 \r\nreplace sykepenger_`i'08= 1 if sykepenger_`i'08 > 1\r\nreplace sykepenger_`i'09= 1 if sykepenger_`i'09 > 1 \r\nreplace sykepenger_`i'10= 1 if sykepenger_`i'10 > 1 \r\nreplace sykepenger_`i'11= 1 if sykepenger_`i'11 > 1 \r\nreplace sykepenger_`i'12= 1 if sykepenger_`i'12 > 1\r\n\r\n}\r\n\r\n\r\ndrop sykepenger_1992_01-sykepenger_2018_12 //fjerner de opprinnelige variablene\r\n\r\ndrop spkode spgrad erdag avdag form5 ttype1 ttype2 ttype3 regdato_mnd tilgdato_mnd avgdato_mnd ///\r\n     sptilg_mnd spavg_mnd arbuf_mnd spgrdato_mnd tomdato_mnd frm5dato_mnd\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sykepenger_wide.dta\", replace //lagrer filen i wide-format\r\n\r\n\r\n\n\n# file: Sysselsatt.do\n\r\n\r\n***Lager sysselsettingsfil p\u00e5 m\u00e5nedsbasis fra 1992 til 2003\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_sys.dta\", replace \r\n\r\n\r\n//Fjerner de selvstendige\r\n\r\ndestring syskode, replace\r\n\r\nkeep if syskode < 20\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sysselsatt_2004_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sysselsatt_2004_tmp.dta\", replace\r\n\r\ngen tilgang=systilg_mnd\r\ngen  avgang=systom_mnd\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for sysselsetting\r\n\r\nforvalues i=1992/2004 { \r\ngen sysselsatt_`i'_01 = 0 \r\nreplace sysselsatt_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)  \r\ngen sysselsatt_`i'_02 = 0 \r\nreplace sysselsatt_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen sysselsatt_`i'_03 = 0 \r\nreplace sysselsatt_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen sysselsatt_`i'_04 = 0 \r\nreplace sysselsatt_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen sysselsatt_`i'_05 = 0 \r\nreplace sysselsatt_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen sysselsatt_`i'_06 = 0 \r\nreplace sysselsatt_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen sysselsatt_`i'_07 = 0 \r\nreplace sysselsatt_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen sysselsatt_`i'_08 = 0 \r\nreplace sysselsatt_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen sysselsatt_`i'_09 = 0 \r\nreplace sysselsatt_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen sysselsatt_`i'_10 = 0 \r\nreplace sysselsatt_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen sysselsatt_`i'_11 = 0 \r\nreplace sysselsatt_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen sysselsatt_`i'_12 = 0 \r\nreplace sysselsatt_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2004 {\r\negen sysselsatt_`i'01= total (sysselsatt_`i'_01), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'02= total (sysselsatt_`i'_02), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'03= total (sysselsatt_`i'_03), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'04= total (sysselsatt_`i'_04), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'05= total (sysselsatt_`i'_05), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'06= total (sysselsatt_`i'_06), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'07= total (sysselsatt_`i'_07), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'08= total (sysselsatt_`i'_08), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'09= total (sysselsatt_`i'_09), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'10= total (sysselsatt_`i'_10), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'11= total (sysselsatt_`i'_11), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'12= total (sysselsatt_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n// Gir alle m\u00e5nedsregisteringer hvor en person er sysselsatt verdien 1 \r\n\r\nforvalues i=1992/2004 {\r\nreplace sysselsatt_`i'01= 1 if sysselsatt_`i'01 > 1\r\nreplace sysselsatt_`i'02= 1 if sysselsatt_`i'02 > 1\r\nreplace sysselsatt_`i'03= 1 if sysselsatt_`i'03 > 1\r\nreplace sysselsatt_`i'04= 1 if sysselsatt_`i'04 > 1\r\nreplace sysselsatt_`i'05= 1 if sysselsatt_`i'05 > 1\r\nreplace sysselsatt_`i'06= 1 if sysselsatt_`i'06 > 1\r\nreplace sysselsatt_`i'07= 1 if sysselsatt_`i'07 > 1\r\nreplace sysselsatt_`i'08= 1 if sysselsatt_`i'08 > 1\r\nreplace sysselsatt_`i'09= 1 if sysselsatt_`i'09 > 1\r\nreplace sysselsatt_`i'10= 1 if sysselsatt_`i'10 > 1\r\nreplace sysselsatt_`i'11= 1 if sysselsatt_`i'11 > 1\r\nreplace sysselsatt_`i'12= 1 if sysselsatt_`i'12 > 1\r\n\r\n}\r\n\r\ndrop  syskode naring FORV_ARB w20_0450_a_o_ref NACE_NAR w20_0450_orgn_ref ///\r\n      regdato_mnd tilgdato_mnd avgdato_mnd systilg_mnd sysavg_mnd NAR_DATO_mnd ///\r\n\t  FVA_DATO_mnd A_O_DATO_mnd nacedato_mnd orgndato_mnd tomdato_mnd ///\r\n\t  systom_mnd sysselsatt_1992_01-sysselsatt_2004_12\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\ntab dup\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\t \r\n\r\ndrop dup\t \r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sysselsatt_2004.dta\", replace\r\n\r\n**************************************************************************************************\r\n**************************************************************************************************\r\n\r\n***Lager sysselsettingsfil p\u00e5 m\u00e5nedsbasis fra 2004 til 2014\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_jobber.dta\", replace \r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sysselsatt_2004_2014_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sysselsatt_2004_2014_tmp.dta\", replace\r\n\r\ngen tilgang=tilgdato_mnd\r\ngen  avgang=tomdato_mnd\r\n\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\ndestring regtom_mnd, replace\r\n\r\nreplace avgang=regtom_mnd if avgang== .\r\n\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for sysselsetting\r\n\r\nforvalues i=2004/2014 { \r\ngen sysselsatt_`i'_01 = 0 \r\nreplace sysselsatt_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)  \r\ngen sysselsatt_`i'_02 = 0 \r\nreplace sysselsatt_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen sysselsatt_`i'_03 = 0 \r\nreplace sysselsatt_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen sysselsatt_`i'_04 = 0 \r\nreplace sysselsatt_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen sysselsatt_`i'_05 = 0 \r\nreplace sysselsatt_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen sysselsatt_`i'_06 = 0 \r\nreplace sysselsatt_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen sysselsatt_`i'_07 = 0 \r\nreplace sysselsatt_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen sysselsatt_`i'_08 = 0 \r\nreplace sysselsatt_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen sysselsatt_`i'_09 = 0 \r\nreplace sysselsatt_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen sysselsatt_`i'_10 = 0 \r\nreplace sysselsatt_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen sysselsatt_`i'_11 = 0 \r\nreplace sysselsatt_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen sysselsatt_`i'_12 = 0 \r\nreplace sysselsatt_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2004/2014 {\r\negen sysselsatt_`i'01= total (sysselsatt_`i'_01), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'02= total (sysselsatt_`i'_02), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'03= total (sysselsatt_`i'_03), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'04= total (sysselsatt_`i'_04), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'05= total (sysselsatt_`i'_05), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'06= total (sysselsatt_`i'_06), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'07= total (sysselsatt_`i'_07), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'08= total (sysselsatt_`i'_08), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'09= total (sysselsatt_`i'_09), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'10= total (sysselsatt_`i'_10), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'11= total (sysselsatt_`i'_11), by (w20_0450_lopenr_person)\r\negen sysselsatt_`i'12= total (sysselsatt_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n// Gir alle m\u00e5nedsregisteringer hvor en person er sysselsatt verdien 1 \r\n\r\nforvalues i=2004/2014 {\r\nreplace sysselsatt_`i'01= 1 if sysselsatt_`i'01 > 1\r\nreplace sysselsatt_`i'02= 1 if sysselsatt_`i'02 > 1\r\nreplace sysselsatt_`i'03= 1 if sysselsatt_`i'03 > 1\r\nreplace sysselsatt_`i'04= 1 if sysselsatt_`i'04 > 1\r\nreplace sysselsatt_`i'05= 1 if sysselsatt_`i'05 > 1\r\nreplace sysselsatt_`i'06= 1 if sysselsatt_`i'06 > 1\r\nreplace sysselsatt_`i'07= 1 if sysselsatt_`i'07 > 1\r\nreplace sysselsatt_`i'08= 1 if sysselsatt_`i'08 > 1\r\nreplace sysselsatt_`i'09= 1 if sysselsatt_`i'09 > 1\r\nreplace sysselsatt_`i'10= 1 if sysselsatt_`i'10 > 1\r\nreplace sysselsatt_`i'11= 1 if sysselsatt_`i'11 > 1\r\nreplace sysselsatt_`i'12= 1 if sysselsatt_`i'12 > 1\r\n\r\n}\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\ntab dup\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\t \r\n\r\ndrop dup\t \r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sysselsatt_2014.dta\", replace\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n# file: Tidsbegrenset+uf\u00f8retrygd.do\n\r\n****************************************************************************\r\n*** Henter opp tidsbegrenset uf\u00f8retrygd og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_tu.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\tufor_tmp_2018.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\tufor_tmp_2018.dta\", replace\r\n\r\nkeep if kode==\"0\"\r\n\r\ngen tilgang= tilgdato\r\ngen avgang= avgdato\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n\r\nforvalues i=2004/2018 { \r\ngen tufor_`i'_01 = 0 \r\nreplace tufor_`i'_01 = 1 if tilgang<=`i'01 & avgang>=`i'01  \r\ngen tufor_`i'_02 = 0 \r\nreplace tufor_`i'_02 = 1 if tilgang<=`i'02 & avgang>=`i'02  \r\ngen tufor_`i'_03 = 0 \r\nreplace tufor_`i'_03 = 1 if tilgang<=`i'03 & avgang>=`i'03 \r\ngen tufor_`i'_04 = 0 \r\nreplace tufor_`i'_04 = 1 if tilgang<=`i'04 & avgang>=`i'04\r\ngen tufor_`i'_05 = 0 \r\nreplace tufor_`i'_05 = 1 if tilgang<=`i'05 & avgang>=`i'05\r\ngen tufor_`i'_06 = 0 \r\nreplace tufor_`i'_06 = 1 if tilgang<=`i'06 & avgang>=`i'06\r\ngen tufor_`i'_07 = 0 \r\nreplace tufor_`i'_07 = 1 if tilgang<=`i'07 & avgang>=`i'07\r\ngen tufor_`i'_08 = 0 \r\nreplace tufor_`i'_08 = 1 if tilgang<=`i'08 & avgang>=`i'08\r\ngen tufor_`i'_09 = 0 \r\nreplace tufor_`i'_09 = 1 if tilgang<=`i'09 & avgang>=`i'09\r\ngen tufor_`i'_10 = 0 \r\nreplace tufor_`i'_10 = 1 if tilgang<=`i'10 & avgang>=`i'10\r\ngen tufor_`i'_11 = 0 \r\nreplace tufor_`i'_11 = 1 if tilgang<=`i'11 & avgang>=`i'11\r\ngen tufor_`i'_12 = 0 \r\nreplace tufor_`i'_12 = 1 if tilgang<=`i'12 & avgang>=`i'12\r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\tufor_tmp_2018.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\tufor_tmp_2018.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2004/2018 {\r\negen tufor_`i'01= total (tufor_`i'_01), by (w20_0450_lopenr_person)\r\negen tufor_`i'02= total (tufor_`i'_02), by (w20_0450_lopenr_person)\r\negen tufor_`i'03= total (tufor_`i'_03), by (w20_0450_lopenr_person)\r\negen tufor_`i'04= total (tufor_`i'_04), by (w20_0450_lopenr_person)\r\negen tufor_`i'05= total (tufor_`i'_05), by (w20_0450_lopenr_person)\r\negen tufor_`i'06= total (tufor_`i'_06), by (w20_0450_lopenr_person)\r\negen tufor_`i'07= total (tufor_`i'_07), by (w20_0450_lopenr_person)\r\negen tufor_`i'08= total (tufor_`i'_08), by (w20_0450_lopenr_person)\r\negen tufor_`i'09= total (tufor_`i'_09), by (w20_0450_lopenr_person)\r\negen tufor_`i'10= total (tufor_`i'_10), by (w20_0450_lopenr_person)\r\negen tufor_`i'11= total (tufor_`i'_11), by (w20_0450_lopenr_person)\r\negen tufor_`i'12= total (tufor_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=2004/2018 {\r\nreplace tufor_`i'01= 1 if tufor_`i'01 > 1 \r\nreplace tufor_`i'02= 1 if tufor_`i'02 > 1 \r\nreplace tufor_`i'03= 1 if tufor_`i'03 > 1 \r\nreplace tufor_`i'04= 1 if tufor_`i'04 > 1  \r\nreplace tufor_`i'05= 1 if tufor_`i'05 > 1 \r\nreplace tufor_`i'06= 1 if tufor_`i'06 > 1  \r\nreplace tufor_`i'07= 1 if tufor_`i'07 > 1  \r\nreplace tufor_`i'08= 1 if tufor_`i'08 > 1  \r\nreplace tufor_`i'09= 1 if tufor_`i'09 > 1  \r\nreplace tufor_`i'10= 1 if tufor_`i'10 > 1  \r\nreplace tufor_`i'11= 1 if tufor_`i'11 > 1 \r\nreplace tufor_`i'12= 1 if tufor_`i'12 > 1  \r\n\r\n}\r\n\r\n\r\n\r\ndrop kode regdato tilgdato avgdato uforetp uforetp_dato ufg ufg_dato ///\r\n     ungufor ungufor_dato tomdato tusfom_mnd tutom_mnd tilgang avgang ///\r\n\t tufor_2004_01-tufor_2018_12 //fjerner de opprinnelige variablene\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\tufor_wide.dta\", replace //lagrer filen i wide-format\r\n\n\n# file: Sosialhjelp.do\n****************************************************************************\r\n*** Henter opp sosialhjelp og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_shj.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sosialhjelp_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sosialhjelp_tmp.dta\", replace\r\n\r\nkeep if shjkode==\"0\"\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for mottak av sosialhjelp\r\nforvalues i=1992/2018 { \r\ngen sosialhjelp_`i'_01 = 0 \r\nreplace sosialhjelp_`i'_01 = 1 if shj_tilg<=`i'01 & shj_avg>=`i'01  \r\ngen sosialhjelp_`i'_02 = 0 \r\nreplace sosialhjelp_`i'_02 = 1 if shj_tilg<=`i'02 & shj_avg>=`i'02  \r\ngen sosialhjelp_`i'_03 = 0 \r\nreplace sosialhjelp_`i'_03 = 1 if shj_tilg<=`i'03 & shj_avg>=`i'03 \r\ngen sosialhjelp_`i'_04 = 0 \r\nreplace sosialhjelp_`i'_04 = 1 if shj_tilg<=`i'04 & shj_avg>=`i'04\r\ngen sosialhjelp_`i'_05 = 0 \r\nreplace sosialhjelp_`i'_05 = 1 if shj_tilg<=`i'05 & shj_avg>=`i'05\r\ngen sosialhjelp_`i'_06 = 0 \r\nreplace sosialhjelp_`i'_06 = 1 if shj_tilg<=`i'06 & shj_avg>=`i'06\r\ngen sosialhjelp_`i'_07 = 0 \r\nreplace sosialhjelp_`i'_07 = 1 if shj_tilg<=`i'07 & shj_avg>=`i'07\r\ngen sosialhjelp_`i'_08 = 0 \r\nreplace sosialhjelp_`i'_08 = 1 if shj_tilg<=`i'08 & shj_avg>=`i'08\r\ngen sosialhjelp_`i'_09 = 0 \r\nreplace sosialhjelp_`i'_09 = 1 if shj_tilg<=`i'09 & shj_avg>=`i'09\r\ngen sosialhjelp_`i'_10 = 0 \r\nreplace sosialhjelp_`i'_10 = 1 if shj_tilg<=`i'10 & shj_avg>=`i'10\r\ngen sosialhjelp_`i'_11 = 0 \r\nreplace sosialhjelp_`i'_11 = 1 if shj_tilg<=`i'11 & shj_avg>=`i'11\r\ngen sosialhjelp_`i'_12 = 0 \r\nreplace sosialhjelp_`i'_12 = 1 if shj_tilg<=`i'12 & shj_avg>=`i'12\r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sosialhjelp_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sosialhjelp_tmp.dta\", replace\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2018 {\r\negen sosialhjelp_`i'01= total (sosialhjelp_`i'_01), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'02= total (sosialhjelp_`i'_02), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'03= total (sosialhjelp_`i'_03), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'04= total (sosialhjelp_`i'_04), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'05= total (sosialhjelp_`i'_05), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'06= total (sosialhjelp_`i'_06), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'07= total (sosialhjelp_`i'_07), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'08= total (sosialhjelp_`i'_08), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'09= total (sosialhjelp_`i'_09), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'10= total (sosialhjelp_`i'_10), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'11= total (sosialhjelp_`i'_11), by (w20_0450_lopenr_person)\r\negen sosialhjelp_`i'12= total (sosialhjelp_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=1992/2018 {\r\nreplace sosialhjelp_`i'01= 1 if sosialhjelp_`i'01 > 1  \r\nreplace sosialhjelp_`i'02= 1 if sosialhjelp_`i'02 > 1 \r\nreplace sosialhjelp_`i'03= 1 if sosialhjelp_`i'03 > 1  \r\nreplace sosialhjelp_`i'04= 1 if sosialhjelp_`i'04 > 1  \r\nreplace sosialhjelp_`i'05= 1 if sosialhjelp_`i'05 > 1  \r\nreplace sosialhjelp_`i'06= 1 if sosialhjelp_`i'06 > 1 \r\nreplace sosialhjelp_`i'07= 1 if sosialhjelp_`i'07 > 1  \r\nreplace sosialhjelp_`i'08= 1 if sosialhjelp_`i'08 > 1  \r\nreplace sosialhjelp_`i'09= 1 if sosialhjelp_`i'09 > 1  \r\nreplace sosialhjelp_`i'10= 1 if sosialhjelp_`i'10 > 1  \r\nreplace sosialhjelp_`i'11= 1 if sosialhjelp_`i'11 > 1  \r\nreplace sosialhjelp_`i'12= 1 if sosialhjelp_`i'12 > 1  \r\n\r\n}\r\n\r\n\r\n\r\ndrop sosialhjelp_1992_01-sosialhjelp_2018_12 //fjerner de opprinnelige variablene\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop shjkode regdato shj_tilg shj_avg tomdato dup //fjerner opprinnelige variabler \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\sosialhjelp_mnd_wide.dta\", replace //lagrer filen i wide-format\r\n \n\n# file: Attf\u00f8ring.do\n\r\n\r\n****************************************************************************\r\n*** Henter opp attf\u00f8ring og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_attf.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2001.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2001.dta\", replace\r\n\r\ndestring attfkode_mnd, replace\r\n\r\nkeep if (attfkode_mnd==20 | attfkode_mnd==21 | attfkode_mnd==22 | attfkode_mnd==23 | ///\r\n         attfkode_mnd==24) ///Beholder kun attf\u00f8ring\r\n \r\nrename attftilg_mnd tilgang \r\nrename attftom_mnd avgang\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\nforvalues i=1992/2001 { \r\ngen attforing_`i'_01 = 0 \r\nreplace attforing_`i'_01 = 1 if tilgang<=`i'01 & avgang>=`i'01  \r\ngen attforing_`i'_02 = 0 \r\nreplace attforing_`i'_02 = 1 if tilgang<=`i'02 & avgang>=`i'02  \r\ngen attforing_`i'_03 = 0 \r\nreplace attforing_`i'_03 = 1 if tilgang<=`i'03 & avgang>=`i'03 \r\ngen attforing_`i'_04 = 0 \r\nreplace attforing_`i'_04 = 1 if tilgang<=`i'04 & avgang>=`i'04\r\ngen attforing_`i'_05 = 0 \r\nreplace attforing_`i'_05 = 1 if tilgang<=`i'05 & avgang>=`i'05\r\ngen attforing_`i'_06 = 0 \r\nreplace attforing_`i'_06 = 1 if tilgang<=`i'06 & avgang>=`i'06\r\ngen attforing_`i'_07 = 0 \r\nreplace attforing_`i'_07 = 1 if tilgang<=`i'07 & avgang>=`i'07\r\ngen attforing_`i'_08 = 0 \r\nreplace attforing_`i'_08 = 1 if tilgang<=`i'08 & avgang>=`i'08\r\ngen attforing_`i'_09 = 0 \r\nreplace attforing_`i'_09 = 1 if tilgang<=`i'09 & avgang>=`i'09\r\ngen attforing_`i'_10 = 0 \r\nreplace attforing_`i'_10 = 1 if tilgang<=`i'10 & avgang>=`i'10\r\ngen attforing_`i'_11 = 0 \r\nreplace attforing_`i'_11 = 1 if tilgang<=`i'11 & avgang>=`i'11\r\ngen attforing_`i'_12 = 0 \r\nreplace attforing_`i'_12 = 1 if tilgang<=`i'12 & avgang>=`i'12\r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2001.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2001.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2001 {\r\negen attforing_`i'01= total (attforing_`i'_01), by (w20_0450_lopenr_person)\r\negen attforing_`i'02= total (attforing_`i'_02), by (w20_0450_lopenr_person)\r\negen attforing_`i'03= total (attforing_`i'_03), by (w20_0450_lopenr_person)\r\negen attforing_`i'04= total (attforing_`i'_04), by (w20_0450_lopenr_person)\r\negen attforing_`i'05= total (attforing_`i'_05), by (w20_0450_lopenr_person)\r\negen attforing_`i'06= total (attforing_`i'_06), by (w20_0450_lopenr_person)\r\negen attforing_`i'07= total (attforing_`i'_07), by (w20_0450_lopenr_person)\r\negen attforing_`i'08= total (attforing_`i'_08), by (w20_0450_lopenr_person)\r\negen attforing_`i'09= total (attforing_`i'_09), by (w20_0450_lopenr_person)\r\negen attforing_`i'10= total (attforing_`i'_10), by (w20_0450_lopenr_person)\r\negen attforing_`i'11= total (attforing_`i'_11), by (w20_0450_lopenr_person)\r\negen attforing_`i'12= total (attforing_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=1992/2001 {\r\nreplace attforing_`i'01= 1 if attforing_`i'01 > 1 \r\nreplace attforing_`i'02= 1 if attforing_`i'02 > 1 \r\nreplace attforing_`i'03= 1 if attforing_`i'03 > 1 \r\nreplace attforing_`i'04= 1 if attforing_`i'04 > 1 \r\nreplace attforing_`i'05= 1 if attforing_`i'05 > 1 \r\nreplace attforing_`i'06= 1 if attforing_`i'06 > 1 \r\nreplace attforing_`i'07= 1 if attforing_`i'07 > 1 \r\nreplace attforing_`i'08= 1 if attforing_`i'08 > 1 \r\nreplace attforing_`i'09= 1 if attforing_`i'09 > 1 \r\nreplace attforing_`i'10= 1 if attforing_`i'10 > 1 \r\nreplace attforing_`i'11= 1 if attforing_`i'11 > 1 \r\nreplace attforing_`i'12= 1 if attforing_`i'12 > 1 \r\n\r\n}\r\n\r\n\r\ndrop attfkode-attforing_2001_12 ///fjerner variabler\r\n\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) ///lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\ndrop ufg bfg\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_2001_wide.dta\", replace ///lagrer filen i wide-format\r\n\r\n\r\n\r\n****************************************************************************\r\n*** Henter opp attf\u00f8ring og tilrettelegger ***\r\n\r\nuse \"N:\\durable\\Grunnlagsdata\\FD-trygd\\w20_0450_f_arbsok.dta\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2010.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2010.dta\", replace\r\n\r\nkeep if ytelse==\"AT\" /// MERK - sjekk at denne fungerer. \r\n\r\ngen tilgang= tilgdato_mnd\r\ngen avgang= asoktom_mnd\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n\r\nforvalues i=2001/2018 { \r\ngen attforing_`i'_01 = 0 \r\nreplace attforing_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)\r\ngen attforing_`i'_02 = 0 \r\nreplace attforing_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen attforing_`i'_03 = 0 \r\nreplace attforing_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen attforing_`i'_04 = 0 \r\nreplace attforing_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen attforing_`i'_05 = 0 \r\nreplace attforing_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen attforing_`i'_06 = 0 \r\nreplace attforing_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen attforing_`i'_07 = 0 \r\nreplace attforing_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen attforing_`i'_08 = 0 \r\nreplace attforing_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen attforing_`i'_09 = 0 \r\nreplace attforing_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen attforing_`i'_10 = 0 \r\nreplace attforing_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen attforing_`i'_11 = 0 \r\nreplace attforing_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen attforing_`i'_12 = 0 \r\nreplace attforing_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2010.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_tmp_2010.dta\", replace\r\n\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2001/2018 {\r\negen attforing_`i'01= total (attforing_`i'_01), by (w20_0450_lopenr_person)\r\negen attforing_`i'02= total (attforing_`i'_02), by (w20_0450_lopenr_person)\r\negen attforing_`i'03= total (attforing_`i'_03), by (w20_0450_lopenr_person)\r\negen attforing_`i'04= total (attforing_`i'_04), by (w20_0450_lopenr_person)\r\negen attforing_`i'05= total (attforing_`i'_05), by (w20_0450_lopenr_person)\r\negen attforing_`i'06= total (attforing_`i'_06), by (w20_0450_lopenr_person)\r\negen attforing_`i'07= total (attforing_`i'_07), by (w20_0450_lopenr_person)\r\negen attforing_`i'08= total (attforing_`i'_08), by (w20_0450_lopenr_person)\r\negen attforing_`i'09= total (attforing_`i'_09), by (w20_0450_lopenr_person)\r\negen attforing_`i'10= total (attforing_`i'_10), by (w20_0450_lopenr_person)\r\negen attforing_`i'11= total (attforing_`i'_11), by (w20_0450_lopenr_person)\r\negen attforing_`i'12= total (attforing_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n//Tillegger observasjoner med samme forl\u00f8psdatoer verdien 1 \r\n\r\nforvalues i=2001/2018 {\r\nreplace attforing_`i'01= 1 if attforing_`i'01 > 1 \r\nreplace attforing_`i'02= 1 if attforing_`i'02 > 1 \r\nreplace attforing_`i'03= 1 if attforing_`i'03 > 1 \r\nreplace attforing_`i'04= 1 if attforing_`i'04 > 1 \r\nreplace attforing_`i'05= 1 if attforing_`i'05 > 1 \r\nreplace attforing_`i'06= 1 if attforing_`i'06 > 1 \r\nreplace attforing_`i'07= 1 if attforing_`i'07 > 1 \r\nreplace attforing_`i'08= 1 if attforing_`i'08 > 1 \r\nreplace attforing_`i'09= 1 if attforing_`i'09 > 1 \r\nreplace attforing_`i'10= 1 if attforing_`i'10 > 1 \r\nreplace attforing_`i'11= 1 if attforing_`i'11 > 1 \r\nreplace attforing_`i'12= 1 if attforing_`i'12 > 1 \r\n\r\n}\r\n\r\n\r\ndrop attforing_2001_01-attforing_2018_12 //fjerner de opprinnelige variablene\r\n\r\ndrop kode-avgdato_mnd\r\n\r\ndrop attforing_200101-attforing_200104 ///Fjerner variabler som er p\u00e5 den andre fila \r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\r\n\r\ndrop dup\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_2018_wide.dta\", replace //lagrer filen i wide-format\r\n\r\n\r\n***Kobler filene***\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_2001_wide.dta\", replace \r\n\r\nmerge 1:1 w20_0450_lopenr_person using \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_2018_wide.dta\"\r\n\r\ndrop _merge\r\n\r\n\r\n***Gir de som har missing verdien 0\r\n\r\nforvalues i=1992/2018 {\r\nreplace attforing_`i'01= 0 if attforing_`i'01 == .\r\nreplace attforing_`i'02= 0 if attforing_`i'02 == . \r\nreplace attforing_`i'03= 0 if attforing_`i'03 == . \r\nreplace attforing_`i'04= 0 if attforing_`i'04 == . \r\nreplace attforing_`i'05= 0 if attforing_`i'05 == . \r\nreplace attforing_`i'06= 0 if attforing_`i'06 == . \r\nreplace attforing_`i'07= 0 if attforing_`i'07 == . \r\nreplace attforing_`i'08= 0 if attforing_`i'08 == . \r\nreplace attforing_`i'09= 0 if attforing_`i'09 == . \r\nreplace attforing_`i'10= 0 if attforing_`i'10 == .\r\nreplace attforing_`i'11= 0 if attforing_`i'11 == . \r\nreplace attforing_`i'12= 0 if attforing_`i'12 == . \r\n\r\n}\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\attforing_wide.dta\", replace\n\n# file: Arbeidss\u00f8ker.do\n\r\n\r\n\r\n****************************************************************************\r\n*** Henter opp arbeidss\u00f8ker og tilrettelegger ***\r\n\r\n***Lager arbeidss\u00f8kerfil p\u00e5 m\u00e5nedsbasis fra 1992 til 2001\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_arbsok_2001\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\n***Beholder de MED dagpenger***\r\n\r\nkeep if (stonad==\"DP\") \r\n\r\n***Beholder de helt ledige***\r\n\r\ngen helt_ledig= substr(arbstat,1,2)\r\n\r\nkeep if helt_ledig==\"HL\"\r\n\r\ntostring asoktilg_mnd, replace\r\ntostring asoktom_mnd, replace \r\n\r\ngen tilgang= substr(asoktilg_mnd,1,6)\r\ngen avgang= substr(asoktom_mnd,1,6)\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for arbeidss\u00f8ker\r\n\r\nforvalues i=1992/2001 { \r\ngen arbeidssoker_DP_`i'_01 = 0 \r\nreplace arbeidssoker_DP_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01)  \r\ngen arbeidssoker_DP_`i'_02 = 0 \r\nreplace arbeidssoker_DP_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02)\r\ngen arbeidssoker_DP_`i'_03 = 0 \r\nreplace arbeidssoker_DP_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03)\r\ngen arbeidssoker_DP_`i'_04 = 0 \r\nreplace arbeidssoker_DP_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04)\r\ngen arbeidssoker_DP_`i'_05 = 0 \r\nreplace arbeidssoker_DP_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05)\r\ngen arbeidssoker_DP_`i'_06 = 0 \r\nreplace arbeidssoker_DP_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06)\r\ngen arbeidssoker_DP_`i'_07 = 0 \r\nreplace arbeidssoker_DP_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07)\r\ngen arbeidssoker_DP_`i'_08 = 0 \r\nreplace arbeidssoker_DP_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08)\r\ngen arbeidssoker_DP_`i'_09 = 0 \r\nreplace arbeidssoker_DP_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09)\r\ngen arbeidssoker_DP_`i'_10 = 0 \r\nreplace arbeidssoker_DP_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10)\r\ngen arbeidssoker_DP_`i'_11 = 0 \r\nreplace arbeidssoker_DP_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11)\r\ngen arbeidssoker_DP_`i'_12 = 0 \r\nreplace arbeidssoker_DP_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12)\r\n\r\n}\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2001 {\r\negen arbeidssoker_DP_`i'01= total (arbeidssoker_DP_`i'_01), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'02= total (arbeidssoker_DP_`i'_02), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'03= total (arbeidssoker_DP_`i'_03), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'04= total (arbeidssoker_DP_`i'_04), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'05= total (arbeidssoker_DP_`i'_05), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'06= total (arbeidssoker_DP_`i'_06), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'07= total (arbeidssoker_DP_`i'_07), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'08= total (arbeidssoker_DP_`i'_08), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'09= total (arbeidssoker_DP_`i'_09), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'10= total (arbeidssoker_DP_`i'_10), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'11= total (arbeidssoker_DP_`i'_11), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'12= total (arbeidssoker_DP_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n// Gir alle m\u00e5nedsregisteringer hvor en person er arbeidssoker verdien 1 \r\n\r\nforvalues i=1992/2001 {\r\nreplace arbeidssoker_DP_`i'01= 1 if arbeidssoker_DP_`i'01 > 1\r\nreplace arbeidssoker_DP_`i'02= 1 if arbeidssoker_DP_`i'02 > 1\r\nreplace arbeidssoker_DP_`i'03= 1 if arbeidssoker_DP_`i'03 > 1\r\nreplace arbeidssoker_DP_`i'04= 1 if arbeidssoker_DP_`i'04 > 1\r\nreplace arbeidssoker_DP_`i'05= 1 if arbeidssoker_DP_`i'05 > 1\r\nreplace arbeidssoker_DP_`i'06= 1 if arbeidssoker_DP_`i'06 > 1\r\nreplace arbeidssoker_DP_`i'07= 1 if arbeidssoker_DP_`i'07 > 1\r\nreplace arbeidssoker_DP_`i'08= 1 if arbeidssoker_DP_`i'08 > 1\r\nreplace arbeidssoker_DP_`i'09= 1 if arbeidssoker_DP_`i'09 > 1\r\nreplace arbeidssoker_DP_`i'10= 1 if arbeidssoker_DP_`i'10 > 1\r\nreplace arbeidssoker_DP_`i'11= 1 if arbeidssoker_DP_`i'11 > 1\r\nreplace arbeidssoker_DP_`i'12= 1 if arbeidssoker_DP_`i'12 > 1\r\n\r\n}\r\n\r\ndrop asokkode-avgang\r\n\r\ndrop arbeidssoker_DP_1992_01-arbeidssoker_DP_2001_12\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\ntab dup\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\t \r\n\r\ndrop dup\t \r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_trygd_2001\", replace\r\n\r\n****************************************************************************************************\r\n****************************************************************************************************\r\n****************************************************************************************************\r\n\r\n\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_arbsok_2001\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\n\r\n***Beholder de IKKE dagpenger***\r\n\r\nkeep if (stonad==\"ID\") \r\n\r\n\r\n***Beholder de helt ledige***\r\n\r\ngen helt_ledig= substr(arbstat,1,2)\r\n\r\nkeep if helt_ledig==\"HL\"\r\n\r\ntostring asoktilg_mnd, replace\r\ntostring asoktom_mnd, replace \r\n\r\ngen tilgang= substr(asoktilg_mnd,1,6)\r\ngen avgang= substr(asoktom_mnd,1,6)\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for arbeidss\u00f8ker\r\n\r\nforvalues i=1992/2001 { \r\ngen arbeidssoker_ID_`i'_01 = 0 \r\nreplace arbeidssoker_ID_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)  \r\ngen arbeidssoker_ID_`i'_02 = 0 \r\nreplace arbeidssoker_ID_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen arbeidssoker_ID_`i'_03 = 0 \r\nreplace arbeidssoker_ID_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen arbeidssoker_ID_`i'_04 = 0 \r\nreplace arbeidssoker_ID_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen arbeidssoker_ID_`i'_05 = 0 \r\nreplace arbeidssoker_ID_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen arbeidssoker_ID_`i'_06 = 0 \r\nreplace arbeidssoker_ID_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen arbeidssoker_ID_`i'_07 = 0 \r\nreplace arbeidssoker_ID_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen arbeidssoker_ID_`i'_08 = 0 \r\nreplace arbeidssoker_ID_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen arbeidssoker_ID_`i'_09 = 0 \r\nreplace arbeidssoker_ID_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen arbeidssoker_ID_`i'_10 = 0 \r\nreplace arbeidssoker_ID_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen arbeidssoker_ID_`i'_11 = 0 \r\nreplace arbeidssoker_ID_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen arbeidssoker_ID_`i'_12 = 0 \r\nreplace arbeidssoker_ID_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2001_tmp.dta\", replace\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=1992/2001 {\r\negen arbeidssoker_ID_`i'01= total (arbeidssoker_ID_`i'_01), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'02= total (arbeidssoker_ID_`i'_02), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'03= total (arbeidssoker_ID_`i'_03), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'04= total (arbeidssoker_ID_`i'_04), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'05= total (arbeidssoker_ID_`i'_05), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'06= total (arbeidssoker_ID_`i'_06), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'07= total (arbeidssoker_ID_`i'_07), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'08= total (arbeidssoker_ID_`i'_08), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'09= total (arbeidssoker_ID_`i'_09), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'10= total (arbeidssoker_ID_`i'_10), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'11= total (arbeidssoker_ID_`i'_11), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'12= total (arbeidssoker_ID_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n// Gir alle m\u00e5nedsregisteringer hvor en person er arbeidssoker verdien 1 \r\n\r\nforvalues i=1992/2001 {\r\nreplace arbeidssoker_ID_`i'01= 1 if arbeidssoker_ID_`i'01 > 1\r\nreplace arbeidssoker_ID_`i'02= 1 if arbeidssoker_ID_`i'02 > 1\r\nreplace arbeidssoker_ID_`i'03= 1 if arbeidssoker_ID_`i'03 > 1\r\nreplace arbeidssoker_ID_`i'04= 1 if arbeidssoker_ID_`i'04 > 1\r\nreplace arbeidssoker_ID_`i'05= 1 if arbeidssoker_ID_`i'05 > 1\r\nreplace arbeidssoker_ID_`i'06= 1 if arbeidssoker_ID_`i'06 > 1\r\nreplace arbeidssoker_ID_`i'07= 1 if arbeidssoker_ID_`i'07 > 1\r\nreplace arbeidssoker_ID_`i'08= 1 if arbeidssoker_ID_`i'08 > 1\r\nreplace arbeidssoker_ID_`i'09= 1 if arbeidssoker_ID_`i'09 > 1\r\nreplace arbeidssoker_ID_`i'10= 1 if arbeidssoker_ID_`i'10 > 1\r\nreplace arbeidssoker_ID_`i'11= 1 if arbeidssoker_ID_`i'11 > 1\r\nreplace arbeidssoker_ID_`i'12= 1 if arbeidssoker_ID_`i'12 > 1\r\n\r\n}\r\n\r\ndrop asokkode-avgang\r\n\r\ndrop arbeidssoker_ID_1992_01-arbeidssoker_ID_2001_12\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\ntab dup\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\t \r\n\r\ndrop dup\t \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_uten_trygd_2001\", replace\r\n\r\n****************************************************************************************************\r\n****************************************************************************************************\r\n****************************************************************************************************\r\n\r\n***Lager arbeidss\u00f8kerfil p\u00e5 m\u00e5nedsbasis fra 2001_05 til 2018\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_arbsok\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\n\r\n***Beholder de MED dagpenger***\r\n\r\nkeep if (ytelse==\"DP\") \r\n\r\n\r\n***Beholder de helt ledige***\r\n\r\nkeep if hovedarbstat==\"HL\"\r\n\r\ntostring asoktilg_mnd, replace\r\ntostring asoktom_mnd, replace \r\n\r\ngen tilgang= substr(asoktilg_mnd,1,6)\r\ngen avgang= substr(asoktom_mnd,1,6)\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for arbeidss\u00f8ker\r\n\r\n\r\nforvalues i=2001/2018 { \r\ngen arbeidssoker_DP_`i'_01 = 0 \r\nreplace arbeidssoker_DP_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)  \r\ngen arbeidssoker_DP_`i'_02 = 0 \r\nreplace arbeidssoker_DP_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen arbeidssoker_DP_`i'_03 = 0 \r\nreplace arbeidssoker_DP_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen arbeidssoker_DP_`i'_04 = 0 \r\nreplace arbeidssoker_DP_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen arbeidssoker_DP_`i'_05 = 0 \r\nreplace arbeidssoker_DP_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen arbeidssoker_DP_`i'_06 = 0 \r\nreplace arbeidssoker_DP_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen arbeidssoker_DP_`i'_07 = 0 \r\nreplace arbeidssoker_DP_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen arbeidssoker_DP_`i'_08 = 0 \r\nreplace arbeidssoker_DP_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen arbeidssoker_DP_`i'_09 = 0 \r\nreplace arbeidssoker_DP_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen arbeidssoker_DP_`i'_10 = 0 \r\nreplace arbeidssoker_DP_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen arbeidssoker_DP_`i'_11 = 0 \r\nreplace arbeidssoker_DP_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen arbeidssoker_DP_`i'_12 = 0 \r\nreplace arbeidssoker_DP_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2001/2018 {\r\negen arbeidssoker_DP_`i'01= total (arbeidssoker_DP_`i'_01), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'02= total (arbeidssoker_DP_`i'_02), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'03= total (arbeidssoker_DP_`i'_03), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'04= total (arbeidssoker_DP_`i'_04), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'05= total (arbeidssoker_DP_`i'_05), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'06= total (arbeidssoker_DP_`i'_06), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'07= total (arbeidssoker_DP_`i'_07), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'08= total (arbeidssoker_DP_`i'_08), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'09= total (arbeidssoker_DP_`i'_09), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'10= total (arbeidssoker_DP_`i'_10), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'11= total (arbeidssoker_DP_`i'_11), by (w20_0450_lopenr_person)\r\negen arbeidssoker_DP_`i'12= total (arbeidssoker_DP_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n// Gir alle m\u00e5nedsregisteringer hvor en person er arbeidssoker verdien 1 \r\n\r\nforvalues i=2001/2018 {\r\nreplace arbeidssoker_DP_`i'01= 1 if arbeidssoker_DP_`i'01 > 1\r\nreplace arbeidssoker_DP_`i'02= 1 if arbeidssoker_DP_`i'02 > 1\r\nreplace arbeidssoker_DP_`i'03= 1 if arbeidssoker_DP_`i'03 > 1\r\nreplace arbeidssoker_DP_`i'04= 1 if arbeidssoker_DP_`i'04 > 1\r\nreplace arbeidssoker_DP_`i'05= 1 if arbeidssoker_DP_`i'05 > 1\r\nreplace arbeidssoker_DP_`i'06= 1 if arbeidssoker_DP_`i'06 > 1\r\nreplace arbeidssoker_DP_`i'07= 1 if arbeidssoker_DP_`i'07 > 1\r\nreplace arbeidssoker_DP_`i'08= 1 if arbeidssoker_DP_`i'08 > 1\r\nreplace arbeidssoker_DP_`i'09= 1 if arbeidssoker_DP_`i'09 > 1\r\nreplace arbeidssoker_DP_`i'10= 1 if arbeidssoker_DP_`i'10 > 1\r\nreplace arbeidssoker_DP_`i'11= 1 if arbeidssoker_DP_`i'11 > 1\r\nreplace arbeidssoker_DP_`i'12= 1 if arbeidssoker_DP_`i'12 > 1\r\n\r\n}\r\n\r\ndrop kode hoved hovedarbstat tiltak ytelse as_f as_gr regdato_mnd ///\r\n     tilgdato_mnd avgdato_mnd asoktilg_mnd asokavg_mnd hovedarbdato_mnd /// \r\n\t tiltakdato_mnd ytelsedato_mnd dagdato_mnd henddato_mnd asoktom_mnd ///\r\n\t tomdato_mnd tilgang avgang arbeidssoker_DP_2001_01-arbeidssoker_DP_2018_12 ///\r\n     arbeidssoker_DP_200101-arbeidssoker_DP_200104\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\ntab dup\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\t \r\n\r\ndrop dup\t \r\n\r\nsort w20_0450_lopenr_person\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_trygd_2018.dta\", replace\r\n\r\n****************************************************************************************************\r\n****************************************************************************************************\r\n****************************************************************************************************\r\n\r\n***Lager arbeidss\u00f8kerfil p\u00e5 m\u00e5nedsbasis fra 2001_05 til 2018\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd\\w20_0450_f_arbsok\", replace \r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\n\r\n***Beholder de UTEN dagpenger***\r\n\r\nkeep if (ytelse==\"ID\") \r\n\r\n\r\n***Beholder de helt ledige***\r\n\r\nkeep if hovedarbstat==\"HL\"\r\n\r\ntostring asoktilg_mnd, replace\r\ntostring asoktom_mnd, replace \r\n\r\ngen tilgang= substr(asoktilg_mnd,1,6)\r\ngen avgang= substr(asoktom_mnd,1,6)\r\n\r\ndestring tilgang, replace\r\ndestring avgang, replace\r\n\r\n//Lager m\u00e5nedsobservasjoner innen \u00e5r for arbeidss\u00f8ker\r\n\r\n\r\nforvalues i=2001/2018 { \r\ngen arbeidssoker_ID_`i'_01 = 0 \r\nreplace arbeidssoker_ID_`i'_01 = 1 if tilgang<=`i'01 & (avgang>=`i'01 | avgang== .)  \r\ngen arbeidssoker_ID_`i'_02 = 0 \r\nreplace arbeidssoker_ID_`i'_02 = 1 if tilgang<=`i'02 & (avgang>=`i'02 | avgang== .)\r\ngen arbeidssoker_ID_`i'_03 = 0 \r\nreplace arbeidssoker_ID_`i'_03 = 1 if tilgang<=`i'03 & (avgang>=`i'03 | avgang== .)\r\ngen arbeidssoker_ID_`i'_04 = 0 \r\nreplace arbeidssoker_ID_`i'_04 = 1 if tilgang<=`i'04 & (avgang>=`i'04 | avgang== .)\r\ngen arbeidssoker_ID_`i'_05 = 0 \r\nreplace arbeidssoker_ID_`i'_05 = 1 if tilgang<=`i'05 & (avgang>=`i'05 | avgang== .)\r\ngen arbeidssoker_ID_`i'_06 = 0 \r\nreplace arbeidssoker_ID_`i'_06 = 1 if tilgang<=`i'06 & (avgang>=`i'06 | avgang== .)\r\ngen arbeidssoker_ID_`i'_07 = 0 \r\nreplace arbeidssoker_ID_`i'_07 = 1 if tilgang<=`i'07 & (avgang>=`i'07 | avgang== .)\r\ngen arbeidssoker_ID_`i'_08 = 0 \r\nreplace arbeidssoker_ID_`i'_08 = 1 if tilgang<=`i'08 & (avgang>=`i'08 | avgang== .)\r\ngen arbeidssoker_ID_`i'_09 = 0 \r\nreplace arbeidssoker_ID_`i'_09 = 1 if tilgang<=`i'09 & (avgang>=`i'09 | avgang== .)\r\ngen arbeidssoker_ID_`i'_10 = 0 \r\nreplace arbeidssoker_ID_`i'_10 = 1 if tilgang<=`i'10 & (avgang>=`i'10 | avgang== .)\r\ngen arbeidssoker_ID_`i'_11 = 0 \r\nreplace arbeidssoker_ID_`i'_11 = 1 if tilgang<=`i'11 & (avgang>=`i'11 | avgang== .)\r\ngen arbeidssoker_ID_`i'_12 = 0 \r\nreplace arbeidssoker_ID_`i'_12 = 1 if tilgang<=`i'12 & (avgang>=`i'12 | avgang== .)\r\n\r\n}\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_2018_tmp.dta\", replace\r\n\r\n//Finner alle m\u00e5nedsregisteringer innen person og lager nye variabler\r\n\r\nforvalues i=2001/2018 {\r\negen arbeidssoker_ID_`i'01= total (arbeidssoker_ID_`i'_01), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'02= total (arbeidssoker_ID_`i'_02), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'03= total (arbeidssoker_ID_`i'_03), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'04= total (arbeidssoker_ID_`i'_04), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'05= total (arbeidssoker_ID_`i'_05), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'06= total (arbeidssoker_ID_`i'_06), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'07= total (arbeidssoker_ID_`i'_07), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'08= total (arbeidssoker_ID_`i'_08), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'09= total (arbeidssoker_ID_`i'_09), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'10= total (arbeidssoker_ID_`i'_10), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'11= total (arbeidssoker_ID_`i'_11), by (w20_0450_lopenr_person)\r\negen arbeidssoker_ID_`i'12= total (arbeidssoker_ID_`i'_12), by (w20_0450_lopenr_person)\r\n\r\n}\r\n\r\n// Gir alle m\u00e5nedsregisteringer hvor en person er arbeidssoker verdien 1 \r\n\r\nforvalues i=2001/2018 {\r\nreplace arbeidssoker_ID_`i'01= 1 if arbeidssoker_ID_`i'01 > 1\r\nreplace arbeidssoker_ID_`i'02= 1 if arbeidssoker_ID_`i'02 > 1\r\nreplace arbeidssoker_ID_`i'03= 1 if arbeidssoker_ID_`i'03 > 1\r\nreplace arbeidssoker_ID_`i'04= 1 if arbeidssoker_ID_`i'04 > 1\r\nreplace arbeidssoker_ID_`i'05= 1 if arbeidssoker_ID_`i'05 > 1\r\nreplace arbeidssoker_ID_`i'06= 1 if arbeidssoker_ID_`i'06 > 1\r\nreplace arbeidssoker_ID_`i'07= 1 if arbeidssoker_ID_`i'07 > 1\r\nreplace arbeidssoker_ID_`i'08= 1 if arbeidssoker_ID_`i'08 > 1\r\nreplace arbeidssoker_ID_`i'09= 1 if arbeidssoker_ID_`i'09 > 1\r\nreplace arbeidssoker_ID_`i'10= 1 if arbeidssoker_ID_`i'10 > 1\r\nreplace arbeidssoker_ID_`i'11= 1 if arbeidssoker_ID_`i'11 > 1\r\nreplace arbeidssoker_ID_`i'12= 1 if arbeidssoker_ID_`i'12 > 1\r\n\r\n}\r\n\r\ndrop kode hoved hovedarbstat tiltak ytelse as_f as_gr regdato_mnd ///\r\n     tilgdato_mnd avgdato_mnd asoktilg_mnd asokavg_mnd hovedarbdato_mnd /// \r\n\t tiltakdato_mnd ytelsedato_mnd dagdato_mnd henddato_mnd asoktom_mnd ///\r\n\t tomdato_mnd tilgang avgang arbeidssoker_ID_2001_01-arbeidssoker_ID_2018_12 ///\r\n     arbeidssoker_ID_200101-arbeidssoker_ID_200104\r\n\r\nsort w20_0450_lopenr_person\r\nquietly by w20_0450_lopenr_person :  gen dup = cond(_N==1,0,_n) //lager duplikat-variabel\r\ntab dup\r\n\r\ndrop if dup>1 //beholder kun f\u00f8rst observasjon\t \r\n\r\ndrop dup\t \r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_uten_trygd_2018.dta\", replace\r\n\r\n\r\n\r\n***Kobler filene***\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_trygd_2001.dta\", replace \r\n\r\nmerge 1:1 w20_0450_lopenr_person using \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_trygd_2018.dta\"\r\n\r\ndrop _merge\r\n\r\n\r\n***Gir de som har missing verdien 0\r\n\r\nforvalues i=1992/2018 {\r\nreplace arbeidssoker_DP_`i'01= 0 if arbeidssoker_DP_`i'01 == .\r\nreplace arbeidssoker_DP_`i'02= 0 if arbeidssoker_DP_`i'02 == . \r\nreplace arbeidssoker_DP_`i'03= 0 if arbeidssoker_DP_`i'03 == . \r\nreplace arbeidssoker_DP_`i'04= 0 if arbeidssoker_DP_`i'04 == . \r\nreplace arbeidssoker_DP_`i'05= 0 if arbeidssoker_DP_`i'05 == . \r\nreplace arbeidssoker_DP_`i'06= 0 if arbeidssoker_DP_`i'06 == . \r\nreplace arbeidssoker_DP_`i'07= 0 if arbeidssoker_DP_`i'07 == . \r\nreplace arbeidssoker_DP_`i'08= 0 if arbeidssoker_DP_`i'08 == . \r\nreplace arbeidssoker_DP_`i'09= 0 if arbeidssoker_DP_`i'09 == . \r\nreplace arbeidssoker_DP_`i'10= 0 if arbeidssoker_DP_`i'10 == .\r\nreplace arbeidssoker_DP_`i'11= 0 if arbeidssoker_DP_`i'11 == . \r\nreplace arbeidssoker_DP_`i'12= 0 if arbeidssoker_DP_`i'12 == . \r\n\r\n}\r\n\r\n*MERK DET ER BRUDD FRA 200105 til 200112 - alt for lave tall.\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidssoker_DP_wide.dta\", replace\r\n\r\n*****************************************************************************************************\r\n\r\nuse \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_uten_trygd_2001.dta\", replace \r\n\r\nmerge 1:1 w20_0450_lopenr_person using \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidsoker_uten_trygd_2018.dta\"\r\n\r\ndrop _merge\r\n\r\n\r\n***Gir de som har missing verdien 0\r\n\r\nforvalues i=1992/2018 {\r\nreplace arbeidssoker_ID_`i'01= 0 if arbeidssoker_ID_`i'01 == .\r\nreplace arbeidssoker_ID_`i'02= 0 if arbeidssoker_ID_`i'02 == . \r\nreplace arbeidssoker_ID_`i'03= 0 if arbeidssoker_ID_`i'03 == . \r\nreplace arbeidssoker_ID_`i'04= 0 if arbeidssoker_ID_`i'04 == . \r\nreplace arbeidssoker_ID_`i'05= 0 if arbeidssoker_ID_`i'05 == . \r\nreplace arbeidssoker_ID_`i'06= 0 if arbeidssoker_ID_`i'06 == . \r\nreplace arbeidssoker_ID_`i'07= 0 if arbeidssoker_ID_`i'07 == . \r\nreplace arbeidssoker_ID_`i'08= 0 if arbeidssoker_ID_`i'08 == . \r\nreplace arbeidssoker_ID_`i'09= 0 if arbeidssoker_ID_`i'09 == . \r\nreplace arbeidssoker_ID_`i'10= 0 if arbeidssoker_ID_`i'10 == .\r\nreplace arbeidssoker_ID_`i'11= 0 if arbeidssoker_ID_`i'11 == . \r\nreplace arbeidssoker_ID_`i'12= 0 if arbeidssoker_ID_`i'12 == . \r\n\r\n}\r\n\r\n*MERK DET ER BRUDD FRA 200105 til 200112 - alt for lave tall.\r\n\r\n\r\nsave \"N:\\durable\\Prosjekt 10\\Grunnlagsdata\\FD-trygd mnd statuser\\arbeidssoker_ID_wide.dta\", replace"
  },
  {
    "title": "COVID-19 vaksiner: Misinformasjon og diskurser",
    "authors": "Siri Frisli",
    "language": "R",
    "data": "text corpus",
    "methods": [
      "topic modeling",
      "sentiment analysis",
      "mixed-methods"
    ],
    "themes": [
      "sosiale medier",
      "covid",
      "misinformasjon"
    ],
    "description": "Unders\u00f8ker diskursive trender innen vaksinemisinformasjon fra COVID-19 pandemien. Les mer her: https://doi.org/10.1177/20563051251347614",
    "folder": "CADS-covid-topic-modeling",
    "files": [
      "CADS-covid-topic-modeling/STM.R",
      "CADS-covid-topic-modeling/topics_30.txt",
      "CADS-covid-topic-modeling/sentiments.R"
    ],
    "code": "# file: STM.R\npackages <- c(\"tidyverse\", \"tidytext\", \"stm\", \"quanteda\", \"stopwords\", \"readxl\",\n              \"Rtsne\", \"rsvd\", \"geometry\", \"tm\", \"tidystm\", \"stminsights\", \"igraph\",\n              \"factoextra\", \"GGally\", \"labelled\", \"patchwork\")\nlapply(packages, library, character.only = TRUE)\n\nSys.setlocale(locale = \"Norwegian\")\n\ntheme_set(\n  theme_bw() +\n    theme(legend.position = \"top\")\n  )\n\n\n################################################################################\n\n# Loading the data fixing the date column, and removing usernames and retweets\ntwitter <- readRDS(\"D:/Data/Datasets/covid_classified_final.RDS\")\n\ntwitter$date <- ym(twitter$date)\nglimpse(twitter)\n\n# one of the date values is missing, need to fix this\nwhich(is.na(twitter$date)) # 62653\nrow_index <- 62653\ntwitter$date[row_index] <- as.Date(\"2020-03-01\")\n\n# The date column must be nummeric for the STM\ntwitter$date_num <- as.numeric(twitter$date)\n\ntwitter_unnest <- unnest(twitter, referenced_tweets, names_sep = \"_ref_\", keep_empty = TRUE) \n\ntwitter_rt <- twitter_unnest |>\n  filter(referenced_tweets_ref_type == \"retweeted\") |>\n  rename(\"orig_id\" = \"id\")\n\ntwitter_nort <- twitter_unnest |>\n  anti_join(twitter_rt, by = \"id\")\n\nno_match_id <- twitter_rt |>\n  anti_join(twitter_nort, by = c(\"referenced_tweets_ref_id\" = \"id\"))\n\n# saving this dataset for easy access\nsaveRDS(twitter_nort, \"D:/Data/Datasets/CADS_datasets/twitter_data_no_rt.RDS\")\n\n################################################################################\n\ntwitter <- readRDS(\"E:/Data/Datasets/CADS_datasets/twitter_data_no_rt.RDS\")\nglimpse(twitter)\n\nremoveUsernames <- function(tweet) {\n  return(gsub(\"@[a-z,A-Z,_]*[0-9]*[a-z,A-Z,_]*[0-9]*\", \"\", tweet))\n}\ntwitter$tweet <- apply(twitter[\"tweet\"], 1, removeUsernames)\n\n# Remove the \"rt\" at the start of retweeted tweets\n# twitter$tweet <- gsub(\"^rt\", \"\", twitter$tweet)\n# twitter$tweet <- gsub(\"^RT\", \"\", twitter$tweet)\n\n# Converting the data to a corpus from the quanteda package\ntwitter_corpus <- corpus(twitter, text_field = \"tweet\")\n\n# Loading a list of stopwords\nstopwords <- read_xlsx(\"~/INORK_ST/stopwords.xlsx\")\ncustom_words <- stopwords |>\n  pull(word)\n\n# Tokenizing, removing punctuation, symbols, etc.\ntwitter_tokens <- quanteda::tokens(twitter_corpus,\n                                   split_hyphens = FALSE,\n                                   remove_punct = TRUE,\n                                   remove_symbols = TRUE,\n                                   remove_numbers = TRUE,\n                                   remove_url = TRUE,\n                                   remove_separators = TRUE,\n                                   split_tags = FALSE) |>\n  tokens_remove(pattern = c(stopwords::stopwords(source = \"snowball\", language = \"no\"), custom_words)) |>\n  tokens_remove(pattern = c(stopwords::stopwords(source = \"snowball\", language = \"en\")))\n\ntokens_ngrams <- tokens_compound(twitter_tokens, \n                                 phrase(c(\"korona virus\", \"corona virus\", \"korona pandemi\", \"corona pandemi\", \n                                          \"korona viruset\", \"corona viruset\", \"korona pandemien\", \"corona pandemien\", \n                                          \"korona vaksine\", \"corona vaksine\", \"korona vaksinen\", \"corona vaksinen\", \n                                          \"fake news\", \"falske nyheter\", \"falsk nyhet\", \"p\u00e5l steigan\", \"sosiale medier\",\n                                          \"r\u00f8de kors\", \"erna solberg\", \"jonas gahr st\u00f8re\", \"bent h\u00f8ie\", \"ingvild kjerkol\",\n                                          \"donald trump\", \"j\u00f8rn sigurd maurud\", \"anthony fauci\", \"new york times\", \n                                          \"joe biden\", \"boris johnson\", \"big pharma\", \"bill gates\", \"stig fr\u00f8land\",\n                                          \"durek verrett\", \"joe rogan\", \"elon musk\", \"hong kong\", \"long covid\",\n                                          \"espen nakstad\", \"zero covid\", \"karl johan\", \"raymon johansen\", case_insensitive = TRUE)))\n\ntwitter_dfm <- dfm(tokens_ngrams, tolower = TRUE)\ntwitter_stm <- convert(twitter_dfm, to = \"stm\")\nplotRemoved(twitter_stm$documents, lower.thresh = seq(1,100, by = 10))\n\ntwitter_prepped <- prepDocuments(twitter_stm$documents,\n                                 twitter_stm$vocab, \n                                 twitter_stm$meta, \n                                 lower.thresh = 10)\n\ntwitter_prepped$meta$label <- as.factor(twitter_prepped$meta$label)\n\ndocs_twitter <- twitter_prepped$documents\nvocab_twitter <- twitter_prepped$vocab\nmeta_twitter <- twitter_prepped$meta\n\n# saveRDS(docs_twitter, \"D:/Modell/CADS/docs_twitter.RDS\")\n# saveRDS(vocab_twitter, \"D:/Modell/CADS/vocab_twitter.RDS\")\n# saveRDS(meta_twitter, \"D:/Modell/CADS/meta_twitter.RDS\")\n\n################################################################################\nstm_k_search <- stm(documents = docs_twitter,\n                    vocab = vocab_twitter,\n                    K = 0,\n                    prevalence = ~label * s(date_num),\n                    content = ~label,\n                    max.em.its = 75,\n                    data = meta_twitter,\n                    init.type = \"Spectral\",\n                    set.seed(1234),\n                    verbose = TRUE)\n\nstm_k_search # 76 topics\n\n################################################################################\n\nK <- c(20, 30, 40, 50, 60, 70)\nstm_K_search <- searchK(documents = docs_twitter,\n                        vocab = vocab_twitter,\n                        K = K,\n                        prevalence = ~label * s(date_num),\n                        data = meta_twitter,\n                        set.seed(1234),\n                        verbose = TRUE)\n\n# saveRDS(stm_K_search, \"~/CADS/searchK.RDS\")\n\nplot(stm_K_search)\nplot_stm_k <- data.frame(\"K\" = K, \n                         \"Coherence\" = unlist(stm_K_search$results$semcoh),\n                         \"Exclusivity\" = unlist(stm_K_search$results$exclus))\n\n# Reshape to long format\nlibrary(\"reshape2\")\nplot <- melt(plot_stm_k, id=c(\"K\"))\nplot # 50 topics? Too many_\n\n################################################################################\n\nstm_30_interaction <- stm(documents = docs_twitter,\n                          vocab = vocab_twitter,\n                          K = 30,\n                          prevalence = ~label * s(date_num),\n                          content = ~label,\n                          max.em.its = 75,\n                          data = meta_twitter,\n                          init.type = \"Spectral\",\n                          set.seed(1234),\n                          verbose = TRUE)\nlevels(meta_twitter$label) # misinformation as baseline?\nsaveRDS(stm_30_interaction, \"D:/Modell/CADS/stm_30_interaction.RDS\")\n\nplot(stm_40_interaction)\n\n###\n### Topic distributions and words\n###\nstm_30_gamma <- tidy(stm_30_interaction,\n                     matrix = \"gamma\")\n\nstm_30_terms <- stm_30_gamma |>\n  group_by(topic) |>\n  summarise(gamma = mean(gamma)) |>\n  arrange(desc(gamma)) |>\n  mutate(topic = paste0(\"Topic \", topic),\n         topic = reorder(topic, gamma))\n\nstm_30_terms |>\n  top_n(30, gamma) |>\n  ggplot(aes(topic, gamma)) +\n  geom_col(fill = \"gray\", color = \"black\", show.legend = FALSE) +\n  labs(title = \"Topic Proportions\", y = \"\", x = \"\") +\n  coord_flip()\n\n# frex_20 <- tidy(stm_20_interaction, matrix = \"frex\") |>\n#   group_by(topic) |>\n#   slice_head(n = 10) |>\n#   mutate(rank = row_number()) |>\n#   ungroup() |>\n#   pivot_wider(\n#     names_from = \"topic\", \n#     names_glue = \"topic {.name}\",\n#     values_from = term\n#   ) |>\n#   select(-rank) |>\n#   knitr::kable()\n\ntopics_30 <- sageLabels(stm_30_interaction, n = 20)\nsink(\"topics_30.txt\", append = FALSE, split = TRUE)\nprint(topics_30)\nsink()\n\n################################################################################\n\neffect30 <- estimateEffect(1:30 ~label * s(date_num),\n                           stmobj = stm_30_interaction,\n                           metadata = meta_twitter,\n                           set.seed(1234),\n                           uncertainty = \"Global\")\n# saveRDS(effect30, \"D:/Modell/CADS/effect30.RDS\")\n\neffect30_label <- get_effects(effect30, variable = \"label\",\n                              type = \"pointestimate\")\n\neffect30_label$topic <- reorder(x = effect30_label$topic,\n                                effect30_label$proportion)\n\neffect30_label$value <- str_replace_all(effect30_label$value, \"misinfo\", \"misinformation\")\neffect30_label$value <- str_replace_all(effect30_label$value, \"non.\", \"non-\")\n\nlegend <- c(\"non-misinformation\" = \"#d8b365\", \"misinformation\" = \"#8c510a\")\n\neffect30_label_filt <- effect30_label |>\n  filter(!topic %in% c(7, 10, 14, 27, 30)) |>\n  droplevels()\n\neffect30_label |>\n  ggplot(aes(x = topic, y = proportion, color = value, group = value, fill = value)) +\n  geom_point(size = 3) +\n  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.3) +\n  scale_x_discrete(name = \"Topic\", limits = rev(levels(effect30_label_filt$topic))) +\n  theme(legend.position = \"inside\",legend.position.inside = c(.8,.85), \n        legend.text = element_text(size = 14), legend.title = element_text(size = 15),\n        axis.text.x = element_text(size = 12)) + \n  scale_color_manual(values = legend)+\n  labs(title = \"\", y = \"Proportion\", x = \"\", color = \"Label\", fill = \"Label\")\n\nggsave(\"Figure 1.tiff\",dpi = 300)\n\n################################################################################\n# specifying labels for the x-axis to be used in the plots\n\ntwitter$month <- format(twitter$date, format = \"%Y-%m\")\n\ntwitter_date <- twitter |>\n  group_by(month, date_num) |>\n  select(month, date_num) |>\n  slice(1) |>\n  ungroup()\n\ntwitter_date_2 <- twitter_date |> \n  filter(row_number() %% 2 != 0)\n\ntwitter_date <- as.character(twitter_date$month)\ntwitter_date_2 <- as.character(twitter_date_2$month)\n\n# breaks_to_use <- unique(effect_time$value)[seq_along(twitter_date)]\nlabels_to_use <- twitter_date\nlabels_to_use_2 <- twitter_date_2\n################################################################################\n\n## after date\neffect30_date <- extract.estimateEffect(effect30,\n                                        \"date_num\",\n                                        method = \"continuous\")\n\neffect30_date <- effect30_date |>\n  mutate(topic = fct_reorder(as.factor(topic), covariate.value))\n\neffect30_date |>\n  filter(topic == 23) |>\n  ggplot(aes(x = covariate.value, y = estimate, group = topic,color = topic)) +\n  geom_line(linewidth = 1) +\n  scale_y_continuous() +\n  scale_x_continuous(limits = c(18262,19312), \n                     breaks = seq(from = 18262, to = 19312, by = 30), \n                     labels = labels_to_use) + \n  theme(legend.position = \"top\", axis.text.x = element_text(angle = 45, hjust = 1))\n\n################################################################################\n# Change in time for the misinformation topics\n\neffect_time <- get_effects(effect30, variable = \"date_num\",\n                           type = \"continuous\",\n                           moderator = \"label\",\n                           modval = \"misinfo\") |>\n  bind_rows(get_effects(effect30, variable = \"date_num\",\n                        type = \"continuous\",\n                        moderator = \"label\",\n                        modval = \"non.misinfo\"))\n\n# \"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#c7eae5\", \"#5ab4ac\", \"#01665e\"\n\ntop_five <-  effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(1, 6, 12, 13, 27))\n\ntop_five |>\n   ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n   geom_line(linewidth = 2) +\n   scale_x_continuous(limits = c(18262,19312),\n                      breaks = seq(from = 18262, to = 19312, by = 60),\n                      labels = labels_to_use_2) +\n   scale_y_continuous(limits = c(0,0.1)) +\n   scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#5ab4ac\", \"#01665e\"), \n                      labels = c(\n                        \"1: Characteristics of the Virus\",\n                        \"12: Statistics \u2013 Mortality Rates and Vaccination\",\n                        \"13: International News\",\n                        \"27: Sports and Jesus\",\n                        \"6: Economy and Finance\"\n                      )) +\n   theme(legend.position = \"inside\", legend.position.inside = c(.8,.8), \n         legend.text = element_text(size = 14), legend.title = element_text(size = 15),\n         axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) + \n   labs(title = \"\", y = \"\", x = \"\", color = \"Topic\")\n\nhealth <- effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(1,2, 17, 24))\n  \nhealth_plot <- health |>\n  ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_y_continuous(limits = c(0,0.1)) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#5ab4ac\", \"#01665e\"), \n                     labels = c(\n                       \"1\",\n                       \"17\", \n                       \"2\", \n                       \"24\"\n                     )) +\n  labs(title = \"Theme: Health and Medicine\", y = \"\", x = \"\", color = \"Topic\")\n\ngovernance <- effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(4, 11, 18, 21, 25)) \n\ngovernance_plot <- governance |>\n  ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_y_continuous(limits = c(0,0.1)) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#5ab4ac\", \"#01665e\"), \n                     labels = c(\n                       \"11\",\n                       \"18\",\n                       \"21\",\n                       \"25\", \n                       \"4\"\n                     )) +\n  labs(title = \"Theme: Governance and Policies\", y = \"\", x = \"\", color = \"Topic\")\n\nnews <- effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(5, 8, 13, 15, 20, 26)) \n\nnews_plot <- news |>\n  ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_y_continuous(limits = c(0,0.1)) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#c7eae5\", \"#5ab4ac\", \"#01665e\"), \n                     labels = c(\n                       \"13\",\n                       \"15\",\n                       \"20\",\n                       \"26\", \n                       \"5\",\n                       \"8\"\n                     )) +\n  labs(title = \"Theme: News Discussions\", y = \"\", x = \"\", color = \"Topic\")\n\nsociety <- effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(3, 6, 22, 23, 28)) \n\nsociety_plot <- society |>\n  ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_y_continuous(limits = c(0,0.1)) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#5ab4ac\", \"#01665e\"), \n                     labels = c(\n                       \"22\",\n                       \"23\",\n                       \"28\", \n                       \"3\",\n                       \"6\"\n                     )) +\n  labs(title = \"Theme: Society and Societal Impact\", y = \"\", x = \"\", color = \"Topic\")\n\nstatistics <- effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(9, 12, 16, 19, 29))\n\nstatistics_plot <- statistics |>\n  ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_y_continuous(limits = c(0,0.1)) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#5ab4ac\", \"#01665e\"), \n                     labels = c(\n                       \"12\",\n                       \"16\",\n                       \"19\",\n                       \"29\",\n                       \"9\"\n                     )) +\n  labs(title = \"Theme: Statistics and Research\", y = \"\", x = \"\", color = \"Topic\")\n\nmisc <- effect_time |>\n  filter(moderator == \"misinfo\") |>\n  filter(topic %in% c(7, 10, 14, 27, 30)) \n\nmisc_plot <- misc |>\n  ggplot(aes(x = value, y = proportion, color = topic, group = topic, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_y_continuous(limits = c(0,0.1)) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#5ab4ac\", \"#01665e\"), \n                     labels = c(\n                       \"10\",\n                       \"14\",\n                       \"27\",\n                       \"30\",\n                       \"7\"\n                     )) +\n  labs(title = \"Theme: Miscellaneous\", y = \"\", x = \"\", color = \"Topic\")\n\nhealth_plot + governance_plot + news_plot + society_plot + statistics_plot + misc_plot +\n  plot_layout(ncol = 2, axes = \"collect\") & \n  theme(legend.position = \"top\", \n        legend.text = element_text(size = 10), legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 12))\n\n################################################################################\n# Compare prevalence between label within topics\n\neffect_time$moderator <- case_when(\n  effect_time$moderator == \"non.misinfo\" ~ \"non misinformation\",\n  effect_time$moderator == \"misinfo\" ~ \"misinformation\")  \n\nprev_4 <- effect_time |>\n  filter(topic==4) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.01,0.094)) +\n  scale_x_continuous(limits = c(18262,19312),\n                      breaks = seq(from = 18262, to = 19312, by = 60),\n                      labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"inside\", legend.position.inside = c(.5,.85),\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n    labs(title = \"\", \n         subtitle = \"4: American Politics\", \n         y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_6 <- effect_time |>\n  filter(topic==6) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.01,0.094)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"inside\", legend.position.inside = c(.5,.85),\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\",\n       subtitle = \"6: Economy and Finance\", \n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_13 <- effect_time |>\n  filter(topic==13) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.01,0.094)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"inside\", legend.position.inside = c(.5,.85),\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\",\n       subtitle = \"13: International News\", \n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_18 <- effect_time |>\n  filter(topic==18) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.01,0.094)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"inside\", legend.position.inside = c(.5,.85),\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\", \n       subtitle = \"18: International Politics\",\n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_4 + prev_6 + prev_13 + prev_18  +\n  plot_layout(ncol = 2, axes = \"collect\") &\n  theme(title = element_text(size = 12))\n\nggsave(\"Figure 2.tiff\", width = 2500, height = 2800, unit = \"px\", dpi = 300, limitsize = FALSE)\n\n################################################################################\nprev_1 <- effect_time |>\n  filter(topic==1) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.02,0.14), breaks = c(0.04,0.08,0.12)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"top\",  axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\", \n       subtitle = \"1: Characteristics of the Virus\", \n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_2 <- effect_time |>\n  filter(topic==2) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.02,0.14), breaks = c(0.04,0.08,0.12)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"none\",  axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\",\n       subtitle = \"2: Dangerous Vaccines and Side Effects\", \n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_12 <- effect_time |>\n  filter(topic==12) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.02,0.14), breaks = c(0.04,0.08,0.12)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"none\",  axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\",\n       subtitle = \"12: Mortality Rates and Vaccination Efforts\", \n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_17 <- effect_time |>\n  filter(topic==17) |>\n  mutate(moderator = as.factor(moderator)) |>\n  ggplot(aes(x = value, y = proportion, color = moderator, group = moderator, fill = moderator)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(0.012,0.14), breaks = c(0.04,0.08,0.12)) +\n  scale_x_continuous(limits = c(18262,19312),\n                     breaks = seq(from = 18262, to = 19312, by = 60),\n                     labels = labels_to_use_2) +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(legend.position = \"none\",  axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12)) +\n  labs(title = \"\", \n       subtitle = \"17: General Vaccine Discussions\",\n       y = \"Prevalence\", x = \"Month\", color = \"Label\")\n\nprev_1 + sent_1 + prev_2 + sent_2 + prev_12 + sent_12 + prev_17 + sent_17 +\n  plot_layout(ncol = 2, axes = \"collect\") &\n  theme(title = element_text(size = 10))\n\nggsave(\"Figure 3.tiff\", width = 2300, height = 3000, unit = \"px\", dpi = 300, limitsize = FALSE)\n################################################################################\n## Extract tweets related to the topics\ntwitter_topics <- twitter |>\n  semi_join(meta_twitter, by = \"id\")\n\ntheta <- make.dt(stm_30_interaction) \ntheta1 <- theta |>\n  arrange(desc(Topic6)) |>\n  select(docnum, Topic6) |>\n  slice(1:500)\n\ntweets_1 <- twitter_topics[as.numeric(theta1$docnum), , drop = FALSE]\nduplicates <- tweets_1 |>\n  group_by(id) |>\n  filter(n() > 1) |>\n  ungroup()\n# tweets_17 <- tweets_17[-72,]\ntweets_1 <- tweets_1 |>\n  anti_join(duplicates, by = \"id\")\n\ntweets_1_mis <- tweets_1 |>\n  filter(label == \"misinfo\")\n\ntweets_28_nonmis <- tweets_28 |>\n  filter(label == \"non.misinfo\")\n\ntweets_1_full <- orig_twitter |>\n  semi_join(tweets_1_mis, by = \"id\") |>\n  select(c(text, id))\n\ntweets_1_full <- tweets_1_full |>\n  merge(tweets_1, by = \"id\")\n\nwrite.csv2(tweets_1_full, \"C:/Users/sirifris/OneDrive - OsloMet/Dokumenter/PHD/Article 2/topic_1_mis.csv\")\n\n################################################################################\n## Assign topic-value to the original data\n\ntheta <- make.dt(stm_30_interaction)\ntheta_df <- as.data.frame(theta)\ntheta_df <- theta_df |>\n  select(-docnum)\n\ntheta_df$topic <- names(theta_df)[max.col(theta_df)]\ntheta_df$topic_value <- apply(theta_df[-31], 1, max)\n\ntheta_df <- theta_df |>\n  select(topic, topic_value)\n\ntwitter_topics <- twitter |>\n  semi_join(meta_twitter, by = \"id\")\n\ntwitter_topics <- twitter_topics |>\n  cbind(theta_df)\n\nsaveRDS(twitter_topics, \"D:/Data/Datasets/CADS_datasets/twitter_topics_30.RDS\")\n\n################################################################################\n## Clusters \n\nout_corr40 <- topicCorr(stm_30_interaction, cutoff = 0.04, set.seed(1234))\nout_corr40$cor[out_corr40$cor<0.04] <- 0\n\nnetwork <- graph_from_adjacency_matrix(out_corr40$cor, weighted = T, mode = \"undirected\", diag =\n                                          F, set.seed(1234))\n\nplot(network, vertex.color = \"light blue\", vertex.label.color = \"black\")\n\nout_corr40_2 <- topicCorr(stm_40_interaction, cutoff = 0.06, set.seed(1234))\ncluster <- eclust(scale(out_corr40_2$cor), \"hclust\", k = 8, nboot = 500)\n\nfviz_dend(cluster, rect = TRUE) # Dendrogram\n\nclust_col <- cluster$cluster\nclust_col <- to_factor(clust_col)\n\n#leg.txt <- c(\"Svensk/dansk\", \"Engelsk\", \"Midt\u00f8sten\", \"Politikk og lov\", \"Div\") # Labels\n\nnetwork_2 <- graph_from_adjacency_matrix(out_corr40_2$cor, weighted = TRUE, mode = \"undirected\", diag = FALSE, set.seed(1234))\nplot(network_2, vertex.color = clust_col, vertex.label.color = \"black\",) # Med farger etter dendrogrammet\n\nlegend(\"topleft\", leg.txt, fill = c(\"dark green\", \"blue\", \"orange\", \"light blue\", \"yellow\"))\n\n\n\ncorr <- as.data.frame(out_corr40$cor)\n\nggc <- ggcorr(out_corr40$cor, hjust = .85, size = 0, label = TRUE, method = c(\"pairwise\", \"pearson\"))\ndat <- data.frame(x=seq(corr), y=seq(corr),\n                  lbs = gsub(\"V\", \"\\n\", names(corr) ))\n\nggc +\n  geom_text(data = dat, aes(x, y, label = lbs), nudge_x = 0.1, nudge_y = 0.4)\n\n\n# file: topics_30.txt\nTopic 1: \n \t Marginal Highest Prob: viruset, mennesker, virus, lenger, problemet, kontroll, farlig, leve, sars, omikron, smitter, aller, frykt, cov, corona_viruset, raskt, lengre, tidligere, stoppe, delta \n \t Marginal FREX: cov, sars, varianten, omikron, virus, viruset, immunitet, naturlig, variant, smittsomt, wuhan, varianter, flokkimmunitet, kinesiske, bakterier, dyr, luft, kinesisk, mutasjoner, spredningen \n \t Marginal Lift: epochtimes, avlidna, bioingenioren, bioingenir, ytterligare, ild, massesmittehendelser, immunitetsgjeld, bat, smittekjeder, resmitte, gjenstander, variasjonen, armkroken, kobber, sjukdomsbyrden, <U+0001F060><U+200D><U+2642><U+FE0F>, motbevist, flurona, kommunistpartiet \n \t Marginal Score: viruset, virus, mennesker, lenger, problemet, kontroll, farlig, sars, leve, omikron, smitter, cov, corona_viruset, frykt, immunitet, delta, stoppe, raskt, aller, trolig \n \n \t Topic Kappa: cov, sars, biolog, mutert, mutasjon, mers, akademiet, viruser, mutasjoner, verten, mutere, load, endemiske, virolog, syntetisk, infisere, koronavirusene, rna, ebv, mottakelige \n \t Kappa with Baseline: viruset, virus, sars, cov, immunitet, omikron, mutasjoner, variant, mutert, varianter, ddelig, varianten, flokkimmunitet, wuhan, naturlig, immune, delta, smittsomt, mutasjon, farligere \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: viruset, virus, sars, cov, immunitet, omikron, ddelig, kina, mutasjoner, influensa, flokkimmunitet, varianter, variant, covid, farligere, tidligere, hiv, naturlig, immune, dyr \n \t \t Marginal FREX: cov, sars, mutasjoner, mutert, mutasjon, varianter, wuhan, virus, immune, hiv, variant, smittsomt, immunitet, viruset, varianten, rna, corona_virus, mutere, prof, mers \n \t \t Marginal Lift: vitenskaps, fysologi, storoffiser, reslegionen, nobelspris, montagnier, luc, cell, zika, disease, severe, biolog, ddlige, biovpen, ace2, theory, viral, arvestoff, syntetisk, finansierte \n \t \t Marginal Score: viruset, virus, sars, cov, immunitet, mutasjoner, ddelig, omikron, varianter, variant, flokkimmunitet, hiv, kina, farligere, immune, wuhan, naturlig, varianten, dyr, mutert \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: viruset, mennesker, virus, lenger, problemet, kontroll, farlig, leve, sars, omikron, smitter, aller, frykt, corona_viruset, raskt, lengre, tidligere, stoppe, delta, dermed \n \t \t Marginal FREX: corona_viruset, smitter, sars, sykdommen, varianten, cov, omikron, effektivt, dyr, smittsom, navn, trolig, potensielt, stoppe, variant, spredningen, smittsomt, viruset, naturlig, virus \n \t \t Marginal Lift: epochtimes, avlidna, bioingenioren, bioingenir, ytterligare, ild, massesmittehendelser, immunitetsgjeld, bat, smittekjeder, resmitte, gjenstander, variasjonen, armkroken, kobber, sjukdomsbyrden, <U+0001F060><U+200D><U+2642><U+FE0F>, motbevist, flurona, kommunistpartiet \n \t \t Marginal Score: viruset, mennesker, virus, lenger, problemet, kontroll, farlig, leve, sars, smitter, omikron, corona_viruset, frykt, aller, stoppe, raskt, trolig, lengre, sprer, delta \nTopic 2: \n \t Marginal Highest Prob: syke, alvorlig, sykdom, syk, vaksinert, covid, verre, hjelp, behandling, hjelper, utsatt, kampen, redd, sliter, grunnet, d, tillegg, frisk, friske, mistet \n \t Marginal FREX: arsenal, vitamin, gjennomgtt, kroppen, syk, citytimes, immunforsvar, hoste, frisk, troppen, plager, sjanse, vaksina, angst, tyrkianytt, spurs, slitt, feber, smak, forkjlelse \n \t Marginal Lift: konspitroll, lakh, alisson, afcon, brentford, fabinho, dijk, zxc, keita, aston, smaksans, tungpust, tungpustethet, noravl, muskelsmerter, allmenntilstand, leyton, xhaka, hjertemuskelen, brighton \n \t Marginal Score: syke, alvorlig, sykdom, syk, vaksinert, verre, behandling, hjelper, utsatt, kampen, sliter, redd, hjelp, frisk, friske, grunnet, d, studie, forkjlelse, mistet \n \n \t Topic Kappa: svulster, autoimmune, helvetesild, hjerteposebetennelse, antistoffene, immunsystemet, placebo, kreftformer, patolog, firstpost, utmattelsessyndrom, quercetin, gmo, kureres, preparat, medikament, cellene, igm, ivermektin, immun \n \t Kappa with Baseline: sykdom, vaksinert, covid, alvorlig, syk, kroppen, beskytter, immunforsvaret, gjennomgtt, immun, antistoffer, angst, immunforsvar, studie, sjanse, vaksina, online, vitamin, uvaksinert, hjelper \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: vaksinen, vaksine, covid, sykdom, alvorlig, vaksinert, syk, beskytter, pasienter, sykdommen, kroppen, beskyttelse, studie, antistoffer, immun, hjelper, beskyttet, fullvaksinerte, effektiv, immunforsvaret \n \t \t Marginal FREX: vaksinen, vaksinert, immunforsvaret, bivirkningene, beskyttet, immun, spike, beskyttelse, gen, gjennomgtt, immunsystemet, kroppen, angst, autoimmune, sykdom, astra, immunforsvar, citytimes, blodet, cannabis \n \t \t Marginal Lift: fragmenter, vaccinated, svulster, proteiner, blffen, autoimmune, gen, invalidiserende, spike, proteinet, helvetesild, c19ivermectin, cannabis, adenovirus, ufarlige, latent, inflammasjon, gmo, giftige, langtidseffekt \n \t \t Marginal Score: vaksinen, vaksine, sykdom, alvorlig, vaksinert, covid, syk, beskytter, beskyttelse, kroppen, sykdommen, pasienter, immun, beskyttet, antistoffer, immunforsvaret, gjennomgtt, studie, fullvaksinerte, effektiv \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: syke, alvorlig, sykdom, syk, vaksinert, covid, verre, hjelp, behandling, hjelper, utsatt, kampen, sliter, redd, grunnet, d, tillegg, frisk, friske, mistet \n \t \t Marginal FREX: alvorlig, uvaksinert, steigan, vitamin, syk, gjennomgtt, kroppen, immunforsvar, studie, hodepine, mild, beskytter, sjansen, langvarige, sykdomsforlp, symptomene, plager, hoste, arsenal, forkjlelse \n \t \t Marginal Lift: konspitroll, lakh, alisson, afcon, brentford, dijk, fabinho, zxc, keita, aston, smaksans, tungpust, tungpustethet, noravl, muskelsmerter, allmenntilstand, leyton, xhaka, brighton, bihulebetennelse \n \t \t Marginal Score: syke, alvorlig, sykdom, syk, vaksinert, verre, behandling, hjelper, utsatt, redd, hjelp, kampen, sliter, frisk, friske, grunnet, d, studie, forkjlelse, steigan \nTopic 3: \n \t Marginal Highest Prob: fhi, regjeringen, flge, situasjonen, koronaviruset, rd, informasjon, koronanorge, nettavisen, flger, finner, covid19norway, hei, regler, side, stortinget, anbefaler, forslag, pressekonferanse, kommunene \n \t Marginal FREX: anbefalinger, nyhetsvarsel, appen, folkehelseinstituttet, kommunene, smittestopp, covid19norway, hyhetsvarsel, app, rdene, regjeringen, rd, informasjon, informasjonen, hdir, anbefaling, omsorgsminister, anbefalingene, personvern, regjeringens \n \t Marginal Lift: hyhetsvarsel, hods, nyhetsvarsel, familieminister, bygningsloven, beredskapsdepartementet, integreringsminister, sosialminister, friskoleloven, frende, proposisjon, ingolf, barnehageloven, moderniseringsdepartementet, hringsnotat, hamarregionen, omsorgsminister, hringsfrist, omsorgsministeren, melanor \n \t Marginal Score: regjeringen, fhi, flge, situasjonen, rd, koronaviruset, informasjon, koronanorge, nettavisen, flger, finner, covid19norway, regler, hei, side, anbefaler, stortinget, kommunene, forslag, regjeringens \n \n \t Topic Kappa: kildekoden, datatilsynet, simula, lokasjonsdata, appen, helhetlige, personvernet, ios, fremgr, app, fhi, personvern, ihr, utviklerne, smitteapp, whos, lovteksten, notatet, ignorerte, aavitsland \n \t Kappa with Baseline: fhi, regjeringen, informasjon, rd, appen, app, flge, regler, fhis, anbefaler, smittestopp, anbefalinger, rapport, folkehelseinstituttet, koronanorge, flger, vurdering, lytte, personvern, helsemyndighetene \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: fhi, regjeringen, informasjon, flge, rd, appen, strategi, anbefaler, flger, app, covid, gitt, helsemyndighetene, regler, hndtering, tilgjengelig, regjering, rapport, stoler, ekspertene \n \t \t Marginal FREX: appen, fhi, app, smittestopp, gravide, personvern, fhis, beslutninger, stoler, ssb, anbefalinger, datatilsynet, ekspertene, hdir, koden, lansert, formlet, whos, hndtering, preben \n \t \t Marginal Lift: misbrukes, ihr, helliger, sharia, source, adlyde, reikers, kildekoden, datatilsynet, android, kriminell, hemmeligholde, ill, evidensen, sletter, formlet, fremgr, simula, api, helhetlige \n \t \t Marginal Score: fhi, regjeringen, informasjon, appen, rd, flge, strategi, app, anbefaler, flger, hndtering, stoler, regler, tilgjengelig, helsemyndighetene, gravide, ekspertene, rapport, regjering, smittestopp \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: fhi, regjeringen, flge, situasjonen, koronaviruset, rd, koronanorge, informasjon, nettavisen, finner, flger, covid19norway, hei, regler, side, stortinget, anbefaler, forslag, pressekonferanse, kommunene \n \t \t Marginal FREX: regjeringens, folkehelseinstituttet, covid19norway, regjeringen, kommunene, nyhetsvarsel, anbefalinger, appen, sprk, ntb, rdene, rd, smittestopp, anbefaler, epidemien, stortinget, myndighetenes, informasjon, hyhetsvarsel, kommunikasjon \n \t \t Marginal Lift: hyhetsvarsel, hods, nyhetsvarsel, familieminister, bygningsloven, beredskapsdepartementet, integreringsminister, sosialminister, friskoleloven, frende, proposisjon, ingolf, moderniseringsdepartementet, barnehageloven, hringsnotat, hamarregionen, omsorgsminister, hringsfrist, omsorgsministeren, melanor \n \t \t Marginal Score: regjeringen, fhi, flge, situasjonen, koronaviruset, rd, informasjon, koronanorge, nettavisen, finner, flger, covid19norway, regler, hei, side, stortinget, anbefaler, forslag, kommunene, regjeringens \nTopic 4: \n \t Marginal Highest Prob: usa, trump, ligger, info, flest, president, valget, hus, biden, stemme, vinner, worldometers, ddsfald, pleier, korrekt, nyttig, vinne, rasisme, presidenten, presse \n \t Marginal FREX: worldometers, ddsfald, trump, president, amerikanere, presidenten, valget, usa, registreret, hvite, trumps, vinner, donald_trump, japan, demokratene, stemme, biden, spain, info, arbeidsledigheten \n \t Marginal Lift: registreret, ddsfald, ddfald, netherlands, ireland, spain, chief, oc, deleggelsene, yle, vor, fagorganisering, kandidaten, reder, cherry, folkemter, 2valg, kuppforsk, dow, lekene \n \t Marginal Score: usa, trump, ligger, info, flest, president, valget, biden, hus, stemme, vinner, worldometers, ddsfald, presidenten, vinne, korrekt, nyttig, pleier, rasisme, presse \n \n \t Topic Kappa: republikanske, stater, gop, ulv, ukritiske, valgfusket, famler, sovjet, anonyme, qanon, demokratene, sanders, obama, stemt, bernie, naive, brazil, blinde, idiotene, poststemmer \n \t Kappa with Baseline: usa, trump, kilde, president, amerikanere, valget, info, biden, stater, stemme, presidenten, donald_trump, hvite, demokratene, trumps, svarte, korrekt, angrep, japan, tapte \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: usa, trump, totalt, president, amerikanske, biden, virkeligheten, info, cnn, feil, stemmer, stemme, kilde, valget, amerikanere, stater, vold, korrekt, angrep, flest \n \t \t Marginal FREX: stater, virkeligheten, amerikanere, vold, president, demokratene, trump, innrmme, donald_trump, innrmmet, oppfatter, svarte, usa, vs, ansvarlig, trumps, cnn, ulv, dumhet, presidenten \n \t \t Marginal Lift: survival, godtroende, kunnskapshat, villedet, dumhet, plapring, drone, usannheter, innrmmet, ukritiske, trakasserer, gop, republikanske, ulv, anonyme, famler, sovjet, naive, blinde, valgfusket \n \t \t Marginal Score: usa, trump, president, totalt, amerikanske, virkeligheten, biden, cnn, amerikanere, stemme, info, valget, kilde, stater, vold, angrep, ansvarlig, presidenten, demokratene, donald_trump \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: usa, trump, ligger, info, flest, valget, president, hus, biden, stemme, vinner, worldometers, ddsfald, pleier, vinne, rasisme, nyttig, korrekt, presse, presidenten \n \t \t Marginal FREX: trump, biden, worldometers, president, ddsfald, stemme, valget, usa, presidenten, amerikanere, presse, hvite, trumps, registreret, japan, nyttig, donald_trump, vinner, demokratene, angrep \n \t \t Marginal Lift: registreret, ddsfald, ddfald, netherlands, ireland, spain, chief, oc, deleggelsene, yle, vor, fagorganisering, kandidaten, reder, cherry, folkemter, 2valg, kuppforsk, dow, lekene \n \t \t Marginal Score: usa, trump, ligger, info, flest, valget, president, hus, biden, stemme, vinner, worldometers, ddsfald, pleier, vinne, nyttig, presse, rasisme, korrekt, presidenten \nTopic 5: \n \t Marginal Highest Prob: vg, pandemien, dagbladet, dax18, nrknyheter, nrkdebatt, covid19, coronavirus, lockdown, polkvart, slr, resett, nrkurix, hndtering, fortsetter, youtu, maske, utvikling, sttter, sjekk \n \t Marginal FREX: polkvart, nrkurix, nrkdebatt, nrknyheter, dax18, eiker, vreeikerkommune, oeiker, ovre, vreeiker, stopp, coronaviruset, importsmitte, vre, smittespredere, altblirbra, bekjempe, oppstart, tannlege, fns \n \t Marginal Lift: coromavirus, ovre, eiker, vreeikerkommune, bdonorge, polkvar, finalcall, finalcalltravel, travelsmarter, tannsmeden, altblirbra, alvik, unaids, guterres, tallsomteller, tietoevry, canariajournalen, trendsworld, antikroppar, canaria \n \t Marginal Score: vg, pandemien, dagbladet, dax18, nrknyheter, nrkdebatt, lockdown, polkvart, covid19, nrkurix, coronavirus, slr, resett, hndtering, youtu, maske, eiker, utvikling, coronaviruset, sjekk \n \n \t Topic Kappa: un, corruption, smitteimport, polvart, smittespredere, smittesprederpass, mangen, coverup, giga, kunnskapslse, resolusjon, warcrimes, whatshappeninginmyanmar, smitteimporten, sikkerhetsrd, international, nrknyheter, valg21, smittespreder, lgnen \n \t Kappa with Baseline: covid19, coronavirus, nrknyheter, dax18, nrkdebatt, nrkurix, polkvart, coronaviruset, bekjempe, corruption, un, smittespredere, stopp, fns, kinas, polvart, konspirasjoner, importsmitte, youtu \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: coronavirus, covid19, nrknyheter, dax18, nrkdebatt, bekjempe, eu, coronaviruset, nrkurix, fullvaksinert, corruption, polkvart, muterer, wef, un, unntak, landet, vaksine, covid, konspirasjoner \n \t \t Marginal FREX: corruption, nrknyheter, wef, coronavirus, nrkurix, un, polvart, polkvart, fullvaksinert, nrkdebatt, dax18, smittespredere, coronaviruset, bekjempe, koronapass, derre, smitteimport, konspirasjoner, smittesprederpass, kinas \n \t \t Marginal Lift: smittesprederpass, corruption, polvart, genteknologi, nwo, stoppimportsmitte, viruse, un, farligt, atombombe, mangen, smitteimport, ulvestad, thegreatreset, konspirasjoner, wef, muterer, vset, lgnen, kunnskapslse \n \t \t Marginal Score: coronavirus, covid19, nrknyheter, dax18, nrkdebatt, bekjempe, corruption, nrkurix, coronaviruset, eu, fullvaksinert, polkvart, muterer, wef, un, polvart, konspirasjoner, unntak, stoppes, smittespredere \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: vg, pandemien, dagbladet, dax18, nrkdebatt, nrknyheter, lockdown, covid19, slr, resett, polkvart, hndtering, nrkurix, coronavirus, fortsetter, youtu, maske, utvikling, sttter, sjekk \n \t \t Marginal FREX: nrkdebatt, nrknyheter, nrkurix, polkvart, dax18, eiker, oeiker, fn, vreeiker, vreeikerkommune, ovre, vre, tidsskriftet, <U+30FC>, felles, hjemmeside, coronaviruset, stopp, jenter, oppstart \n \t \t Marginal Lift: coromavirus, ovre, eiker, vreeikerkommune, polkvar, bdonorge, finalcall, finalcalltravel, travelsmarter, tannsmeden, altblirbra, alvik, unaids, guterres, tallsomteller, tietoevry, canariajournalen, trendsworld, antikroppar, canaria \n \t \t Marginal Score: vg, pandemien, dagbladet, dax18, nrkdebatt, nrknyheter, lockdown, polkvart, slr, resett, nrkurix, hndtering, covid19, youtu, maske, utvikling, sttter, eiker, sjekk, felles \nTopic 6: \n \t Marginal Highest Prob: gi, store, penger, krisen, krise, sttte, beredskap, staten, ekstra, kt, konomisk, krig, fremover, konomi, betale, millioner, krever, trenger, milliarder, kroner \n \t Marginal FREX: bedrifter, skatt, ln, arbeidsplasser, betaler, mdg, inntekter, kriser, utgifter, forbruk, penger, frp, nav, dagpenger, grnne, staten, ap, beredskap, kroner, budsjett \n \t Marginal Lift: greenpeace, kraftkrevende, nyregjering2021, pengemengden, bedriftenes, grunnrente, pengemengde, trrr, batteribiler, balansekraft, vannverdimodellene, vannkraftproduksjon, enova, utbyttene, energieffektivisering, ppa, avdrag, gasspris, utbyggere, totalforsvar \n \t Marginal Score: gi, store, penger, krisen, krise, sttte, beredskap, staten, konomisk, krig, betale, konomi, kroner, bedrifter, milliarder, kt, nav, e24, ap, klima \n \n \t Topic Kappa: kapitalister, usosiale, milliardrer, individets, borgerne, kapitalismen, inngrep, grdige, aksjonrer, misbruk, borgernes, deleggelse, skattepengene, lnnsmottakere, adelen, kommunister, sosialister, trylletale, ulnnsomt, kologiske \n \t Kappa with Baseline: penger, staten, gi, store, makt, politikerne, inngrep, samfunn, tjene, rettigheter, skape, krig, tjener, sttte, parti, konomisk, skapt, frp, grnne, pengene \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: gi, politikere, store, penger, staten, handler, makt, kontroll, folket, samfunn, skape, krig, sttte, frihet, politikk, inngrep, skapt, politikerne, globale, rettigheter \n \t \t Marginal FREX: inngrep, staten, politikere, tjene, demokratisk, demokrati, rettigheter, demokratiet, parti, velgere, politikerne, grunnleggende, kontrollere, borgerne, kapitalismen, tjener, totalitrt, partier, definere, penger \n \t \t Marginal Lift: neo, liberalistene, fjols, totalitrt, grotesk, blffer, skatteparadis, straffedom, beslutningsgrunnlag, borgernes, milliardrene, urimelighet, pedokrati, adel, legemiddelbransjen, regissert, borgerne, motarbeidet, deleggelse, frimureri \n \t \t Marginal Score: politikere, gi, penger, staten, store, makt, handler, kontroll, samfunn, inngrep, folket, skape, krig, politikerne, frihet, skapt, rettigheter, politikk, globale, tjene \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: gi, store, penger, krisen, krise, sttte, beredskap, ekstra, staten, kt, konomisk, krig, fremover, konomi, millioner, betale, krever, trenger, milliarder, kroner \n \t \t Marginal FREX: kroner, bedrifter, konomiske, strm, mdg, betaler, kriser, krisen, penger, arbeidsplasser, olje, nav, skatt, inntekter, ln, grnn, gass, krig, selskaper, frp \n \t \t Marginal Lift: greenpeace, kraftkrevende, nyregjering2021, pengemengden, bedriftenes, grunnrente, pengemengde, trrr, batteribiler, balansekraft, vannkraftproduksjon, vannverdimodellene, enova, utbyttene, energieffektivisering, avdrag, ppa, gasspris, utbyggere, totalforsvar \n \t \t Marginal Score: gi, store, penger, krisen, krise, sttte, beredskap, staten, konomisk, krig, betale, konomi, kroner, milliarder, bedrifter, krever, kt, nav, e24, klima \nTopic 7: \n \t Marginal Highest Prob: veldig, godt, bra, takk, faktisk, synes, gode, trenger, enig, skjnner, sprsml, gjerne, tenker, svar, fint, klarer, ellers, nettopp, rart, viktig \n \t Marginal FREX: sprsml, takk, hyggelig, svare, svarer, tweeten, svart, spr, beklager, tanker, stiller, <U+263A><U+FE0F>, kult, kjre, fornyd, diskusjon, sprre, folka, ekte, utrolig \n \t Marginal Lift: omtanken, lekkert, tvi, pminnelsen, bioen, bunad, humoren, dotter, tweetsa, fakkelmannen, kvik, strikker, hihi, hflige, konstruktiv, fargerike, kompliment, gif, bestevenn, chatten \n \t Marginal Score: veldig, godt, bra, takk, synes, faktisk, gode, sprsml, enig, skjnner, gjerne, svar, trenger, fint, nettopp, utrolig, ellers, ok, klarer, hre \n \n \t Topic Kappa: humoristisk, metaforer, latterliggjre, fremheve, hellige, kommentarer, vene, morset, kverulerer, intensjoner, kathrine, argumentasjon, etterlatte, antagelser, tulla, innta, folka, gjentas, febrilsk, trans \n \t Kappa with Baseline: synes, sprsml, tenker, svar, debatten, takk, spr, prver, skrev, ham, svare, vite, ekte, stiller, forsk, trd, folka, skjnner, utrolig, svart \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: sprsml, synes, mennesker, tenker, lov, kalle, etc, vite, svar, slags, sprsmlet, skjnner, prver, spr, takk, stille, forst, skrev, gode, virkelig \n \t \t Marginal FREX: kalle, argumenter, kritiske, sprsml, meninger, diskutere, villig, fornektere, lenke, folka, forsker, ekte, enkle, synes, kommentarer, sprsmlet, menneskers, religion, stille, svart \n \t \t Marginal Lift: nazist, umoralske, meningsmotstandere, fornektere, hellige, legitime, brilliant, islamister, realiteter, paranoid, indusert, opsjoner, uprvd, rster, metaforer, pedofile, humoristisk, def, kildekritisk, kalle \n \t \t Marginal Score: sprsml, synes, kalle, tenker, lov, etc, svar, sprsmlet, slags, vite, mennesker, spr, prver, stille, skrev, kritiske, skjnner, diskutere, ekte, forsk \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: veldig, godt, bra, takk, faktisk, synes, gode, trenger, enig, skjnner, gjerne, sprsml, fint, tenker, svar, klarer, nettopp, ellers, rart, viktig \n \t \t Marginal FREX: takk, utrolig, svare, hyggelig, tweeten, tanker, sprsml, svarer, hre, spurte, sjekke, svart, beklager, kult, <U+263A><U+FE0F>, spr, liker, fornyd, orker, flott \n \t \t Marginal Lift: omtanken, lekkert, tvi, pminnelsen, bioen, bunad, humoren, dotter, tweetsa, fakkelmannen, kvik, strikker, hihi, hflige, konstruktiv, fargerike, kompliment, gif, bestevenn, chatten \n \t \t Marginal Score: veldig, godt, bra, takk, faktisk, synes, gode, enig, skjnner, sprsml, gjerne, trenger, fint, svar, nettopp, ellers, klarer, utrolig, hre, ok \nTopic 8: \n \t Marginal Highest Prob: korona, nrk, politiet, tilfelle, melder, frykter, nakstad, mann, trndelag, farlig, overraskende, smitta, kultur, bod, politi, st, kvinne, skriver, hurtigruten, korona_virus \n \t Marginal FREX: espen, trndelag, hurtigruten, nrkdistriktsisteosloogvikenrss, medier24, tran, nrkdistriktsistenordlandrss, nrkdistriktsistetrondelagrss, torp, roald, m24, cruiseskip, nrkdistriktsistesorlandetrss, nrkdistriktsistehordalandrss, helgelandssykehuset, bord, mannskapet, nakstad, lofoten, fredrikstadavisa \n \t Marginal Lift: akkuratn, bobilverden, radiorubben, radioruben, rubben, fotpatrulje, meslingepidemi, alenesammen, lokalradio, mjlkekvotar, koronasamfunnet, melkekvoter, nrkdistriktsistetrondelagrss, utenriksnyheter, frokostradio, skipslegen, blv, kork, satiriks, roald \n \t Marginal Score: korona, nrk, politiet, melder, tilfelle, frykter, nakstad, trndelag, mann, farlig, politi, bod, st, hurtigruten, kvinne, kultur, overraskende, smitta, tran, korona_virus \n \n \t Topic Kappa: konspirasjonene, overvurdert, kjledyr, utenriksnyheter, urix, profitrer, dokumentarer, erklrte, skremselspropaganda, helsedirektr, mllers, tpelig, vaksineskeptikere, vollvik, profitrene, opptrer, oppslaget, bibelen, assisterende, olsvik \n \t Kappa with Baseline: korona, frykter, nakstad, politi, urix, helsedirektr, skremselspropaganda, reaksjoner, dokumentarer, opptrer, tran, leter, utenriksnyheter, espen_nakstad, kjledyr, koronavaksinen, tpelig, assisterende, erklrte \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: farlig, korona, skriver, koronavirus, koronaviruset, direkte, lege, advarer, frykter, bekymret, korona_viruset, nakstad, forsker, funn, slutte, tilfeldig, covid, blge, ny, korona_vaksinen \n \t \t Marginal FREX: farlig, gener, advarer, sauer, vaksinemotstand, florerer, korona_vaksinen, skremmer, tilfeldig, skremsel, frykter, makta, titusenvis, vaksineskeptikere, dummeste, virusvariant, bekymret, eksistens, politi, blge \n \t \t Marginal Lift: konspiratorikere, gener, vaksineskeptikere, evil, harmlst, koronafornekter, konspirasjonene, skraphaug, sauer, vaksinens, skremsel, tese, eksistens, virusvariant, smittebegrensende, grobunn, underforsttt, hyreekstremisme, pillen, farlig \n \t \t Marginal Score: farlig, skriver, korona, koronavirus, koronaviruset, advarer, lege, frykter, direkte, bekymret, korona_viruset, nakstad, tilfeldig, funn, forsker, blge, slutte, korona_vaksinen, gener, sauer \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: korona, nrk, politiet, tilfelle, melder, frykter, nakstad, mann, trndelag, overraskende, smitta, kultur, bod, st, politi, kvinne, hurtigruten, korona_virus, tran, ulovlig \n \t \t Marginal FREX: espen, medier24, tran, nrkdistriktsisteosloogvikenrss, hurtigruten, trndelag, olavs, russen, bord, amundsen, politiet, nrkdistriktsistenordlandrss, st, nrkdistriktsistetrondelagrss, hospital, nakstad, nrkdistriktsistesorlandetrss, roald, torp, korona_virus \n \t \t Marginal Lift: akkuratn, bobilverden, radiorubben, radioruben, rubben, fotpatrulje, meslingepidemi, lokalradio, alenesammen, mjlkekvotar, koronasamfunnet, melkekvoter, nrkdistriktsistetrondelagrss, frokostradio, skipslegen, blv, kork, satiriks, roald, arbeidsminister \n \t \t Marginal Score: korona, nrk, politiet, melder, tilfelle, frykter, nakstad, trndelag, mann, st, bod, politi, hurtigruten, kvinne, smitta, kultur, overraskende, korona_virus, tran, ulovlig \nTopic 9: \n \t Marginal Highest Prob: siste, totalt, pasienter, sykehus, innlagt, dgn, ret, rene, registrert, smittetilfeller, lpet, bekreftet, respirator, ddsfall, uken, sykehuset, dagene, desember, ukene, kristiansand \n \t Marginal FREX: siste, rene, dagene, ukene, dgnet, bekreftet, tilkoblet, 14d, 7d, ret, lpet, intensivavdelinger, klokken, uken, mnedene, nkkeltall, ra, dgn, havner, hvorav \n \t Marginal Lift: 7d, 14d, tilkoblet, sorost, nyg, utvei, intensivavdelinger, gnag, vredens, koronainnlagte, mnedene, interaktiv, rene, influensapasienter, sengepost, klokken, kalnes, folkeopprret, rehabiliteringstilbud, akuttmottak \n \t Marginal Score: siste, totalt, sykehus, pasienter, innlagt, dgn, ret, rene, registrert, lpet, bekreftet, smittetilfeller, respirator, uken, dagene, sykehuset, ddsfall, desember, ukene, kristiansand \n \n \t Topic Kappa: utvei, uavklarte, setningen, tjue, rest, verset, flg, rene, omme, mnedene, leppa, tirene, slenger, ret, havner, utgjort, ret, ra, overbelastede, mneden \n \t Kappa with Baseline: siste, sykehus, rene, ret, flg, lpet, bekreftet, mnedene, dagene, havner, ukene, uken, lagt, dgnet, ra, respirator, l, mneden, setningen \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: siste, ganger, gtt, ret, rene, lagt, sykehus, par, viktigste, mnd, lpet, uttrykk, bekreftet, oppfatning, fdt, propagandaen, indikerer, mnedene, energi, havner \n \t \t Marginal FREX: ganger, viktigste, propagandaen, uttrykk, indikerer, oppfatning, gtt, fdt, setning, rene, fossil, krypto, mnedene, par, energi, blgen, oppriktig, misforstr, ret, siste \n \t \t Marginal Lift: crypto, menneskehetens, krypto, utvei, propagandaen, nazismen, asiatere, jp, norman, uttrykk, scam, klassifisere, 18mnd, riksrett, setning, oppfatning, indikerer, fossil, setningen, uavklarte \n \t \t Marginal Score: siste, ganger, gtt, rene, ret, lagt, viktigste, par, sykehus, uttrykk, mnd, lpet, oppfatning, propagandaen, fdt, bekreftet, indikerer, mnedene, energi, havner \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: siste, totalt, pasienter, sykehus, innlagt, dgn, ret, registrert, rene, smittetilfeller, lpet, bekreftet, respirator, ddsfall, sykehuset, uken, desember, dagene, ukene, kristiansand \n \t \t Marginal FREX: siste, bekreftet, rene, dgnet, dagene, ukene, ret, lpet, 14d, 7d, tilkoblet, uken, hvorav, totalt, nkkeltall, mnedene, intensivavdelinger, dgn, ra, havner \n \t \t Marginal Lift: 7d, 14d, tilkoblet, sorost, nyg, intensivavdelinger, gnag, vredens, koronainnlagte, interaktiv, influensapasienter, sengepost, klokken, kalnes, folkeopprret, rehabiliteringstilbud, akuttmottak, nkkeltall, lovisenberg, avlaster \n \t \t Marginal Score: siste, totalt, pasienter, sykehus, innlagt, dgn, ret, rene, registrert, lpet, smittetilfeller, bekreftet, respirator, uken, dagene, sykehuset, ddsfall, desember, ukene, kristiansand \nTopic 10: \n \t Marginal Highest Prob: tiltak, tiltakene, liv, lei, bt, fram, restriksjoner, fr, visst, reglene, debatt, strenge, dugnad, veit, dagsavisen, smitta, ille, berre, meir, tida \n \t Marginal FREX: berre, meir, kjem, sj, vera, meiner, charter, framleis, kor, heime, treng, saman, veke, held, svein, vanleg, strenge, veka, truleg, synest \n \t Marginal Lift: butikkar, attende, anten, alvorlege, inngripande, tippar, brot, aukar, allereie, amerikanarar, raude, byrja, byrjar, smittevernlova, ln, ikj, ddstala, naudsynt, innspel, lge \n \t Marginal Score: tiltak, tiltakene, liv, lei, bt, restriksjoner, fr, fram, visst, reglene, strenge, dugnad, debatt, berre, dagsavisen, veit, ille, meir, smitta, kor \n \n \t Topic Kappa: drakoniske, diverre, fnb, forholdsmessigheten, rettferdiggjre, inngripende, born, vald, utilsiktede, lovbrudd, dess, framstr, bananrepublikken, homofile, hndheve, splittende, forskarar, innsett, liv, iverksettes \n \t Kappa with Baseline: tiltak, liv, tiltakene, restriksjoner, inngripende, strenge, innfrt, fortsette, fritt, ille, fr, meir, normalt, debatt, desse, restriksjonene, virket, dugnad \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: tiltak, liv, befolkningen, myndighetene, tiltakene, leve, redde, samfunnet, tenke, konsekvenser, restriksjoner, lockdown, faren, covid, inngripende, setter, strenge, normalt, innfrt, konsekvensene \n \t \t Marginal FREX: konsekvenser, inngripende, skadelige, drepe, frykten, uskyldige, tenke, leve, ulovlig, friheten, aksepterer, liv, innfres, redde, befolkningen, fjerne, innfrt, tiltakene, normalt, strenge \n \t \t Marginal Lift: makteliten, skadelige, ddsstraff, uskyldige, strmenn, irrasjonelle, bekjempes, rettferdiggjre, diktator, legitimere, tpelige, plague, diktatoriske, fnb, drakoniske, totalitre, spesifisere, forutinntatt, kvasi, forholdsmessigheten \n \t \t Marginal Score: tiltak, liv, befolkningen, tiltakene, myndighetene, leve, redde, konsekvenser, tenke, samfunnet, restriksjoner, inngripende, innfrt, faren, normalt, strenge, lockdown, frykten, konsekvensene, slippe \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: tiltak, tiltakene, liv, lei, bt, fram, restriksjoner, fr, visst, reglene, debatt, strenge, dugnad, veit, dagsavisen, smitta, ille, berre, meir, tida \n \t \t Marginal FREX: berre, meir, kjem, sjlv, kor, sj, fr, vera, sjuke, meiner, framleis, utan, charter, svein, betre, heime, strenge, vert, anna, halde \n \t \t Marginal Lift: butikkar, attende, anten, alvorlege, inngripande, tippar, brot, aukar, allereie, amerikanarar, raude, byrja, byrjar, smittevernlova, ln, ikj, ddstala, naudsynt, innspel, lge \n \t \t Marginal Score: tiltak, tiltakene, liv, lei, bt, fram, fr, restriksjoner, visst, reglene, strenge, debatt, dugnad, veit, berre, dagsavisen, ille, meir, smitta, tida \nTopic 11: \n \t Marginal Highest Prob: coronavirus, italia, tv2, forst, respekt, redde, danmark, alvor, tvil, dk, vurderer, dele, grunner, dr, banen, lse, retningslinjer, skjnt, nemlig, planer \n \t Marginal FREX: dk, dr, tv2, danske, conte, lombardia, posten, rde, dansk, kritikken, nettet, uefa, samfunnskritisk, fauci, barer, retningslinjer, avisen, dele, uheldig, bre \n \t Marginal Lift: campania, zaia, fontana, veneto, nyheder, dpcm, jyllands, liguria, emilia, luca, frederiksen, toscana, respektfulle, politiken, infeksjonene, majeure, lazio, regionene, iss, genova \n \t Marginal Score: coronavirus, italia, tv2, respekt, forst, redde, danmark, alvor, dk, tvil, dele, vurderer, dr, grunner, banen, lse, retningslinjer, nemlig, planer, rde \n \n \t Topic Kappa: gain, function, reiner, committee, skremme, fauci, check, dr, mengele, skremt, atferd, berettiget, mink, grunnlaget, katastrofen, information, ritzau, galskap, fremstiller, avisen \n \t Kappa with Baseline: dr, tv2, skremme, fauci, galskap, nemlig, skremt, vurdert, grunnlaget, oppmerksomhet, respekt, dele, danmark, nettet, retningslinjer, pl, avisen, rde, dk, kritikken \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: leger, eksperter, dr, tv2, skremme, helsemyndigheter, legen, galskap, medisinske, fauci, hevde, smart, nemlig, vurdert, skremt, grunnlaget, jorden, respekt, avhengig, peter \n \t \t Marginal FREX: leger, helsemyndigheter, dr, eksperter, peter, fauci, skremme, hevde, jorden, onde, medisinske, mccullough, skremt, function, gain, nazistene, ufattelig, galskap, grunnlaget, avisen \n \t \t Marginal Lift: function, gain, innbille, mccullough, bieffektene, anthony_fauci, nazistene, sivilisert, eksperimenter, lord, reiner, panic, committee, uetiske, avlives, koding, peter, betrakter, anthony, fuellmich \n \t \t Marginal Score: leger, eksperter, dr, skremme, helsemyndigheter, tv2, medisinske, fauci, galskap, legen, hevde, smart, nemlig, peter, skremt, jorden, grunnlaget, vurdert, onde, avhengig \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: coronavirus, italia, tv2, forst, respekt, redde, danmark, alvor, tvil, dk, vurderer, dele, grunner, banen, lse, dr, skjnt, retningslinjer, planer, nemlig \n \t \t Marginal FREX: dk, tv2, oppfrsel, danske, italia, dr, lombardia, rde, respekt, posten, conte, bank, dansk, retningslinjer, nff, kritikken, cirka, nettet, dele, regionen \n \t \t Marginal Lift: campania, zaia, fontana, veneto, nyheder, dpcm, jyllands, liguria, emilia, luca, frederiksen, toscana, respektfulle, politiken, infeksjonene, majeure, lazio, regionene, iss, genova \n \t \t Marginal Score: coronavirus, italia, tv2, forst, respekt, redde, danmark, alvor, dk, tvil, vurderer, dele, grunner, banen, dr, lse, retningslinjer, planer, nemlig, skjnt \nTopic 12: \n \t Marginal Highest Prob: dde, covid, influensa, langt, dr, ddsfall, ganger, tall, risiko, hyere, eldre, vaksinerte, uvaksinerte, tallene, per, prosent, sykdommer, dd, frre, nesten \n \t Marginal FREX: underliggende, andel, tallene, uvaksinerte, alder, vaksinerte, prosent, ddeligheten, dr, snitt, overddelighet, alvorlige, risikoen, statistikken, innleggelse, ddstallene, yngre, hyere, sykdommer, diabetes \n \t Marginal Lift: vaksinasjonsprog, insidensen, innleggelsesrate, 6x, overddligheten, snittalderen, begravelsesbyrene, influensaddsfall, underddelighet, rsv, intensivinnleggelser, halvkule, innb, iva, innleggelsestallene, differansen, bulletin, behandlingskapasitet, normalr, intensivavd \n \t Marginal Score: dde, influensa, dr, langt, ddsfall, tall, ganger, covid, risiko, hyere, vaksinerte, eldre, uvaksinerte, tallene, per, prosent, sykdommer, frre, risikoen, ddd \n \n \t Topic Kappa: myocarditt, alv, ddsrsak, fatality, narkolepsi, ddsattesten, biv, myokarditt, qaly, dd, excess, assosiert, kawasaki, medianalderen, baseline, komorbiditeter, svangerskapet, ifr, karsykdommer, angir \n \t Kappa with Baseline: dr, dd, ddsfall, risiko, covid, vaksinerte, uvaksinerte, d, alvorlige, risikoen, kt, tallene, sykdommer, eldre, hyere, ddd, underliggende, prosent, lav, svrt \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: covid, dr, risiko, dd, vaksinerte, ddsfall, uvaksinerte, d, alvorlige, bivirkninger, risikoen, strre, svrt, sykdommer, eldre, tallene, liten, ddd, mennesker, langt \n \t \t Marginal FREX: dd, alvorlige, risiko, risikoen, ddsrsak, forlp, uvaksinerte, kreft, vaksinerte, underliggende, risk, myokarditt, nih, dr, alv, ddsfall, ifr, biv, ncbi, nlm \n \t \t Marginal Lift: biv, preparatet, alv, massevax, risikoreduksjon, multi, mortem, overlevelses, injiserte, neglisjerbar, myocarditt, bivirkn, narkolepsi, hepatitt, inf, morbiditet, overhyppighet, ufdte, medik, endepunkt \n \t \t Marginal Score: dr, risiko, dd, vaksinerte, uvaksinerte, ddsfall, covid, d, alvorlige, risikoen, bivirkninger, sykdommer, strre, eldre, tallene, svrt, ddd, liten, kreft, kt \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: dde, covid, influensa, langt, dr, ddsfall, ganger, tall, risiko, hyere, eldre, vaksinerte, tallene, uvaksinerte, per, prosent, sykdommer, frre, nesten, ddd \n \t \t Marginal FREX: tall, influensa, eldre, sykdommer, tallene, underliggende, uvaksinerte, andel, ddeligheten, vaksinerte, prosent, alder, statistikken, dde, dr, snitt, ddstallene, overddelighet, innleggelse, utgjr \n \t \t Marginal Lift: vaksinasjonsprog, insidensen, innleggelsesrate, 6x, overddligheten, snittalderen, begravelsesbyrene, influensaddsfall, underddelighet, rsv, intensivinnleggelser, halvkule, innb, iva, innleggelsestallene, differansen, bulletin, behandlingskapasitet, normalr, intensivavd \n \t \t Marginal Score: dde, influensa, dr, langt, tall, ddsfall, ganger, covid, risiko, hyere, eldre, vaksinerte, tallene, uvaksinerte, per, prosent, sykdommer, frre, ddd, tallet \nTopic 13: \n \t Marginal Highest Prob: com, norske, tro, skriver, lese, interessant, media, saken, stemmer, sak, artikkelen, spennende, skrevet, leger, lre, lest, forskere, myndigheter, legger, verdt \n \t Marginal FREX: theguardian, youtube, nytimes, artikkel, new, artikler, innlegg, world, york, skrevet, washingtonpost, video, aviser, com, amerikansk, engelsk, us, medier, nature, gjennomgang \n \t Marginal Lift: connectedcompanies, brekraftighet, invst, fivethirtyeight, theblaze, bibliotekettarsaka, byline, nationalgeographic, skysports, tvvest, odinfond, geriatriks, abonnere, view, velskrevet, lrerike, simuleringer, idunn, ottawa, pelosi \n \t Marginal Score: com, norske, tro, skriver, lese, interessant, media, saken, artikkelen, sak, skrevet, stemmer, lest, spennende, lre, leger, forskere, facebook, artikkel, myndigheter \n \n \t Topic Kappa: study, least, welt, telenorsoc, four, yale, scientific, order, medicine, year, pandemic, ondsinnet, sensurere, medical, thegatewaypundit, sensurerer, windows, avslrt, fox, guvernr \n \t Kappa with Baseline: com, youtube, news, new, pandemic, sannheten, artikkel, facebook, media, world, theguardian, nytimes, skrevet, lese, artikler, google, nature, york, medier, artikkelen \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: com, media, sannheten, youtube, lese, twitter, news, covid, new, artikkel, pandemic, lgn, propaganda, hevder, google, skrevet, bill_gates, artikkelen, nature, facebook \n \t \t Marginal FREX: pandemic, world, youtube, avslrt, nature, new, sannheten, vaccine, artikler, york, bitchute, fox, people, us, nytimes, artikkel, say, lgnene, one, feilinformasjon \n \t \t Marginal Lift: four, director, number, drug, least, many, blodfan, scientific, reports, telenorsoc, died, says, illuminati, pseudovitenskap, study, said, people, another, ayn, kill \n \t \t Marginal Score: com, sannheten, media, youtube, news, new, pandemic, twitter, artikkel, lese, bill_gates, google, hevder, nature, lgn, world, propaganda, skrevet, vaccine, nytimes \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: com, norske, tro, skriver, lese, interessant, media, saken, stemmer, sak, artikkelen, spennende, leger, lest, lre, skrevet, forskere, myndigheter, legger, verdt \n \t \t Marginal FREX: artikkelen, theguardian, google, youtube, nytimes, myndigheter, artikkel, new, amerikanske, artikler, stole, temaet, york, world, wordpress, washingtonpost, video, aviser, media, engelsk \n \t \t Marginal Lift: connectedcompanies, brekraftighet, invst, fivethirtyeight, theblaze, bibliotekettarsaka, byline, nationalgeographic, skysports, tvvest, odinfond, abonnere, geriatriks, view, velskrevet, lrerike, simuleringer, idunn, ottawa, pelosi \n \t \t Marginal Score: com, norske, tro, skriver, lese, interessant, media, saken, artikkelen, stemmer, sak, lest, spennende, skrevet, lre, myndigheter, forskere, leger, kritisk, facebook \nTopic 14: \n \t Marginal Highest Prob: god, hper, bedre, drlig, snart, greit, nsker, virkelig, lett, riktig, vei, fort, morgen, begynner, fler, sammen, heldigvis, masse, tur, fin \n \t Marginal FREX: bedring, krysser, fingrene, deilig, kos, klem, middag, spise, sunn, fisk, fornuft, sofaen, koselig, feire, <U+2600><U+FE0F>, kaffe, helg, slitsomt, bursdag, stemning \n \t Marginal Lift: mornings, nikkei, dyna, betring, bedringens, tiner, godmorgen, sludd, frs, bikkja, gtur, knert, dyne, stekt, julemat, tomat, makrell, curry, kjeks, brste \n \t Marginal Score: god, hper, drlig, bedre, snart, greit, nsker, lett, riktig, virkelig, fort, morgen, vei, fler, begynner, tur, heldigvis, bedring, fin, masse \n \n \t Topic Kappa: fornuft, utrydder, sunn, pine, satan, urett, spy, fantasi, gretten, blaff, sitert, salig, bihulene, hytt, nde, frekk, tullinger, uvitenhet, flokken, spruter \n \t Kappa with Baseline: lett, riktig, drlig, fornuft, god, fort, sunn, hper, sikkert, vei, dog, nske, hodet, typisk, ide, glemme, sitter, fryktelig, tanken \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: samtidig, riktig, lett, lar, problemet, viktig, god, enkelte, mten, drlig, forstr, hre, velger, sikkert, liker, menneske, fort, hper, eksisterer, dumt \n \t \t Marginal FREX: sannhet, fornuft, hoax, oppegende, sunn, menneske, faktum, medikamenter, anbefale, oppfrer, husker, biter, empati, liker, sorry, samtidig, glemme, velger, srdeles, sans \n \t \t Marginal Lift: utrydder, falskhet, common, pengemakt, stupid, antivirale, orwell, hoax, pill, bond, legalisering, kvakksalveri, heroin, potent, sannhet, massesuggesjon, frimurermafiaen, sitert, konspirerer, cut \n \t \t Marginal Score: samtidig, riktig, lett, lar, problemet, enkelte, mten, menneske, hre, velger, liker, fornuft, sannhet, drlig, viktig, eksisterer, fort, dumt, god, husker \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: god, hper, bedre, snart, drlig, greit, nsker, virkelig, lett, riktig, morgen, vei, begynner, fler, fort, sammen, heldigvis, tur, masse, fin \n \t \t Marginal FREX: bedring, spise, krysser, deilig, fingrene, kaffe, feire, kos, middag, huff, spiser, puste, mildt, hodet, ironi, smaker, klem, fisk, stemning, grader \n \t \t Marginal Lift: mornings, nikkei, dyna, betring, bedringens, tiner, godmorgen, sludd, frs, bikkja, gtur, knert, dyne, stekt, julemat, tomat, makrell, curry, kjeks, brste \n \t \t Marginal Score: god, hper, drlig, snart, bedre, greit, nsker, virkelig, lett, riktig, morgen, fort, fler, vei, begynner, tur, heldigvis, masse, fin, bedring \nTopic 15: \n \t Marginal Highest Prob: ny, aftenposten, livet, snakker, tv, tenk, endelig, snakke, lage, leder, hrer, skjer, skrive, rets, skjedde, gleder, forteller, snakket, lrt, lyst \n \t Marginal FREX: episode, minutt, spotify, hr, podcast, tv, open, glede, erik, serie, podcasts, konsert, episoden, knut, petter, eurosport, dritt, aftenposten, sjef, konserter \n \t Marginal Lift: pcast, oddspodden, almlid, <U+2B50><U+FE0F>, haugesunds, melodi, prix, camus, h, beijing2022, artistene, knutsen, lode, weng, alexandra, felix, pmeldt, lrdagskvelden, moberg, glansen \n \t Marginal Score: aftenposten, ny, livet, snakker, tv, tenk, endelig, snakke, lage, leder, skrive, rets, hrer, gleder, forteller, skjedde, snakket, lyst, begynte, ol \n \n \t Topic Kappa: liberaleren, hvara, borgermester, oppspinn, henning, human, orda, paranoia, ignorant, spotify, kloden, bedriver, ruspolitikk, knut, nicolai, oppstyret, planta, jvligste, shows, next \n \t Kappa with Baseline: snakker, livet, aftenposten, tv, spotify, open, podcast, episode, bok, hr, dritt, kloden, serien, knut, podcasts, episoden, jan, sjef, petter \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: frykt, livet, snakker, strste, aftenposten, konspirasjonsteorier, skaper, klima, blff, tv, norges, ny, kampen, lei, 5g, konspirasjon, alvor, ukraina, covid, spotify \n \t \t Marginal FREX: blff, konspirasjonsteorier, konspirasjon, frykt, spotify, bullshit, boken, skaper, muslimer, svartedauden, innvandring, open, konspirasjonen, net, knut, joe_rogan, 5g, podcast, anerkjenner, podcasts \n \t \t Marginal Lift: ignorant, tomprat, joe_rogan, blff, konspirasjonen, quisling, kuppet, massemedia, oppspinn, human, wapo, pedofil, bilete, bedrevitere, liberaleren, konspirasjon, terroren, bedriver, kloden, hvara \n \t \t Marginal Score: frykt, snakker, livet, strste, konspirasjonsteorier, aftenposten, skaper, blff, klima, tv, konspirasjon, norges, 5g, spotify, alvor, kampen, open, ukraina, kloden, lei \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: ny, aftenposten, livet, snakker, tenk, tv, endelig, snakke, lage, leder, hrer, skjer, skrive, rets, skjedde, gleder, forteller, snakket, lrt, lyst \n \t \t Marginal FREX: tv, episode, minutt, hr, glede, spotify, podcast, open, apple, erik, serie, film, konsert, podcasts, musikk, filmen, bilder, episoden, prat, ole \n \t \t Marginal Lift: pcast, oddspodden, almlid, <U+2B50><U+FE0F>, haugesunds, melodi, prix, camus, h, beijing2022, artistene, knutsen, lode, weng, alexandra, felix, pmeldt, lrdagskvelden, moberg, glansen \n \t \t Marginal Score: aftenposten, ny, livet, snakker, tv, tenk, endelig, snakke, lage, leder, skrive, hrer, rets, gleder, skjedde, forteller, snakket, begynte, lyst, lrt \nTopic 16: \n \t Marginal Highest Prob: antall, tiden, smittede, tilfeller, kilde, innlagte, fhi, sykehus, ker, helsedirektoratet, kraftig, endring, sykehusene, pasienter, kning, innlagt, status, meldte, kapasitet, personer \n \t Marginal FREX: smittede, antall, tilfeller, meldte, antallet, diagnose, registrering, msis, prvetakingsdato, tiden, nedgang, x, forsinkelse, innlagte, kende, dagers, intensivplasser, kapasiteten, telle, kapasitet \n \t Marginal Lift: prvetakingsdato, nyinnleggelser, liggedgn, lovisenberggata, inneliggende, nysmittede, trutt, koronakartet, flatet, senger, innlegges, mikrogram, utflating, intensivavdelingene, icpc, bikket, kapasitetsproblemer, landsbasis, sykemeldte, forsinkelse \n \t Marginal Score: antall, tiden, smittede, tilfeller, innlagte, kilde, sykehus, fhi, helsedirektoratet, ker, endring, sykehusene, kraftig, meldte, kning, kapasitet, status, antallet, innlagt, pasienter \n \n \t Topic Kappa: diagnostiserte, pviste, statistikker, kormod, telle, ventilator, aksen, eksponentiell, x, kunnskapsbasert, innleggelser, tilfeller, smittende, vekst, y, overstiger, liner, fremme, laveste, synke \n \t Kappa with Baseline: antall, tilfeller, smittede, tiden, x, innleggelser, antallet, vekst, ke, diagnose, smittetilfeller, kende, telle, registrerte, endring, dagers, pviste, bekreftede, fremme \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: tall, antall, tilfeller, smittede, tiden, stort, tallet, per, endret, definisjonen, begrenset, x, ordet, ukjent, ndvendigvis, fremover, antallet, ke, pasient, teller \n \t \t Marginal FREX: definisjonen, tallet, ndvendigvis, teller, ukjent, antall, begrenset, stort, underrapportering, tall, pasient, grafen, x, tilfeller, graf, tilfellene, mrketall, fremstilling, rapporterte, cfr \n \t \t Marginal Lift: allmennfarlige, definisjonen, fil, fremstilling, tankesett, alert, nyaktige, statistikker, underrapportering, pviste, synonymt, level, diagnostiserte, immunologiske, sporings, cfr, adekvat, epidemiene, rapporterte, giver \n \t \t Marginal Score: tall, antall, tilfeller, smittede, stort, tiden, tallet, definisjonen, endret, per, begrenset, x, ukjent, ndvendigvis, ordet, fremover, antallet, pasient, teller, ke \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: antall, tiden, smittede, tilfeller, kilde, innlagte, fhi, sykehus, ker, helsedirektoratet, kraftig, endring, sykehusene, pasienter, kning, innlagt, status, kapasitet, meldte, personer \n \t \t Marginal FREX: tilfeller, smittede, innlagte, meldte, helsedirektoratet, antall, antallet, tiden, diagnose, registrering, msis, dagers, nedgang, x, prvetakingsdato, registrerte, forsinkelse, kende, kning, ker \n \t \t Marginal Lift: prvetakingsdato, nyinnleggelser, liggedgn, lovisenberggata, inneliggende, nysmittede, trutt, koronakartet, flatet, senger, innlegges, mikrogram, utflating, intensivavdelingene, icpc, bikket, kapasitetsproblemer, landsbasis, sykemeldte, holdenutvalget \n \t \t Marginal Score: antall, tiden, smittede, tilfeller, innlagte, kilde, sykehus, ker, helsedirektoratet, fhi, endring, sykehusene, kraftig, kning, meldte, kapasitet, status, pasienter, innlagt, antallet \nTopic 17: \n \t Marginal Highest Prob: ta, vaksine, vaksinen, vaksiner, vaksinene, vaksinering, covid, gt, vaksinere, bivirkninger, velger, fungerer, sikre, hensyn, doser, imot, medisin, tilgang, mangel, pfizer \n \t Marginal FREX: vaksinene, vaksiner, medisiner, mrna, moderna, rettferdig, trygge, fordeling, legemidler, produsere, effektive, vaksinere, trygg, tilgang, medisin, influensavaksine, ken, vaksinerer, utstyr, covax \n \t Marginal Lift: cepis, vaksinesamarbeidet, produksjonskapasiteten, farmasyter, anskaffelse, oppveier, <U+0001F167><U+200D><U+2640><U+FE0F>, vaksinerdeg, pillene, prioriteringslisten, leverandrene, fullfres, livsforlengende, vaksinerings, respiratoren, skulderen, anskaffe, underkapasitet, skeiv, sanitre \n \t Marginal Score: ta, vaksine, vaksinen, vaksiner, vaksinene, vaksinering, gt, vaksinere, bivirkninger, velger, fungerer, hensyn, sikre, doser, medisin, tilgang, pfizer, imot, mangel, medisiner \n \n \t Topic Kappa: mrna, langtidsbivirkninger, eksperimentell, betalingsevne, eksperimentelle, patentfritak, vaksineprodusenter, genterapi, saksynt, patentet, patent, legemiddelselskaper, polio, patenter, big_pharma, vaksinene, patenten, legemidler, prvekaniner, sprytene \n \t Kappa with Baseline: vaksiner, vaksinene, covid, mrna, bivirkninger, ta, vaksinere, medisiner, vaksine, medisin, effektive, trygg, legemidler, godkjent, nekter, pfizer, fungerer, teknologi, produsere, trygge \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: vaksiner, covid, ta, vaksinene, bivirkninger, finnes, vaksine, vaksinere, behandling, ivermectin, mrna, medisin, medisiner, virker, farlige, fungerer, nekter, ansvar, pfizer, godkjent \n \t \t Marginal FREX: ivermectin, mrna, vaksinene, vaksiner, legemidler, eksperimentell, medisiner, effektive, godkjent, polio, trygg, patent, eksperimentelle, hcq, produsere, behandling, legemiddelverket, massevaksinering, tjomlid, overveldende \n \t \t Marginal Lift: saksynt, patentene, difteri, oppfant, big_pharma, langtidsbivirkninger, kjempefarlig, pyser, faktasjekket, bloggpost, parasitter, undertrykker, vaksineprodusenter, patentfritak, patent, rusmidler, eksperimentell, ineffektive, viagra, patentet \n \t \t Marginal Score: vaksiner, vaksinene, ta, bivirkninger, ivermectin, vaksinere, covid, mrna, behandling, medisin, medisiner, finnes, vaksine, godkjent, farlige, effektive, legemiddelverket, nekter, trygg, pfizer \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: ta, vaksine, vaksinen, vaksiner, vaksinene, vaksinering, gt, covid, velger, vaksinere, bivirkninger, fungerer, hensyn, sikre, doser, imot, tilgang, medisin, mangel, pfizer \n \t \t Marginal FREX: vaksine, pfizer, vaksinering, vaksiner, vaksinene, medisin, medisiner, moderna, effektiv, az, vaksinen, rettferdig, mrna, fordeling, utvikle, skeptisk, koronavaksine, trygge, doser, nytte \n \t \t Marginal Lift: cepis, vaksinesamarbeidet, produksjonskapasiteten, farmasyter, anskaffelse, oppveier, <U+0001F167><U+200D><U+2640><U+FE0F>, vaksinerdeg, pillene, prioriteringslisten, leverandrene, fullfres, livsforlengende, vaksinerings, respiratoren, skulderen, anskaffe, underkapasitet, skeiv, sanitre \n \t \t Marginal Score: ta, vaksine, vaksinen, vaksiner, vaksinene, vaksinering, gt, vaksinere, velger, bivirkninger, hensyn, fungerer, sikre, doser, imot, medisin, tilgang, pfizer, mangel, tilgjengelig \nTopic 18: \n \t Marginal Highest Prob: norge, verden, land, koronavirus, sverige, landet, kina, nyheter, reise, mens, nordmenn, resten, verdens, dn, rammet, strste, hardt, msn, reiser, vrt \n \t Marginal FREX: afrika, landene, fattige, land, brasil, s24, india, extraavisen, verdens, verden, korea, norge, vestlige, resten, vesten, spania, herjer, reist, asia, filternyheter \n \t Marginal Lift: primaregnskap, revisorforum1, tvangsmulkt, s24, extraavisen, csng, pter, coronaveckan, utenriksdepartementet, koreas, bjrnestad, salet, annerledeslandet, flyktningleir, skytteltrafikk, befolkede, grensehandelen, migrantene, tirol, makedonia \n \t Marginal Score: norge, land, verden, sverige, koronavirus, landet, kina, nyheter, reise, verdens, resten, nordmenn, rammet, dn, strste, mens, hardt, msn, reiser, norges \n \n \t Topic Kappa: africa, befolknings, rike, wet, globalister, fattige, overbefolkning, syria, rikeste, donere, gaza, g20, indias, libya, utviklede, vestlige, helvetet, np, sult, tedros \n \t Kappa with Baseline: land, verden, norge, verdens, rike, befolkning, fattige, mens, lever, resten, landene, landet, afrika, sr, katastrofe, millioner, india, rikeste, vesten, nordmenn \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: norge, verden, land, verdens, landet, millioner, mennesker, befolkning, mens, lever, trenger, menneskeheten, resten, fattige, rike, fn, nordmenn, israel, covid, milliarder \n \t \t Marginal FREX: befolkning, menneskeheten, fattige, millioner, rike, malaria, helseorganisasjon, amerikanerne, verdens, vestlige, land, sult, katastrofe, vesten, afrika, edition, state, wto, landene, trips \n \t \t Marginal Lift: jdisk, felleskatalogen, artritt, plaquenil, riksavisen, palestinerne, menneskeheten, fredjohs, israels, africa, befolknings, krigs, nasjonalister, billion, kommunistiske, trips, utviklede, globalister, wto, state \n \t \t Marginal Score: verden, land, norge, verdens, millioner, befolkning, lever, landet, menneskeheten, mens, fattige, rike, resten, fn, mennesker, israel, landene, globalt, milliarder, trenger \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: norge, land, verden, koronavirus, sverige, landet, kina, nyheter, reise, mens, nordmenn, resten, verdens, dn, rammet, strste, hardt, msn, reiser, vrt \n \t \t Marginal FREX: abcnyheter, landet, afrika, sverige, land, landene, grenser, korea, brasil, fattige, india, s24, coronavirusnorge, svenske, amerika, hardest, rammet, abc, verdens, extraavisen \n \t \t Marginal Lift: primaregnskap, revisorforum1, tvangsmulkt, s24, extraavisen, csng, pter, coronaveckan, utenriksdepartementet, koreas, bjrnestad, salet, annerledeslandet, flyktningleir, skytteltrafikk, befolkede, grensehandelen, migrantene, tirol, makedonia \n \t \t Marginal Score: norge, land, verden, sverige, landet, koronavirus, kina, nyheter, reise, resten, nordmenn, verdens, rammet, dn, strste, hardt, msn, mens, reiser, spania \nTopic 19: \n \t Marginal Highest Prob: pandemi, neste, midt, mte, hjemmekontor, post, jobbe, global, mulighet, mter, gratis, studenter, fysisk, viktig, pent, hsten, utfordringer, professor, pvirker, korona_pandemien \n \t Marginal FREX: uio, midt, digitalt, uib, zoom, hjemmefra, bker, oslomet, kurs, digitalisering, campus, studenter, arrangere, pandemi, pgende, verdensomspennende, avlyse, studentene, forelesninger, arrangerer \n \t Marginal Lift: nifu, unioslo, undervisere, canvas, campus, thenewcompany, forelesere, hgskoler, forelesningene, teknologiradet, forelesninger, digitalundervisning, hjemmeeksamen, gruppearbeid, semester, hyskoler, stud, rttingen, norgesarktiske, panelsamtale \n \t Marginal Score: pandemi, neste, midt, hjemmekontor, mte, post, global, jobbe, studenter, gratis, mulighet, mter, fysisk, pent, professor, hsten, utfordringer, korona_pandemien, uio, lsninger \n \n \t Topic Kappa: verdensomspennende, titan, gevinster, mn, professorer, naturvitenskapelige, pgende, grunnforskning, interaksjon, mter, korsvei, foreleser, institutt, professor, matematisk, cv, adressere, global, apollon, uio \n \t Kappa with Baseline: pandemi, global, midt, professor, mter, vrt, neste, uio, pgende, verdensomspennende, pvirket, arbeid, pgr, oppleve, utvalg, uib, bidra, glemt \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: pandemi, pandemien, forskere, global, stoppe, tenk, vrt, neste, professor, midt, mter, reagerer, jobber, liksom, bidra, hndtere, covid, pgende, fins, uio \n \t \t Marginal FREX: forskere, verdensomspennende, vrt, reagerer, fins, klimaendringer, fornekter, mter, delegge, retorikk, pgende, pandemien, fagfolk, uio, hndtere, professor, cv, liksom, tenk, forstelsen \n \t \t Marginal Lift: onlinelibrary, wiley, reinspikka, titan, noah, smittevernbyret, motarbeide, junk, lisensen, smitteverntiltaka, likegyldighet, verdensomspennende, mn, fastslr, destruktive, fornekter, fins, professorer, cv, forskere \n \t \t Marginal Score: pandemi, pandemien, forskere, global, stoppe, vrt, tenk, professor, mter, neste, reagerer, midt, hndtere, liksom, fins, pgende, uio, fagfolk, verdensomspennende, delegge \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: pandemi, neste, midt, mte, hjemmekontor, post, jobbe, global, mulighet, mter, gratis, studenter, fysisk, viktig, pent, hsten, utfordringer, korona_pandemien, pvirker, sosiale \n \t \t Marginal FREX: midt, global, uio, digitale, digitalt, studenter, kurs, hjemmefra, digital, webinar, khrono, bker, uib, ntnu, pandemi, konferanse, zoom, oppi, pgende, uit \n \t \t Marginal Lift: nifu, unioslo, undervisere, canvas, campus, thenewcompany, forelesere, hgskoler, forelesningene, teknologiradet, forelesninger, digitalundervisning, hjemmeeksamen, gruppearbeid, semester, hyskoler, stud, rttingen, norgesarktiske, panelsamtale \n \t \t Marginal Score: pandemi, neste, midt, mte, hjemmekontor, post, jobbe, global, mulighet, gratis, studenter, mter, fysisk, pent, hsten, korona_pandemien, utfordringer, pvirker, lsninger, sosiale \nTopic 20: \n \t Marginal Highest Prob: nrk, dlvr, direkte, helse, nytt, nrknyheterrss, psykisk, ift, pluss, nrkdistriktsisterss, tt, forsiden, nrkdistrikttoppsakerrss, smittet, nrknyhetertoppsakerforsidenrss, radio, adressa, innenriks, viken, stigma \n \t Marginal FREX: nrkdistriktsisterss, nrkdistrikttoppsakerrss, stigma, fighting, nrkinnenrikstoppsakerrss, vegrshei, nrknyheterrss, psykiske, nrknyhetersisterss, psykisk, fjordane, hordaland, koronasmittet, nrknyhetertoppsakerforsidenrss, nrkutenrikstoppsakerrss, nordland, utenriks, nrkdistrikttoppsakersognogfjordanerss, nrkdistrikttoppsakerfinnmarkrss, nrkdistrikttoppsakerhordalandrss \n \t Marginal Lift: nrkdistriktsistesognogfjordanerss, nrkdistriktsistemoreogromsdalrss, nrkdistrikttoppsakersognogfjordanerss, nrkdistriktsisterogalandrss, nrkdistriktsistetromsrss, nrkdistriktsisteinnlandetrss, nrkdistriktfinnmarksisterss, nrkdistrikttoppsakerhordalandrss, nrkdistrikttoppsakermoreogromsdalrss, nrkdistriktsistevestfoldogtelemarkrss, nrkvestfold, nrkdistrikttoppsakerrogalandrss, nrkutenrikstoppsakerrss, nrkdistrikttoppsakertromsrss, nrkdistriktsisterss, nrkdistrikttoppsakerinnlandetrss, fjordane, nrkdistrikttoppsakersorlandetrss, nrkinnenrikstoppsakerrss, nrkkulturrss \n \t Marginal Score: dlvr, nrk, direkte, helse, nytt, nrknyheterrss, psykisk, ift, pluss, nrkdistriktsisterss, tt, forsiden, nrkdistrikttoppsakerrss, nrknyhetertoppsakerforsidenrss, radio, adressa, innenriks, stigma, nrkinnenrikstoppsakerrss, psykiske \n \n \t Topic Kappa: lidelser, nyfdte, mors, johnny, koronatilfeller, corona_vaksine, subtile, covid19, iransk, tenringer, svindle, avdekket, uhelse, srafrikansk, koronadde, helseplager, millionene, indirekte, babyen, opplyser \n \t Kappa with Baseline: nrk, smittet, helse, lidelser, corona_vaksine, psykisk, psykiske, stigma, bekrefter, avdekket, opplyser, dlvr, koronasmitte, kvinne, fighting, indirekte, meldt, meldinger \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: dde, smittet, nrk, n, helse, mneder, mann, frre, mannen, pst, senere, gammel, italia, lidelser, viktigere, bekrefter, million, covid, pvirke, korona_vaksine \n \t \t Marginal FREX: dde, pst, smittet, mann, mannen, lidelser, iran, gammel, corona_vaksine, kvinne, n, frre, senere, korona_vaksine, avdekket, ddsfallet, mneder, overlevde, milliard, skurk \n \t \t Marginal Lift: legitimerer, skurk, bigpharma, katolske, regimets, terrorist, pst, lidelser, mors, johnny, nyfdte, jamfr, subtile, tilskrives, omkommet, tenringer, corona_vaksine, iransk, svindle, covid19 \n \t \t Marginal Score: dde, smittet, nrk, n, mann, mneder, helse, mannen, frre, pst, senere, gammel, lidelser, italia, bekrefter, viktigere, kvinne, korona_vaksine, iran, corona_vaksine \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: dlvr, nrk, direkte, helse, nytt, nrknyheterrss, psykisk, ift, pluss, nrkdistriktsisterss, tt, forsiden, nrkdistrikttoppsakerrss, nrknyhetertoppsakerforsidenrss, radio, adressa, innenriks, viken, nrkinnenrikstoppsakerrss, stigma \n \t \t Marginal FREX: psykisk, tt, nrkdistriktsisterss, stigma, dlvr, fighting, nrkdistrikttoppsakerrss, psykiske, haugaland, nrkinnenrikstoppsakerrss, vegrshei, nrknyheterrss, nrknyhetertoppsakerforsidenrss, forsiden, nrknyhetersisterss, koronasmittet, radio, fjordane, io, mre \n \t \t Marginal Lift: nrkdistriktsistesognogfjordanerss, nrkdistriktsistemoreogromsdalrss, nrkdistrikttoppsakersognogfjordanerss, nrkdistriktsisterogalandrss, nrkdistriktsistetromsrss, nrkdistriktsisteinnlandetrss, nrkdistriktfinnmarksisterss, nrkdistrikttoppsakerhordalandrss, nrkdistrikttoppsakermoreogromsdalrss, nrkdistriktsistevestfoldogtelemarkrss, nrkvestfold, nrkdistrikttoppsakerrogalandrss, nrkutenrikstoppsakerrss, nrkdistrikttoppsakertromsrss, nrkdistriktsisterss, nrkdistrikttoppsakerinnlandetrss, fjordane, nrkdistrikttoppsakersorlandetrss, nrkinnenrikstoppsakerrss, nrkkulturrss \n \t \t Marginal Score: dlvr, nrk, direkte, helse, nytt, nrknyheterrss, psykisk, ift, pluss, nrkdistriktsisterss, tt, forsiden, nrkdistrikttoppsakerrss, nrknyhetertoppsakerforsidenrss, radio, adressa, innenriks, stigma, nrkinnenrikstoppsakerrss, viken \nTopic 21: \n \t Marginal Highest Prob: rett, forstr, dessverre, myndighetene, handler, uk, poenget, ansvar, politisk, null, stille, valg, co, poeng, politikere, erna, hyre, politikk, egne, strategi \n \t Marginal FREX: uk, co, politisk, bla, mene, bbc, zero_covid, fremstr, jada, begrepet, venstre, kritikk, tr, grep, vkne, hyre, fokus, tffe, standard, erna \n \t Marginal Lift: aldrimer12mars, mirror, pandemiplan2014, huseier, smk, hla, pragmatiske, lederskapet, hanske, poengtert, veivalg, formildende, ufine, co, forberedelser, hndverk, aus, education, mt, kjeftet \n \t Marginal Score: rett, uk, forstr, myndighetene, dessverre, handler, poenget, ansvar, politisk, co, stille, erna, politikere, hyre, null, valg, poeng, politikk, strategi, egne \n \n \t Topic Kappa: bbc, begrepet, dailyexpose, thesun, zero_covid, imperial, assets, avfeie, latterliggjort, dystopisk, menneskeliv, independent, telegraph, uk, dailymail, college, avslre, dets, bla, fremstr \n \t Kappa with Baseline: uk, co, politisk, bbc, bla, begrepet, fremstr, zero_covid, britiske, mene, vkne, menneskeliv, tr, realiteten, gov, independent, grep, telegraph, sette \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: uk, politisk, co, bbc, side, begrepet, bla, reuters, menneskeliv, fremstr, sverige, britiske, vkne, svenske, brukte, zero_covid, mene, tilstander, tr, covid \n \t \t Marginal FREX: bbc, begrepet, metoder, co, reuters, uk, britiske, forakt, bla, zero_covid, cases, bias, individer, flokk, fremstr, politisk, epidemiologer, passer, uenige, vkne \n \t \t Marginal Lift: definisjonsmakten, hominem, psykopat, confirmation, lgnpropaganda, bbc, forakt, doctor, alarmist, dikterer, cases, dystopisk, goes, begrepet, deaths, japantimes, gates, folkemord, ddsvirus, publishing \n \t \t Marginal Score: uk, politisk, co, bbc, begrepet, reuters, bla, side, menneskeliv, britiske, fremstr, vkne, zero_covid, svenske, mene, tilstander, metoder, gates, sverige, tr \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: rett, forstr, dessverre, myndighetene, handler, poenget, ansvar, uk, null, stille, valg, politikere, poeng, erna, hyre, politisk, politikk, egne, co, strategi \n \t \t Marginal FREX: uk, erna, co, strategi, forstr, kritikk, hyre, politisk, politiske, gov, regjering, egne, ansvar, hnd, mene, tillit, bla, rett, kritiserer, myndighetene \n \t \t Marginal Lift: aldrimer12mars, mirror, pandemiplan2014, huseier, smk, hla, pragmatiske, lederskapet, hanske, poengtert, veivalg, formildende, ufine, forberedelser, hndverk, aus, education, mt, kjeftet, <U+0001F160><U+200D><U+2642><U+FE0F> \n \t \t Marginal Score: rett, forstr, myndighetene, dessverre, handler, uk, ansvar, poenget, erna, stille, null, valg, politikere, hyre, politisk, co, poeng, egne, strategi, politikk \nTopic 22: \n \t Marginal Highest Prob: lenge, allerede, uker, lov, eu, europa, dose, mneder, befolkningen, kort, tidlig, vente, tide, enn, mnd, pass, startet, folket, starten, sommeren \n \t Marginal FREX: pass, kaos, vaksinepass, nummer, vaksinedose, putin, dose, es, russland, avtale, passet, avtalen, noregnorge, godkjenning, borgere, eus, anti, motstand, europa, mittportugal \n \t Marginal Lift: 20212022, 20202021, fylkesnemnda, prosessregelverket, introduksjonsloven, rsregnskap, saksopplysninger, sanksjon, forskriftshjemmel, foretakslovgivningen, fristene, mittportugal, rekonstruksjon, draghi, lefigaro, haag, covidpass, intervall, orbn, coronapasset \n \t Marginal Score: lenge, allerede, uker, lov, eu, europa, dose, mneder, befolkningen, tidlig, vente, kort, mnd, enn, pass, tide, folket, startet, kaos, sommeren \n \n \t Topic Kappa: vaxxers, leyen, ursula, anti, hentesmitte, benektere, borgere, credit, fda, noregnorge, stem, ekstreme, stemplet, emergency, ddsvirusret2020, eus, tkepreik, agency, eliter, tvangsvaksinering \n \t Kappa with Baseline: dose, eu, anti, kaos, pass, europa, borgere, ekstreme, krav, vaksinepass, covid, noregnorge, enn, full, es, russland, putin, fda, sitat, eus \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: norske, dose, eu, doser, anti, covid, steigan, kaos, enn, europa, pne, borgere, vaksinering, pass, full, ekstreme, nsker, skalt, vaksinepass, fda \n \t \t Marginal FREX: anti, doser, borgere, kaos, ekstreme, dose, noregnorge, fornuften22, wordpress, vaxxers, fda, eus, es, livsfarlig, booster, skalt, ideologi, ekstrem, avtalen, feilsltt \n \t \t Marginal Lift: vaxxers, massedrap, emergency, sinnssyke, narko, ddsviruset, elitene, hentesmitte, skamplett, leyen, fanatiske, stemplet, anti, lovstridig, somle, tkepreik, ursula, foreldet, klimahysteriet, oppgjrets \n \t \t Marginal Score: dose, norske, doser, eu, anti, kaos, borgere, steigan, ekstreme, pass, europa, enn, pne, skalt, vaksinering, vaksinepass, fda, sitat, full, noregnorge \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: lenge, allerede, uker, lov, europa, eu, mneder, dose, befolkningen, tidlig, kort, vente, tide, enn, mnd, pass, startet, folket, starten, sommeren \n \t \t Marginal FREX: eu, pass, kaos, folket, israel, vaksinepass, vaksineringen, vaksinedose, nummer, ukraina, putin, russland, passet, loven, motstand, es, straks, vaksinedoser, avtalen, godkjenning \n \t \t Marginal Lift: 20212022, 20202021, fylkesnemnda, prosessregelverket, introduksjonsloven, rsregnskap, saksopplysninger, sanksjon, forskriftshjemmel, foretakslovgivningen, fristene, mittportugal, rekonstruksjon, draghi, lefigaro, haag, covidpass, intervall, orbn, coronapasset \n \t \t Marginal Score: lenge, allerede, uker, lov, eu, europa, dose, mneder, befolkningen, tidlig, kort, vente, mnd, enn, tide, pass, startet, folket, starten, kaos \nTopic 23: \n \t Marginal Highest Prob: barn, jobb, hjemme, unge, hjem, stengt, barna, skoler, skole, skolen, niv, voksne, lrere, veien, bekymret, hold, sm, familie, venner, familien \n \t Marginal FREX: skolen, barna, barn, foreldre, barnehage, lrere, foreldrene, hjemmeskole, videregende, voksne, barnehagen, barnehager, ungdom, pappa, unge, barns, barnehagene, ungdommer, mor, bhg \n \t Marginal Lift: bedreskole, sndagsgudstjeneste, onsdagsgudstjeneste, skolenorge, ifttt, profeterte, aks, barneskolene, forkynner, barnehagelrere, gresshoppeplagen, handal, goo, lrerrommet, grunnskole, utdanningsdirektoratet, ungdomsskoler, bbolstad, skolenes, klassene \n \t Marginal Score: barn, jobb, hjemme, unge, hjem, stengt, barna, skoler, skolen, skole, voksne, niv, lrere, bekymret, hold, veien, sm, familie, foreldre, venner \n \n \t Topic Kappa: jesu, overgrep, religis, seksuelle, svada, barn, krisepsykologi, unge, barns, voksne, children, bestefar, school, far, barnelege, engh, ungdommer, hen, livets, barna \n \t Kappa with Baseline: barn, unge, barna, voksne, foreldre, ungdom, far, mor, overgrep, hen, ungdommer, barns, gamle, foreldrene, skolen, prioritere, bekymrer, familier \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: barn, syke, unge, friske, gt, menn, voksne, barna, nettavisen, kvinner, utsatt, gamle, rammer, gruppe, vaksineres, foreldre, ungdom, ekstremt, rammet, far \n \t \t Marginal FREX: barn, menn, rammer, gt, kvinner, unge, vaksineres, syke, barna, voksne, gruppe, overgrep, sjeldent, barns, friske, rammes, far, ungdom, foreldre, tler \n \t \t Marginal Lift: children, assosierer, begr, overgripere, pushes, pfu, jesu, aliens, svada, tilbakeholden, religis, seksuelle, hoc, oppdragelse, school, hjernedd, ayatollah, foreldres, vaksineres, overgrep \n \t \t Marginal Score: barn, syke, unge, friske, menn, gt, voksne, barna, kvinner, nettavisen, rammer, vaksineres, gruppe, utsatt, gamle, foreldre, ungdom, far, tler, sykt \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: barn, jobb, hjemme, unge, hjem, stengt, skoler, barna, skole, skolen, niv, voksne, lrere, veien, bekymret, hold, sm, familie, venner, familien \n \t \t Marginal FREX: skolen, barn, barna, lrere, foreldre, elevene, voksne, hjemmeskole, barnehage, barnehagen, ungene, ungdom, foreldrene, mor, barnehager, unge, barnet, unger, ungdommer, videregende \n \t \t Marginal Lift: bedreskole, sndagsgudstjeneste, onsdagsgudstjeneste, skolenorge, ifttt, profeterte, aks, barneskolene, forkynner, barnehagelrere, gresshoppeplagen, handal, goo, lrerrommet, grunnskole, utdanningsdirektoratet, ungdomsskoler, bbolstad, skolenes, klassene \n \t \t Marginal Score: barn, jobb, hjemme, unge, hjem, stengt, barna, skoler, skolen, skole, niv, voksne, lrere, bekymret, hold, veien, familie, sm, venner, familien \nTopic 24: \n \t Marginal Highest Prob: smittet, karantene, dager, testet, test, personer, positivt, minst, symptomer, tester, person, n, teste, positive, par, positiv, testing, isolasjon, tok, timer \n \t Marginal FREX: test, tester, positivt, testen, positive, positiv, pcr, testene, nrkontakt, symptomer, negativ, testing, defineres, person, laboratoriedata, testes, epidemiens, gardermoen, milde, stk \n \t Marginal Lift: laboratoriedata, nossum, myhr, ugifte, covidtest, berisha, 2tdf, hjemmeisolasjon, testkriterier, avla, oversiktelig, koronatesten, prvesvaret, atypiske, smittesporer, selvtest, 2g, 2sykkel, testens, veton \n \t Marginal Score: smittet, karantene, dager, testet, test, positivt, personer, symptomer, minst, tester, person, positive, n, teste, positiv, par, testing, isolasjon, negativ, timer \n \n \t Topic Kappa: pcr, positiver, symptomatiske, diagnostisere, falsk, ct, falske, svelget, testene, antistoff, serologi, diagnostiske, sykluser, sensitiviteten, asymptomatiske, kits, dokumenteres, kriteriene, hvilkentest, testen \n \t Kappa with Baseline: personer, pcr, test, symptomer, tester, minst, testen, person, falske, falsk, testene, testing, positive, positiv, covid, milde, resultat, positivt, negativ, teste \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: brukes, personer, pcr, symptomer, test, minst, person, covid, tester, falske, falsk, smittsom, testen, testing, positive, testene, positiv, nylig, isolert, slr \n \t \t Marginal FREX: pcr, brukes, testene, falske, falsk, testen, skille, verdi, ubrukelig, pvise, isolert, levende, regnes, personer, asymptomatiske, definerer, oppfinneren, milde, nylig, antistoff \n \t \t Marginal Lift: diagnosere, mullis, numbers, detektere, oppfinneren, analysis, diagnostisere, sykluser, dna, symptomatiske, false, fremviser, emeritus, pcr, serologi, uplitelig, svelget, prediktiv, ct, pvise \n \t \t Marginal Score: brukes, pcr, personer, symptomer, test, minst, falske, falsk, person, tester, testen, smittsom, testene, testing, positive, positiv, isolert, nylig, milde, dna \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: smittet, karantene, dager, testet, test, positivt, personer, minst, symptomer, tester, n, person, teste, par, positive, positiv, testing, isolasjon, tok, timer \n \t \t Marginal FREX: test, positivt, tester, symptomer, positive, positiv, testen, person, testes, negativ, testing, nrkontakt, pcr, innreise, hurtigtest, testene, defineres, negative, forkjlet, epidemiens \n \t \t Marginal Lift: laboratoriedata, nossum, myhr, ugifte, covidtest, berisha, 2tdf, hjemmeisolasjon, testkriterier, avla, oversiktelig, koronatesten, prvesvaret, smittesporer, selvtest, atypiske, 2g, 2sykkel, testens, veton \n \t \t Marginal Score: smittet, karantene, dager, testet, test, positivt, symptomer, personer, minst, tester, n, person, positive, teste, par, positiv, testing, isolasjon, timer, negativ \nTopic 25: \n \t Marginal Highest Prob: covid19, norsk, gjelder, ly, dagens, smittevern, bit, situasjon, lokale, unntak, avdeling, forskrift, forskriften, lovtidend, smitteverntiltak, kunngjringsbolk, link, forskrifter, koronavirus, midlertidig \n \t Marginal FREX: bit, ly, forskrift, forskriften, forskrifter, kunngjringsbolk, ow, regionale, aktuell, covid19forskriften, lovtidend, smittevernforskrifter, buff, avdeling, smittevernloven, dagens, hjemmel, endringsforskrift, situasjon, bolken \n \t Marginal Lift: covid19forskriften, cereal, americanairlines, bolken, nittedalkommune, solakommune, vestbykommune, kjtteksport, soyabnne, donmario, mustangseeds, argentinsk, smittevernforskrift, konomiposten, landlisten, kunngjringsbolk, plantingsplanene, smittevernforskrifter, eksportbarrierer, grain \n \t Marginal Score: covid19, norsk, gjelder, ly, dagens, bit, smittevern, situasjon, lokale, unntak, avdeling, forskrift, forskriften, lovtidend, forskrifter, kunngjringsbolk, smitteverntiltak, link, midlertidig, regionale \n \n \t Topic Kappa: emk, qoo, phishing, biotech, hjemmel, redaktrforening, 4a, vedtatt, jf, motvirke, opphevelse, unntaket, smvl, ikrafttredelse, ledd, bokstav, smittevernloven, ipsos, vedta, opphevet \n \t Kappa with Baseline: dagens, ly, situasjon, endringer, bit, smittevern, gjelder, utbrudd, norsk, kraft, vedtatt, midlertidig, unntak, ledd, smittevernloven, forskriften, hjemmel, gjeldende, nringsliv, lovdata \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: gjelder, dagens, situasjonen, norsk, situasjon, pandemier, skadelig, politiske, ledere, utbrudd, smittevern, ly, system, fjernet, sm, politiet, lover, loven, unntak, bit \n \t \t Marginal FREX: pandemier, skadelig, allmennfarlig, utbrudd, system, fjernet, handlinger, epidemier, loven, analyse, ledere, utnytte, forslaget, vilkrene, kampanjer, tilstrekkelig, ethvert, hjemmel, politiske, flelser \n \t \t Marginal Lift: metadata, blood, allmennfarlig, sapiens, straffbar, hyklere, vilkrene, smvl, straffeloven, kampanjer, skadelig, homo, phishing, programvare, selvopptatte, riket, motarbeider, templat, naturkatastrofer, handlinger \n \t \t Marginal Score: dagens, gjelder, pandemier, skadelig, situasjon, politiske, utbrudd, ledere, system, fjernet, situasjonen, loven, politiet, lover, ly, norsk, sm, allmennfarlig, analyse, smittevern \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: covid19, norsk, gjelder, ly, dagens, smittevern, bit, situasjon, lokale, unntak, avdeling, forskrift, forskriften, lovtidend, smitteverntiltak, kunngjringsbolk, forskrifter, koronavirus, link, midlertidig \n \t \t Marginal FREX: ly, bit, forskrift, forskriften, forskrifter, ow, kunngjringsbolk, aktuell, lovtidend, avdeling, regionale, smittevernloven, unntak, covid19forskriften, vedtak, inkluderer, buff, smittevernforskrifter, dagens, <U+2B07><U+FE0F> \n \t \t Marginal Lift: covid19forskriften, cereal, americanairlines, nittedalkommune, solakommune, vestbykommune, bolken, kjtteksport, soyabnne, donmario, mustangseeds, argentinsk, smittevernforskrift, konomiposten, landlisten, kunngjringsbolk, plantingsplanene, smittevernforskrifter, eksportbarrierer, grain \n \t \t Marginal Score: covid19, norsk, gjelder, ly, dagens, bit, smittevern, situasjon, lokale, unntak, avdeling, forskrift, forskriften, lovtidend, smitteverntiltak, forskrifter, kunngjringsbolk, link, regionale, midlertidig \nTopic 26: \n \t Marginal Highest Prob: oslo, kommune, uke, mars, bergen, mai, bor, kl, april, kommunen, pvist, trondheim, fredrikstad, forrige, januar, fredag, mandag, pner, byen, uka \n \t Marginal FREX: fredrikstad, rana, oslo, raymond, uke, august, johansen, hammerfest, brum, oslos, ordfreren, kommunens, ordfrer, levanger, budstikka, sarpsborg, vartoslo, volda, trinn, moss \n \t Marginal Lift: sedvane, registrer, plikten, ytterlige, somaliske, endres, tildelt, innbyggerne, agderposten, politivedtekt, villsmitte, mottatt, dry, nb, moldes, innfrer, vaksinesenter, pbudet, johansen, brevet \n \t Marginal Score: oslo, kommune, uke, mars, bergen, mai, bor, kl, fredrikstad, kommunen, april, trondheim, januar, forrige, fredag, pvist, mandag, pner, byen, uka \n \n \t Topic Kappa: sedvane, registrer, plikten, smittetall, innfrer, somaliske, pvist, endres, innbyggerne, politivedtekt, agderposten, bes, tildelt, beboerne, mottatt, innbyggere, villsmitte, ullensaker, moldes, dry \n \t Kappa with Baseline: pvist, uke, oslo, innbyggere, smittetall, innfrer, forrige, sist, endres, september, innbyggerne, kommuner, kommune, mottatt, raymond, besk, johansen, koronasituasjonen, koronasmitte, nb \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: pvist, skremmende, uke, tilfelle, oslo, stat, forbud, pbud, oversikt, innbyggere, mister, niv, myndighetene, hye, innfrer, sikkerhet, sist, nasjonale, oppfordrer, smittetall \n \t \t Marginal FREX: stat, pbud, pvist, mister, forbud, innbyggere, tilfelle, menneskerettigheter, abort, innfrer, knyttes, oppfordrer, sikkerhet, terrorisme, institusjoner, virusvarianten, smittetall, oversikt, brudd, nasjonale \n \t \t Marginal Lift: terrorisme, kommunismen, abort, brukerne, ovennevnte, virusvarianten, stat, knyttes, rystende, blle, mobben, ytterlige, veganere, fkka, registrer, plikten, pbud, forml, sedvane, munnbindpbudet \n \t \t Marginal Score: pvist, tilfelle, skremmende, uke, stat, forbud, pbud, innbyggere, mister, oversikt, oslo, innfrer, sikkerhet, niv, hye, oppfordrer, smittetall, nasjonale, sist, brudd \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: oslo, kommune, uke, mars, bergen, mai, bor, kl, april, kommunen, trondheim, fredrikstad, januar, forrige, fredag, mandag, pner, pvist, byen, uka \n \t \t Marginal FREX: fredrikstad, oslo, rana, uke, raymond, august, sms, johansen, ordfrer, byrdet, hammerfest, oslos, ordfreren, kommunens, levanger, brum, trinn, follo, vartoslo, september \n \t \t Marginal Lift: baerum, koronasenteret, isiflo, politivedtekten, surfschool, skaun, strinda, avisolert, vaksinasjonssenteret, reiserelaterte, hjemmehrende, volda, stjordal, smitteveg, formannskapet, bydelene, kriseledelsen, reiserelatert, alna, oppsamling \n \t \t Marginal Score: oslo, kommune, uke, mars, bergen, mai, bor, kommunen, fredrikstad, april, kl, trondheim, januar, fredag, mandag, forrige, pner, byen, uka, vartoslo \nTopic 27: \n \t Marginal Highest Prob: corona, mtte, gikk, tider, nesten, laget, plass, full, dra, trodde, faen, sikkert, lag, fotball, kamp, sitter, spiller, plutselig, spille, kjpe \n \t Marginal FREX: l, hytta, klubbene, kamper, kampene, league, drikker, ligaen, fuck, stadion, premier, <U+26BD><U+FE0F>, eliteserien, bil, drikke, tribuner, tilskuere, spilles, lagene, rbk \n \t Marginal Lift: ubeseiret, bortekamper, avbrekket, blanca, bortebane, capri, 2cl, scora, eibar, champions, atltico, sociedad, celtics, mbappe, unitedno, atletico, cupfinalen, assist, siro, schalke \n \t Marginal Score: corona, tider, gikk, mtte, faen, dra, laget, lag, kamp, fotball, nesten, trodde, spiller, full, spille, kjpe, plass, kamper, plutselig, sesongen \n \n \t Topic Kappa: idioter, synder, cia, dum, kjedebrev, slemme, idioten, apokalypse, wars, gin, jesus, rver, flue, helvetes, lakers, anatomy, sauene, zombie, dvel, diktet \n \t Kappa with Baseline: corona, faen, idioter, dum, spill, selger, helvete, lager, tider, jesus, fuck, hater, tok, alkohol, greia, selge, hrte, sitter \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: corona, dagbladet, idioter, kaller, faen, gud, corona_viruset, kalt, dumme, verre, tok, jvla, sa, verste, idiot, skyld, dum, menneskene, navn, covid \n \t \t Marginal FREX: idioter, gud, kalt, jvla, dum, guds, jdene, faen, lidelse, jesus, hysteri, menneskene, globalistene, svin, sex, vill, religise, selger, internett, gale \n \t \t Marginal Lift: hjernevaske, jdene, venstrevridde, nazister, utkledd, svindler, frabedt, skaperen, reptiler, regnskog, profet, fornektelse, jder, rusmiddel, tilhengerne, forgiftet, avhengighetsskapende, selverklrt, omvende, fascistisk \n \t \t Marginal Score: corona, idioter, kaller, faen, gud, dagbladet, kalt, corona_viruset, jvla, idiot, dum, dumme, menneskene, verste, serist, krigen, skyld, hysteri, navn, lager \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: corona, mtte, gikk, tider, nesten, laget, plass, full, dra, trodde, sikkert, lag, fotball, kamp, faen, spiller, sitter, plutselig, spille, kjpe \n \t \t Marginal FREX: l, hytta, drikke, fy, league, klubbene, bil, fuck, pausen, united, drikker, klubber, kamper, kampene, faen, ligaen, spilles, rbk, klubb, cl \n \t \t Marginal Lift: ubeseiret, bortekamper, avbrekket, blanca, bortebane, capri, 2cl, scora, eibar, champions, atltico, sociedad, celtics, mbappe, unitedno, atletico, assist, cupfinalen, siro, schalke \n \t \t Marginal Score: corona, tider, gikk, mtte, laget, dra, faen, lag, kamp, fotball, nesten, full, trodde, spiller, spille, kjpe, plutselig, plass, kamper, sesongen \nTopic 28: \n \t Marginal Highest Prob: smitte, munnbind, samfunnet, ansatte, jobber, smitten, avstand, pne, unng, helsevesenet, stenge, ndvendig, kontakt, helsepersonell, steder, viktig, spredning, beskytte, tett, fare \n \t Marginal FREX: munnbind, begrense, sosial, helsetjenesten, srbare, meters, smitte, beskytte, unng, hindre, spredning, utsetter, redusere, smitten, masker, fengsel, avstand, ansatte, finnmarkssykehuset, meter \n \t Marginal Lift: basty, minimumstall, friomsorgen, smittestatistikk, kriminalomsorgen, coronawontbeneglected, mahkumayirmiyor, finnmarkssykehuset, kirurgiske, hjelpepleiere, hjemmetjeneste, hjemmetjenestene, barneidretten, butikkansatte, transportmidler, bpa, betjeningen, smittevernmessig, ventilerte, helsefagarbeidere \n \t Marginal Score: smitte, munnbind, samfunnet, ansatte, jobber, smitten, avstand, pne, unng, helsevesenet, stenge, kontakt, ndvendig, helsepersonell, spredning, steder, beskytte, srbare, hindre, fare \n \n \t Topic Kappa: adferd, hindrer, forhindre, luftbren, beskytte, reduserer, spredning, redsel, begrense, hindre, risikogr, fengsler, griper, bter, srbar, usolidariske, plegge, utsetter, redusert, smitte \n \t Kappa with Baseline: smitte, munnbind, beskytte, spredning, smitten, hindre, hindrer, unng, fare, begrense, redusert, srbare, redusere, forhindre, bidrar, undvendig, smittespredning, reduserer, adferd, masker \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: smitte, spre, sprer, munnbind, beskytte, videre, smitten, spredning, nettopp, hindre, dermed, hindrer, unng, srlig, grad, fare, mennesker, poenget, smitter, srbare \n \t \t Marginal FREX: spre, hindrer, sprer, beskytte, begrense, spredning, videre, forhindre, adferd, hindre, definisjon, smitte, dermed, stopper, bidrar, egoister, andres, redusert, srbare, reduserer \n \t \t Marginal Lift: adferd, barnets, hindrer, frasen, definisjon, hamster, egoister, nedfelt, kjennetegn, spre, hensynsls, rasjonelt, redsel, forhindre, fengslene, akseptert, luftbren, sprer, ukontrollert, nettop \n \t \t Marginal Score: smitte, spre, sprer, beskytte, videre, spredning, smitten, munnbind, hindrer, hindre, dermed, unng, fare, grad, srlig, nettopp, begrense, poenget, srbare, smittespredning \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: smitte, munnbind, samfunnet, ansatte, jobber, smitten, avstand, pne, helsevesenet, unng, stenge, ndvendig, kontakt, helsepersonell, steder, viktig, tett, spredning, offentlig, beskytte \n \t \t Marginal FREX: avstand, munnbind, smittespredning, sosial, masker, begrense, srbare, smitte, unng, stenges, hindre, helsetjenesten, beskytte, redusere, fengsel, smitten, smittespredningen, meters, spredning, pbud \n \t \t Marginal Lift: basty, minimumstall, friomsorgen, smittestatistikk, kriminalomsorgen, coronawontbeneglected, mahkumayirmiyor, finnmarkssykehuset, kirurgiske, hjelpepleiere, hjemmetjeneste, hjemmetjenestene, barneidretten, butikkansatte, transportmidler, bpa, betjeningen, smittevernmessig, ventilerte, helsefagarbeidere \n \t \t Marginal Score: smitte, munnbind, samfunnet, ansatte, jobber, avstand, smitten, pne, unng, helsevesenet, stenge, ndvendig, kontakt, helsepersonell, steder, spredning, tett, beskytte, srbare, offentlig \nTopic 29: \n \t Marginal Highest Prob: stor, feil, ganske, virker, strre, finnes, vanskelig, spesielt, fall, eks, svrt, forskning, liten, stort, org, ulike, long_covid, srlig, effekt, ofte \n \t Marginal FREX: long_covid, studier, forskning, org, studien, bevis, forvente, rolle, generell, fakta, syn, ulike, case, pstanden, leser, effekter, forskningen, vitenskapelig, usikkerhet, bildet \n \t Marginal Lift: kampkomiteen, healthfeedback, motdemonstrantene, preprints, korrelert, estimatet, publikasjonen, worldbank, moba, tilgjengeligheten, pilene, lvermectin, outlier, hankjnn, fagomrder, superenkel, print, ordskifte, matematikken, garderober \n \t Marginal Score: stor, feil, ganske, virker, strre, finnes, vanskelig, forskning, spesielt, eks, liten, org, long_covid, svrt, fall, ulike, stort, effekt, srlig, grad \n \n \t Topic Kappa: vitenskapelig, preprint, fagfellevurderte, helseforsvar, fagfellevurdering, faktasjekker, scenarioene, studien, brownstone, science, hypoteser, bmj, pstanden, worst, motbevise, fagfellevurdert, postvirale, pnas, bevis, politikkens \n \t Kappa with Baseline: forskning, long_covid, org, studien, fakta, studier, basert, bevis, data, vist, ulike, vitenskapelig, kilder, pstander, leser, kunnskap, pstanden, effekt, pstr, syn \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: forskning, fakta, long_covid, basert, org, data, studien, finner, effekt, virker, studier, ulike, kjent, interessant, bevis, kunnskap, veldig, vist, lest, vitenskap \n \t \t Marginal FREX: studien, vitenskapelig, bevis, studier, bmj, pstanden, long_covid, pstander, vitenskapelige, vitenskap, science, case, studiene, forskning, fakta, viten, vist, wikipedia, pstr, ukritisk \n \t \t Marginal Lift: needed, understtter, virale, whos, holocaust, udokumenterte, trolling, avfeid, bmj, vitenskapelig, faktasjekker, scenarioene, ukritisk, science, treaty, preprint, uinformert, metaanalyse, usannsynlige, syndromer \n \t \t Marginal Score: forskning, fakta, long_covid, basert, org, studien, studier, data, finner, bevis, effekt, ulike, vist, vitenskap, interessant, pstander, vitenskapelig, lest, kunnskap, kjent \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: stor, feil, ganske, virker, strre, finnes, vanskelig, spesielt, fall, eks, svrt, liten, stort, forskning, org, srlig, ulike, effekt, long_covid, ofte \n \t \t Marginal FREX: effekt, long_covid, studier, feil, grad, org, forskning, basert, grunnlag, enige, argument, syn, kvinner, studien, dokumentasjon, forvente, antar, menn, bevis, generell \n \t \t Marginal Lift: kampkomiteen, healthfeedback, motdemonstrantene, preprints, korrelert, estimatet, publikasjonen, worldbank, moba, tilgjengeligheten, pilene, lvermectin, outlier, hankjnn, fagomrder, superenkel, print, ordskifte, matematikken, garderober \n \t \t Marginal Score: stor, feil, ganske, virker, strre, finnes, spesielt, vanskelig, eks, forskning, liten, org, fall, svrt, effekt, ulike, long_covid, stort, srlig, ofte \nTopic 30: \n \t Marginal Highest Prob: covid, kommer, lurer, gtt, likevel, gitt, usikker, klart, lang, skjer, nesten, tenker, tro, klar, lurt, faktisk, samtidig, kommet, finnes, personar \n \t Marginal FREX: lurer, kommer, covid, usikker, gitt, likevel, gtt, lang, klart, personar, skjer, nesten, lurt, smittekjelde, tenker, tro, kommet, klar, verste, alderen \n \t Marginal Lift: smittekjelde, utanlandsreise, personar, usikker, lurer, covid, kommer, ukjend, gtt, likevel, gitt, nrkontaktar, lang, alderen, klart, skjer, lurt, in, nesten, verste \n \t Marginal Score: covid, kommer, lurer, gtt, usikker, likevel, gitt, klart, lang, skjer, nesten, personar, tenker, tro, lurt, faktisk, finnes, klar, smittekjelde, kommet \n \n \t Topic Kappa: kommer, klart, lang, lurer, nesten, likevel, covid, skjer, lurt, kommet, sa, gitt, fall, rart, trenger, plass, sette, tanke, enkelt, selvflgelig \n \t Kappa with Baseline: covid, kommer, klart, nesten, lang, lurer, likevel, skjer, sa, trenger, gitt, bedre, kommet, fall, lurt, viktig, rart \n \n \t Covariate misinfo: \n \t \t Marginal Highest Prob: covid, kommer, tro, nesten, faktisk, finnes, lenge, klart, lurer, likevel, lurt, sant, mennesker, lang, skjer, allerede, lenger, rart, sa, fall \n \t \t Marginal FREX: tro, nesten, kommer, faktisk, klart, covid, lurt, lurer, lenge, finnes, likevel, lang, sant, skjer, allerede, lenger, rart, fall, sa, mennesker \n \t \t Marginal Lift: tro, lurt, nesten, finnes, sant, faktisk, lurer, klart, kommer, likevel, lenge, lang, covid, rart, skjer, lenger, allerede, gitt, fall, mennesker \n \t \t Marginal Score: covid, tro, kommer, nesten, faktisk, finnes, klart, lenge, lurer, lurt, likevel, sant, lang, skjer, allerede, lenger, mennesker, rart, sa, fall \n \t Covariate non.misinfo: \n \t \t Marginal Highest Prob: covid, kommer, lurer, gtt, gitt, likevel, usikker, klart, lang, skjer, tenker, nesten, klar, samtidig, personar, kommet, verste, lurt, tidligere, sa \n \t \t Marginal FREX: covid, lurer, kommer, usikker, gitt, gtt, likevel, personar, lang, klart, skjer, smittekjelde, tenker, nesten, lurt, verste, kommet, klar, alderen, samtidig \n \t \t Marginal Lift: smittekjelde, utanlandsreise, personar, usikker, lurer, covid, kommer, ukjend, gtt, likevel, gitt, nrkontaktar, lang, alderen, klart, skjer, in, lurt, verste, klar \n \t \t Marginal Score: covid, kommer, lurer, gtt, usikker, likevel, gitt, lang, klart, skjer, personar, tenker, nesten, klar, smittekjelde, alderen, kommet, samtidig, verste, lurt \n\n\n# file: sentiments.R\nlibrary(tidyverse)\nlibrary(tidytext)\nlibrary(tm)\n\nno_negative <- read.csv(\"https://github.com/ltgoslo/norsentlex/raw/master/Fullform/Fullform_Negative_lexicon.txt\", header = FALSE, fileEncoding = \"UTF-8\")\nno_positive <- read.csv(\"https://github.com/ltgoslo/norsentlex/raw/master/Fullform/Fullform_Positive_lexicon.txt\", header = FALSE, fileEncoding = \"UTF-8\")\nnames(no_negative) <- \"word\"\nnames(no_positive) <- \"word\"\n\ntwitter_sent <- readRDS(\"D:/Data/Datasets/CADS_datasets/twitter_topics_30.RDS\")\n\n# twitter_count <- twitter_sent |>\n#   group_by(topic) |>\n#   count(topic)\n\n################################################################################\n## overall score for each topic\n\n# Define negation words\nnegation_words <- c(\"ikke\", \"aldri\")\n\ntidy_twitter_neg <- twitter_sent |>\n  group_by(topic) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_neg <- tidy_twitter_neg |>\n  count(topic, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_neg |>\n              group_by(topic) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = \"topic\") |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsentiment_scores_neg$topic <- gsub(\"Topic\", \"\", sentiment_scores_neg$topic)\nsentiment_scores_neg$topic <- as.numeric(sentiment_scores_neg$topic)\n\nsentiment_scores_neg |>\n  ggplot(aes(x = topic, y = sentiment_score)) +\n  geom_col() +\n  labs(title = \"Sentiment Scores for Norwegian COVID-19 Tweets\",\n       x = \"Topic\", \n       y = \"Sentiment Score\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nsentiment_scores_neg$sentiment_score <- format(sentiment_scores_neg$sentiment_score, scientific = FALSE)\n\nwrite.csv2(sentiment_scores_neg, \"~/CADS/Results/sentiment_scores_30_avg_neg.csv\")\n\n################################################################################\n## Sent score grouped by label\n\ntidy_twitter_label<- twitter_sent |>\n  group_by(topic, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_label <- tidy_twitter_label |>\n  count(topic, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_label |>\n              group_by(topic, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsentiment_scores_label$topic <- gsub(\"Topic\", \"\", sentiment_scores_label$topic)\nsentiment_scores_label$topic <- as.numeric(sentiment_scores_label$topic)\n\nsentiment_scores_label$sentiment_score <- format(sentiment_scores_label$sentiment_score, scientific = FALSE)\n\nwrite.csv2(sentiment_scores_label, \"~/CADS/Results/sentiment_scores_30_label.csv\")\n\n################################################################################\n## timeline per topic\n\ntwitter_sent$label <- case_when(\n  twitter_sent$label == \"non.misinfo\" ~\"non misinformation\",\n  twitter_sent$label == \"misinfo\" ~\"misinformation\"\n)\n\ntwitter_sent$quarter <- quarter(twitter_sent$date, with_year = TRUE)\n\ntwitter_4 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic4\")\n\ntidy_twitter_4 <- twitter_4 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_4 <- tidy_twitter_4 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_4 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_4 <- sentiment_scores_4 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.6, 0.15)) +\n  labs(title = \"\",\n       subtitle = \"4: American Politics\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12))\n\ntwitter_6 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic6\")\n\ntidy_twitter_6 <- twitter_6 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_6 <- tidy_twitter_6 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_6 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_6 <- sentiment_scores_6 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.6, 0.15)) +\n  labs(title =\"\",\n       subtitle = \"6: Economy and Finance\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), legend.position = \"none\",\n        plot.subtitle = element_text(size = 12))\n\ntwitter_13 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic13\")\n\ntidy_twitter_13 <- twitter_13 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_13 <- tidy_twitter_13 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_13 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_13 <- sentiment_scores_13 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.6, 0.15)) +\n  labs(title =\"\",\n       subtitle = \"13: International News\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), legend.position = \"none\",\n        plot.subtitle = element_text(size = 12))\n\ntwitter_18 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic18\")\n\ntidy_twitter_18 <- twitter_18 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_18 <- tidy_twitter_18 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_18 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_18 <- sentiment_scores_18 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.6, 0.15)) +\n  labs(title =\"\",\n       subtitle = \"18: International Politics\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), legend.position = \"none\",\n        plot.subtitle = element_text(size = 12))\n\n################################################################################\ntwitter_1 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic1\")\n\ntidy_twitter_1 <- twitter_1 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_1 <- tidy_twitter_1 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_1 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_1 <- sentiment_scores_1 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.4,0.3)) +\n  labs(title = \"\",\n       subtitle = \"1: Characteristics of the Virus\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12),\n        plot.subtitle = element_text(size = 12))\n\ntwitter_2 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic2\")\n\ntidy_twitter_2 <- twitter_2 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_2 <- tidy_twitter_2 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_2 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_2 <- sentiment_scores_2 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.4,0.3)) +\n  labs(title =\"\",\n       subtitle = \"2: Dangerous Vaccines and Side Effects\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), legend.position = \"none\",\n        plot.subtitle = element_text(size = 12))\n\ntwitter_12 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic12\")\n\ntidy_twitter_12 <- twitter_12 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_12 <- tidy_twitter_12 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_12 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_12 <- sentiment_scores_12 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.4,0.3)) +\n  labs(title =\"\",\n       subtitle = \"12: Mortality Rates and Vaccination Efforts\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), legend.position = \"none\",\n        plot.subtitle = element_text(size = 12))\n\ntwitter_17 <- twitter_sent |>\n  select(tweet, id, quarter, label, topic, topic_value) |>\n  filter(topic == \"Topic17\")\n\ntidy_twitter_17 <- twitter_17 |>\n  group_by(topic, quarter, label) |>\n  unnest_tokens(word, tweet) |>\n  mutate(\n    sentiment = case_when(\n      word %in% no_positive$word & lag(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & lead(word) %in% negation_words ~ \"negative\",\n      word %in% no_positive$word & !(lag(word) %in% negation_words) ~ \"positive\",\n      word %in% no_positive$word & !(lead(word) %in% negation_words) ~ \"positive\",\n      \n      word %in% no_negative$word & lag(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & lead(word) %in% negation_words ~ \"positive\",\n      word %in% no_negative$word & !(lag(word) %in% negation_words) ~ \"negative\",\n      word %in% no_negative$word & !(lead(word) %in% negation_words) ~ \"negative\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(sentiment))\n\nsentiment_scores_17 <- tidy_twitter_17 |>\n  count(topic, quarter, sentiment) |>\n  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>\n  left_join(tidy_twitter_17 |>\n              group_by(topic, quarter, label) |>\n              summarize(total_words = n(), .groups = \"drop\"),\n            by = c(\"topic\", \"quarter\", \"label\")) |>\n  mutate(sentiment_score = (positive - negative) / total_words)\n\nsent_17 <- sentiment_scores_17 |>\n  ggplot(aes(x = as.factor(quarter), y = sentiment_score, group = label, color = label)) +\n  geom_line(linewidth = 2) +\n  scale_y_continuous(limits = c(-0.4,0.3)) +\n  labs(title =\"\",\n       subtitle = \"17: General Vaccine Discussions\",\n       x = \"Quarter\",\n       y = \"Sentiment Score\",\n       color = \"Label\") +\n  scale_color_manual(values=c(\"#8c510a\", \"#d8b365\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12), legend.position = \"none\",\n        plot.subtitle = element_text(size = 12))"
  },
  {
    "title": "Utdanningsvariabel",
    "authors": "Therese Dokken",
    "language": "Stata",
    "data": "registerdata",
    "methods": [
      "bearbeiding"
    ],
    "themes": [
      "utdanning",
      "kategorisering"
    ],
    "description": "Lager bredere kategorier av fullf\u00f8rt utdanning",
    "folder": "utdanning-nus",
    "files": [
      "utdanning-nus/Utdanningsvariabel.do"
    ],
    "code": "# file: Utdanningsvariabel.do\n***************************************\r\n*  EDUCATION in a given calendar year, making broader categories and make variable with education at age 30\r\n***************************************\r\n*Completed education\r\n*Registerdata from SSB\r\n\r\n*merging education file with original file\r\nuse Prosjektnavn_analysefil\r\nmerge 1:1 w21_5590_lopenr_person using W21_5590_BU_UTD.dta\r\ndrop _merge\r\nrename bu* education*\r\nforeach var of varlist education* {\r\n    label variable `var' \"Educational level (NUS) 1.october given year\"\r\n}\r\nsave, replace\r\n\r\n\r\n*broader categories of education\r\n\t*include missing in first category\r\n\t*Include basic secondary education in first category as well\r\n\r\nforvalues i = 1997(1)2020 {\r\n\tgen education_level_`i' = substr(education_`i', 1, 1)\r\n\tdestring education_level_`i', replace\r\n\tlab var education_level_`i' \"Educational level  1.oct given year\"\r\n\tlabel values education_level_`i' educational_level\r\n}\r\n\r\n\r\n*Education at age 30\r\ngen education_30_cat =.\r\nlab var education_30_cat \"Category (4) of highest completed education at 30 years\"\r\nforvalues i = 1997(1)2020 {\r\n\treplace education_30_cat=education_level_`i' if  `i'==(birthyear + 30)\r\n}\r\nreplace education_30_cat = 0 if education_30_cat==0 | education_30_cat==1 | education_30_cat==2 | education_30_cat==3  | education_30_cat==.\r\nreplace education_30_cat = 1 if education_30_cat==4 | education_30_cat==5\r\nreplace education_30_cat = 2 if education_30_cat==6  \r\nreplace education_30_cat = 3 if education_30_cat==7 | education_30_cat==8\r\nlabel define education_30_catl 0 \"No secondary educ\"  1 \"Completed upper secondary school\" 2 \"Undergradtate level\" 3 \"Graduate/postgraduate level\" \r\nlabel values education_30_cat education_30_catl\r\n\r\nsave, replace"
  },
  {
    "title": "Harmonisering av kommunenumre 1990-2024",
    "authors": "Kristian Tvedt",
    "language": "R",
    "data": "kommunedata",
    "methods": [
      "bearbeiding"
    ],
    "themes": [
      "kommunestruktur"
    ],
    "description": "Bruker en koblingsn\u00f8kkel med historiske endringer i kommunestrukturen til \u00e5 harmonisere kommunenumre i valgt tidsperiode. Plotter s\u00e5 et kart over befolkningsendring i kommunene 1990-2023.",
    "folder": "harmonisering-kommuner",
    "files": [
      "harmonisering-kommuner/kommuner historisk koblingsn\u00f8kkel.R",
      "harmonisering-kommuner/koblingsnokkel_kommuneendringer_1990_2024.xlsx",
      "harmonisering-kommuner/kommuner2021_simplified.geojson"
    ],
    "code": "# file: kommuner historisk koblingsn\u00f8kkel.R\n# Form\u00e5l: Lage data om befolkningsutvikling i norske kommuner 1990-2023.\n# Kommunestrukturen har v\u00e6rt endret i perioden, og i denne analysen kan befolkningen sl\u00e5s sammen n\u00e5r kommunene sl\u00e5s sammen.\n# Om form\u00e5let i stedet var \u00e5 analysere politisk utvikling m\u00e5 alle sammensl\u00e5inger utelates.\n\n# devtools::unload(\"MASS\")\nlibrary(tidyverse)\nlibrary(rio)\n\n\n# 1. import koblingsn\u00f8kkel -----------------------------------------------------\nsetwd(\"~/Library/CloudStorage/OneDrive-OsloMet/R/Kommunedata\") # directory\nkey <- import(\"koblingsnokkel_kommuneendringer_1990_2024.xlsx\")\nstr(key)\n\n# mellom 1990 og 1994 var det sm\u00e5 endringer i kommunestrukturen, og i hovedsak ble bare sm\u00e5kommuner innlemmet i Arendal, Fredrikstad og Sarpsborg. \n# lager korresponderende kommunenumre for alle kommuner som er geografisk uendret siden 1990\n\n# prep koblingsn\u00f8kkel\n# trenger f\u00f8lgende info i koblingsn\u00f8kkel: gammel id, ny id, endringstidspunkt. \ndf_key <- key %>%\n  # velg tidsrom for endringer i kommunestruktur:\n  filter(maal_gyldig_fra %in% 1990:2023) %>%  # utelater 2024-endringer her\n  # filter(TypeOfChange %in% c(\"Sammensl\u00e5ing\", \"Kodeendring\")) %>%\n  mutate(id_gammel = as.character(id_gammel)) %>%  # kommunenummer som starter p\u00e5 0 m\u00e5 beholdes som de er\n  select(id_gammel, id_ny, endring_tid = maal_gyldig_fra, endring = TypeOfChange, kommune = maal_kommune, kommune_old = kilde_kommune)\n\n# prepare key\ndf_key_deling <- df_key %>% filter(endring %in% c(\"Deling\", \"Deling, sammensl\u00e5ing\"))  # i 2020 ble 6 kommuner delt, og 2 kommuner ble delt i 2017.\ndf_key <- df_key %>% filter(!endring %in% c(\"Navneendring\", \"Deling\", \"Deling, sammensl\u00e5ing\"))  # for \u00e5 gj\u00f8re dette riktig m\u00e5 disse utelates enn s\u00e5 lenge\n# navneendring er jo egentlig irrelevant -- det p\u00e5virker ikke befolkning eller id. \n# deling er mer komplekst -- her kan vi ikke lage tidsserier hvor det ser ut som kommunene har stupt i befolkningsst\u00f8rrelse. disse 8 m\u00e5 holdes utenfor\n\n# hvordan h\u00e5ndterer vi befolkningsvekst i kommuner som er sammensl\u00e5tt? forslag: se p\u00e5 endringer i mellomperioder (s\u00e6rlig f\u00f8r 2020-sammensl\u00e5inger).\n# dette burde v\u00e6re uproblematisk, siden kommunevalget var i 2019 og sammensl\u00e5inger skjedde 1.1.2020.\n\n\n\n# 2. import historisk befolkningsdata i kommuner -------------------------------\ndf <- import(\"~/Library/CloudStorage/OneDrive-OsloMet/R/Kommunedata/Historiske data/Befolkning kommuner 1990-2023.xlsx\")\n\n# split info i kolonnene\ndf <- df %>%\n  mutate(\n    id = str_extract(kommune, \"^\\\\d+\"),  # extract numerisk id i starten\n    tid = str_extract(kommune, \"\\\\d{4}-\\\\d{4}|-\\\\d{4}\"),  # extract numerisk tidsperiode i YYYY-YYYY format\n    kommune = str_replace(kommune, \"^\\\\d+\\\\s+\", \"\"),  # fjern id fra starten\n    kommune = str_replace(kommune, \"\\\\s*\\\\(\\\\d{4}-\\\\d{4}\\\\)$\", \"\"),  # fjern tidsperiode i parantes fra ende\n    kommune = str_replace(kommune, \"\\\\s*\\\\(-\\\\d{4}\\\\)$\", \"\"),  # fjern tidsperiode i parantes fra ende\n    kommune = str_replace_all(kommune, \"\\\\s*\\\\([^)]*\\\\)$\", \"\")  # fjern spor av tekst i paranteser\n  ) %>%\n  mutate(id = as.character(id)) %>% \n  relocate(tid, .after = kommune)\n\n# rens data -- dropp rader med bare 0\ndf <- df %>% \n  rowwise() %>%\n  filter(any(c_across(`1990`:`2023`) != 0)) %>%\n  ungroup()\n\n# rename pop-variabler (befolkning)\ndf <- df %>% \n  rename_with(~ paste0(\"pop_\", .), .cols = `1990`:`2023`) %>% \n  mutate(kommune_old = NA)  # lag tom variabel for \u00e5 gj\u00f8re datasett identiske med det transformerte datasettet\n\n# fiks tid i df\ndf <- df %>% mutate(tid = as.numeric(str_extract(tid, \"(\\\\d{4})$\")) + 1)  # -1991 would become 1992\n\n## Prinsipper: Iterasjon over \u00e5r (tid). I hvert steg vil vi 1) join ny id, og 2) reframe.\n# table(df$tid)\nsort(unique(na.omit(df$tid)))  # \u00e5r som itereres over\n\n\n\n# 3. merge befolkningsdata -----------------------------------------------------\n# koper dataframe: gj\u00f8r prosessen repeterbar\nagg_df <- df %>% \n  mutate(tid = ifelse(tid == 2024, 2020, tid))  # reset merger-tid for \u00e5 korrespondere med key (koblingsn\u00f8kkel)\n\n# sort(unique(na.omit(df$tid)))  # kommunens siste eksisterende tidspunkt + 1\n# sort(unique(na.omit(df_key$endring_tid)))  # \u00e5ret endring tredde i kraft\n\n#### iterasjon over \u00e5r (tid)\nfor (year in sort(unique(na.omit(df$tid)))) {\n\n  # steg 1: add id to merge on\n  agg_df <- agg_df %>%\n    select(-any_of(\"id_ny\")) %>%                      # fjern kolonnenid_ny hvis den eksisterer\n    left_join(df_key[df_key$endring_tid == year,],    # spesifiser \u00e5r (loopes over)\n              by = c(\"id\" = \"id_gammel\")) %>%         # join by kommunenummer f\u00f8r/etter\n    mutate(kommune = coalesce(kommune.y, kommune.x),  # navn p\u00e5 kommune er det nye navnet, kommune.y (joinet fra koblingsn\u00f8kkel). \n           kommune_old = coalesce(kommune_old.y, kommune_old.x),\n           .keep = \"unused\") %>%                   # kommuner uber\u00f8rt av endring dette \u00e5ret f\u00e5r beholde sitt gamle navn, kommune.x\n    relocate(id_ny, .after = id) %>% \n    relocate(starts_with(\"kommune\"), .after = id_ny)\n  \n  \n  # steg 2: grupper etter mapping-indikator & reframing\n  agg_df2 <- agg_df %>% \n    mutate(merge_group = if_else(endring_tid == year,     # \u00e5rsvariabel her.\n                                 coalesce(id_ny, id), NA_character_)) %>% \n    filter(!is.na(merge_group)) %>%          # kun ber\u00f8rte kommuner skal merges hvert \u00e5r\n    group_by(merge_group) %>%\n    reframe(\n      id = coalesce(id_ny),\n      kommune = coalesce(kommune),\n      kommune_old = paste(unique(na.omit(c(kommune_old))), collapse = \"/\"),  # splicer navn\n      tid = ifelse(is.na(tid), 0, max(tid)),  # valgte enheter b\u00f8r ha tidsinformasjon -- bare uber\u00f8rte kommuner mangler (hvis de er i datasettet settes det til 0)\n      across(pop_1990:pop_2023, ~sum(.x, na.rm = TRUE))) %>% \n    ungroup() %>% \n    select(-merge_group) %>%\n    unique()\n  \n  cat(\"Number of new units after merging:\", nrow(agg_df2), \"in year:\", year)\n  \n  # steg 3: legg sammen sammensl\u00e5tte og uber\u00f8rte rader (kommuner) i ny dataframe\n  agg_df2 <- agg_df %>%\n    filter(is.na(id_ny)) %>%\n    bind_rows(agg_df2) %>% \n    select(-c(id_ny, endring, endring_tid)) # disse kolonnene er tomme n\u00e5\n  \n  # output\n  paste0(\"Reframing eliminated \", nrow(agg_df) - nrow(agg_df2), \" rows\")\n  \n  # endrede rader:\n  print(anti_join(agg_df, agg_df2, \n                  by = intersect(names(agg_df), names(agg_df2))))\n  \n  # noen u\u00f8nskede duplikater som kan fjernes?:\n  print(paste(\"Duplicate rows in\", year, \":\", agg_df %>% group_by(id) %>% select(-tid, kommune_old) %>% duplicated() %>% table()))\n  \n  # reset prosessen f\u00f8r neste iterasjon\n  agg_df <- agg_df2\n}\n\n\n\n## siste del med oppvask -------------------------------------------------------\n# sjekk: duplikater som kan fjernes?\n# print(paste(\"Duplicate rows in\", year, agg_df %>% group_by(id) %>% select(-tid, kommune_old) %>% duplicated() %>% table()))  # count duplicates\nagg_df %>% \n  group_by_at(vars(-tid)) %>% \n  filter(n() > 1)  # 3 duplikat-kommuner\n\n# fjern duplikater (spesifikt de med missing tid\nagg_df <- agg_df %>%\n  arrange(is.na(tid)) %>%  \n  distinct(across(-tid), .keep_all = TRUE)\n\n## siste: merge nummer-endringer i 2020\nagg_df <- agg_df %>% \n  group_by(id) %>%\n  # en siste reframe\n  reframe(\n    kommune = coalesce(kommune),\n    kommune_old = paste(unique(na.omit(c(kommune_old))), collapse = \"/\"),  # splicer navn\n    tid = ifelse(is.na(tid), 0, max(tid)),      # n\u00e5 f\u00e5r alle enheter tid = 0, NAs kan droppes\n    across(pop_1990:pop_2023, ~sum(.x, na.rm = TRUE))) %>% \n  ungroup() %>% \n  unique() %>% \n  filter(!is.na(tid))\n\n# kontroller mot hele landets befolkning, hentet fra SSB\nsjekk_ssb <- tribble(\n  ~id, ~pop_1990, ~pop_1999, ~pop_2015, ~pop_2019, ~pop_2020,\n  \"Hele landet\", 4233116, 4445329, 5165802, 5328212, 5367580)\n\n# sjekk summen \nsjekk_agg_df <- agg_df %>% \n  summarise(across(pop_1990:pop_2023, ~sum(.x, na.rm = TRUE))) %>% \n  select(pop_1990, pop_1999, pop_2015, pop_2019, pop_2020) %>% \n  mutate(id = \"Resultat\")\n\nsjekk <- bind_rows(sjekk_agg_df, sjekk_ssb)  # avviket mellom resultatet og reelle SSB-tall er rundt 6700-8300 for mange\n\n# dropp 6 delte kommuner, inkl. Snillfjord og Stokke\nagg_df <- agg_df %>% \n  filter(pop_2023 > 0, \n         pop_1990 > 0)\n\n\n\n# 4. kontroll: antall riktige beregninger --------------------------------------\n# sjekk mot fasit 2023: \nfasit <- df %>%  # df er det originale datasettet med befolkningstall for alle historiske kommuner\n  filter(pop_2023>0) %>% \n  mutate(kontroll = pop_2023) \n\n# s\u00e5 sjekker vi befolkningen i de aggregerte/harmoniserte kommunene. \n# er befolkningen riktig summert i sammensl\u00e5tte kommuner?\nmatcher <- agg_df %>% \n  left_join(select(fasit, kontroll, id), by = \"id\", suffix = c(\"test\", \"fasit\")) %>% \n  arrange(id) %>% \n  mutate(kontroll = as.numeric(kontroll))\n\n# sjekk avvik mellom fasit og aggregerte tall\ntable(matcher$pop_2023 == matcher$kontroll, useNA = \"always\")  # 357 matcher, 0 NA (pga delte kommuner er utelatt!)\n\n# dvs. at ingen kommuner har blitt aggregert/splicet p\u00e5 en m\u00e5te som gir feil befolkningstall i 2020.\n# likevel er det et lite avvik p\u00e5 ca. 6-8k hvert \u00e5r, n\u00e5r en sjekker mot summen av kolonnene f\u00f8r merging (og SSBs befolkningsdata for hele landet)\n\n\n\n# 5. output --------------------------------------------------------------------\n\n# eksporter\nexport(agg_df, \"historisk_befolkning_kommuner2020.rds\")\n\n\n\n# 6. kart ----------------------------------------------------------------------\n# sjekk p\u00e5 kart: gir tallene mening?\nlibrary(tmap)  # kart\nlibrary(sf)    # import geodata\nlibrary(rmapshaper)  # reduserer filst\u00f8rrelse kart\noptions(scipen = 999)  # scientific notation penalty (ikke print typ 1e6)\n\n# shapes (sf objects) validitetssjekkes med st_is_valid og fikses med st_make_valid:\ntmap_options(check.and.fix = TRUE)  \n\n# kommunegrenser\nno_geo_municipalities <- st_read(\"kommuner2021_simplified.geojson\")\n\n# join borders to population data\ngeodata <- left_join(no_geo_municipalities, agg_df, by = c(\"Kommunenummer\" = \"id\"))\n\n# tmap_mode(\"view\") # Aktiver interaktiv plotting med leaflet: Layers can be turned on and off!\nttm() # toggles interactive on/off!\n\n# test plotting\ntm_shape(shp = geodata) + \n  tm_borders() + \n  tm_polygons(col = c(\"pop_change90_20\"), palette = \"viridis\", alpha = 0.7,\n              popup.vars = c(\"Kommunenavn\", \"Befolkningsendring 1990-2020\" = \"pop_change90_20\"),\n              breaks = c(0, 0.6, 0.8, 1, 1.2, 1.4, 1.6, 1.8, 2, Inf)\n              ) +\n  tm_facets(as.layers = TRUE)"
  },
  {
    "title": "COVID-19 klassifikasjon av misinformasjon",
    "authors": "Siri Frisli",
    "language": "R",
    "data": "text corpus",
    "methods": [
      "API",
      "data wrangling",
      "maskinl\u00e6ring",
      "tekstklassifisering"
    ],
    "themes": [
      "sosiale medier",
      "covid",
      "misinformasjon"
    ],
    "description": "Henter og klargj\u00f8r Twitter data, og trener en semi-supervised self-training klassifiaksjonsmodell for \u00e5 gjenkjenne misinformasjon. Les mer her: https://doi.org/10.1007/s42001-025-00367-x",
    "folder": "SSST-covid-classify-misinfo",
    "files": [
      "SSST-covid-classify-misinfo/README.md",
      "SSST-covid-classify-misinfo/Scrapers",
      "SSST-covid-classify-misinfo/anms.xlsx",
      "SSST-covid-classify-misinfo/Classification",
      "SSST-covid-classify-misinfo/Analysis",
      "SSST-covid-classify-misinfo/Processing"
    ],
    "code": "# file: README.md"
  },
  {
    "title": "Migrasjonsstr\u00f8mmer via Eurostats API",
    "authors": [
      "Kristian Tvedt"
    ],
    "language": "R",
    "data": [
      "administrative data"
    ],
    "themes": [
      "innvandring",
      "migrasjonsstr\u00f8mmer"
    ],
    "methods": [
      "API",
      "data wrangling"
    ],
    "description": "Henter og vasker ulike data om asylankomster via Eurostats API. Data er brukt i GOVREIN-prosjektet. Les mer her: https://oda.oslomet.no/oda-xmlui/handle/11250/3112660",
    "folder": "migration-eurostat-api",
    "files": [
      "migration-eurostat-api/1_load_flowdata_annual.R",
      "migration-eurostat-api/2_load_data_temporaryprotection_Ukraine.R",
      "migration-eurostat-api/4_protection status_annual.R"
    ],
    "code": "# file: 1_load_flowdata_annual.R\n# 1. load annual flow data: APPLICATIONS LODGED --------------------------------\n\n# load data --------------------------------------------------------------------\nlibrary(rio)\nlibrary(eurostat)\nlibrary(tidyverse)\nasylum_y <- get_eurostat(\"migr_asyappctza\", # not including temp protection!\n                         time_format = \"num\")\nskim(asylum_y)\n# clean data\nannual_applications <- asylum_y %>%\n  filter(values > 0) %>% \n  dplyr::rename(origin = citizen,\n                destination = geo, \n                time = TIME_PERIOD) %>% \n  \n  # create labels for the following vars:\n  mutate(asyl_app = factor(asyl_app,\n                           levels = c(\"ASY_APP\", \"NASY_APP\", \"SSEQ\"),\n                           labels = c(\"All asylum applicants\", \"First-time applicants\", \"Subsequent asylum applicants\")), \n         age = factor(age, \n                      levels = c(\"TOTAL\", \"Y_LT14\", \"Y14-17\", \"Y_LT18\", \"Y18-34\", \"Y35-64\", \"Y_GE65\", \"UNK\"),\n                      labels = c(\"All\", \"Under 14\", \"14-17\", \"Under 18\", \"18-34\", \"35-64\", \"65 and over\", \"Unknown\"),\n                      ordered = TRUE),\n         gender = factor(sex,\n                      levels = c(\"F\", \"M\", \"T\", \"UNK\"),\n                      labels = c(\"Female\", \"Male\", \"All\", \"Unknown\")),\n         unit = NULL)\n\n# add country names ------------------------------------------------------------\nlibrary(countrycode)\n# all won't match, add the country names manually:\ncustom_mapping <- data.frame(\n  code = c(\"EL\", \"EU27_2020\", \"EU28\", \"EXT_EU27_2020\", \"EXT_EU28\", \"STLS\", \"TOTAL\", \"Total\", \"UK\", \"UK_OCT\", \"UNK\", \"XK\"),\n  name = c(\"Greece\", \"EU27 (from 2020)\", \"EU28\", \"Extra-EU27 (from 2020)\", \"Extra-EU28\", \"Statistical territories\", \"Total\", \"Total\", \"United Kingdom\", \"UK (October)\", \"Unknown\", \"Kosovo\"))\n\n## annual asylum data ----------------------------------------------------------\n# add full names to data\nannual_applications <- annual_applications %>%\n  mutate(origin_country = ifelse(annual_applications$origin %in% custom_mapping$code,\n                                 custom_mapping$name[match(annual_applications$origin, custom_mapping$code)], \n                                 countrycode(annual_applications$origin, origin = \"iso2c\", destination = \"country.name\")),\n         destination_country = ifelse(annual_applications$destination %in% custom_mapping$code,\n                                      custom_mapping$name[match(annual_applications$destination, custom_mapping$code)], \n                                      countrycode(annual_applications$destination, origin = \"iso2c\", destination = \"country.name\")))\n\n## filter asylum data to relevant countries ------------------------------------\nannual_applications <- annual_applications %>% \n  # filter(destination %in% c(\"NO\", \"SE\", \"DK\", \"FI\", \"PL\", \"AT\", \"UK\", \"DE\")) %>% \n  mutate(destination = factor(destination),\n         destination_country = factor(destination_country),\n         origin = factor(origin),\n         origin_country = factor(origin_country))\n\n# export data\nsetwd(\"~/Library/CloudStorage/OneDrive-OsloMet/R/GOVREIN/Eurostat GOVREIN/API output data\")\nrio::export(annual_applications, file = \"flowdata_annual.RData\")\n\n\n\n# file: 2_load_data_temporaryprotection_Ukraine.R\n# 2. Ukrainians: Temporary Protection Directive\n\n# load packages\nlibrary(eurostat)\nlibrary(tidyverse)\nlibrary(skimr)\nlibrary(countrycode)\n\n# find data id\nsearch_eurostat(\"Decisions granting temporary protection\")\n\n# refugees from Ukraine 2022: Temporary protection (annual) -------------------- \n# need annual aggregated data for 2022, as the monthly data is way off\ndata_Ukraine2022 <- get_eurostat(\"migr_asytpfa\", time_format = \"num\")\n\ndata_Ukraine2022 <- data_Ukraine2022 %>% \n  filter(values > 0) %>% \n  dplyr::rename(destination = geo, \n                origin = citizen) %>% \n  # create labels for the following vars:\n  mutate(age = factor(age, \n                      levels = c(\"TOTAL\", \"Y_LT14\", \"Y14-17\", \"Y_LT18\", \"Y18-34\", \"Y35-64\", \"Y_GE65\", \"UNK\"),\n                      labels = c(\"All\", \"Under 14\", \"14-17\", \"Under 18\", \"18-34\", \"35-64\", \"65 and over\", \"Unknown\"),\n                      ordered = TRUE),\n         gender = factor(sex,\n                         levels = c(\"F\", \"M\", \"T\", \"UNK\"),\n                         labels = c(\"Female\", \"Male\", \"All\", \"Unknown\")),\n         unit = NULL) %>% \n  mutate(decision = \"Temporary protection\")\n\n# custom names\ndata_Ukraine2022 <- data_Ukraine2022 %>% \n  mutate(origin_country = ifelse(data_Ukraine2022$origin %in% custom_mapping$code,\n                                 custom_mapping$name[match(data_Ukraine2022$origin, custom_mapping$code)], \n                                 countrycode(data_Ukraine2022$origin, origin = \"iso2c\", destination = \"country.name\")),\n         destination_country = ifelse(data_Ukraine2022$destination %in% custom_mapping$code,\n                                      custom_mapping$name[match(data_Ukraine2022$destination, custom_mapping$code)], \n                                      countrycode(data_Ukraine2022$destination, origin = \"iso2c\", destination = \"country.name\"))) %>% \n  mutate(origin = origin_country, \n         destination = destination_country) %>% \n  select(-c(sex))\n\n# rename time variable after Eurostat API update\ndata_Ukraine2022 <- data_Ukraine2022 %>% rename(time = TIME_PERIOD)\nskim(data_Ukraine2022)\n\n# refugees from Ukraine 2023: Temporary protection (monthly) --------------------\n# get data\ndata_Ukraine <- get_eurostat(\"migr_asytpfm\", \n                             time_format = \"date\")\n\n# clean data\ndata2 <- data_Ukraine %>%\n  filter(values > 0) %>% \n  dplyr::rename(destination = geo, \n                origin = citizen) %>% \n  \n  # create labels for the following vars:\n  mutate(age = factor(age, \n                      levels = c(\"TOTAL\", \"Y_LT14\", \"Y14-17\", \"Y_LT18\", \"Y18-34\", \"Y35-64\", \"Y_GE65\", \"UNK\"),\n                      labels = c(\"All\", \"Under 14\", \"14-17\", \"Under 18\", \"18-34\", \"35-64\", \"65 and over\", \"Unknown\"),\n                      ordered = TRUE),\n         gender = factor(sex,\n                      levels = c(\"F\", \"M\", \"T\", \"UNK\"),\n                      labels = c(\"Female\", \"Male\", \"All\", \"Unknown\")),\n         unit = NULL) %>% \n  mutate(decision = \"Temporary protection\") # all rows in this dataframe are on temporary protection for Ukrainians\n\n\n# add country names from custom_mapping (created in 1_load_flowdata_annual)\ndata2 <- data2 %>% \n  mutate(origin_country = ifelse(data2$origin %in% custom_mapping$code,\n                                 custom_mapping$name[match(data2$origin, custom_mapping$code)], \n                                 countrycode(data2$origin, origin = \"iso2c\", destination = \"country.name\")),\n         destination_country = ifelse(data2$destination %in% custom_mapping$code,\n                                      custom_mapping$name[match(data2$destination, custom_mapping$code)], \n                                      countrycode(data2$destination, origin = \"iso2c\", destination = \"country.name\")))\n\n# rename TIME\ndata2 <- data2 %>% rename(time = TIME_PERIOD)\n\n# filter 2023 Jan-Dec!!\ndata2 <- data2 %>% \n  filter(time >= as.Date(\"2023-01-01\") & \n           time <= as.Date(\"2023-12-30\"))\n\n\n# ANNUAL: merge Ukraine data with other asylum datasets ----------------------------------------------------\n# 1: recode time into annual Ukraine data before merging with other asylum data\nlibrary(lubridate)\nstr(data2)\n# convert 'time' to year and aggregate 'values' by year in data2\ndata2_annual <- data2 %>% \n  mutate(time = year(time)) %>%\n  group_by(origin, gender, age, destination, time, origin_country, destination_country, decision) %>%\n  summarise(values = sum(values, na.rm = TRUE), .groups = \"drop\") %>% \n  mutate(origin = origin_country, \n         destination = destination_country) %>% \n  filter(time == 2023) # remove 2022 data, which is wrong\n\n## checks out: 147 500 to Germany Jan-Jun 2023.\ndata2_annual %>% \n  filter(destination == \"Germany\", origin == \"Total\",\n         age == \"All\", gender ==\"All\")\n\n# rbind 2022 and 2023\ndata_Ukraine2022$freq <- NULL\ndata2_annual <- rbind(data2_annual, data_Ukraine2022)\n\n# export data\nsetwd(\"~/Library/CloudStorage/OneDrive-OsloMet/R/GOVREIN/Eurostat GOVREIN/API output data\")\nexport(data2_annual, file = \"UKR_tempdata_annual.RData\")\n\n\n\n\n\n# file: 4_protection status_annual.R\n# 4. PROTECTION DECISIONS: \n# First instance decisions - 4 types of protection status grants ---------------\n\n# read data directly from the eurostat package\nlibrary(eurostat)\nlibrary(tidyverse)\n\nids <- search_eurostat(\"decisions on applications\")\n# first instance decisions: 4 types of protection status grants\nasylum_protectionstatus <- get_eurostat(\"migr_asydcfsta\", \n                              time_format = \"num\")\n\n# clean data -------------------------------------------------------------------\ndata <- asylum_protectionstatus %>%\n  filter(values > 0) %>% \n  dplyr::rename(origin = citizen,\n                destination = geo) %>% \n  \n  # create labels for the following vars:\n  mutate(decision = factor(decision,\n                           levels = c(\"TOTAL\", \"TOTAL_POS\", \"GENCONV\", \"HUMSTAT\", \"SUB_PROT\", \"REJECTED\"),\n                           labels = c(\"Total\", \"Total positive decisions\", \"Geneva Convention status\", \"Humanitarian status\", \"Subsidiary protection status\", \"Rejected\")), \n         age = factor(age, \n                      levels = c(\"TOTAL\", \"Y_LT14\", \"Y14-17\", \"Y_LT18\", \"Y18-34\", \"Y35-64\", \"Y_GE65\", \"UNK\"),\n                      labels = c(\"All\", \"Under 14\", \"14-17\", \"Under 18\", \"18-34\", \"35-64\", \"65 and over\", \"Unknown\"),\n                      ordered = TRUE),\n         gender = factor(sex,\n                      levels = c(\"T\", \"F\", \"M\", \"UNK\"),\n                      labels = c(\"All\", \"Female\", \"Male\", \"Unknown\")),\n         unit = NULL, sex = NULL)\n\n# print(object.size(asylum_protectionstatus), units = \"MB\") # 1076 MB\n# print(object.size(data), units = \"MB\") # 54 MB\n\n\n# add country names ---------------------------------------------------------------------------------\nlibrary(countrycode)\n# all won't match, add the country names manually:\ncustom_mapping <- data.frame(\n  code = c(\"EL\", \"EU27_2020\", \"EU28\", \"EXT_EU27_2020\", \"EXT_EU28\", \"STLS\", \"TOTAL\", \"UK\", \"UK_OCT\", \"UNK\", \"XK\"),\n  name = c(\"Greece\", \"EU27 (from 2020)\", \"EU28\", \"Extra-EU27 (from 2020)\", \"Extra-EU28\", \"Statistical territories\", \"Total\", \"United Kingdom\", \"UK (October)\", \"Unknown\", \"Kosovo\"))\n\n## annual asylum data -------------------------------------------------------------------------------\n# add full names to data. the following code will produce warnings -- not error, unless warning settings are triggered. reset the settings: \n# options(warn = 0) # reset warnings settings if necessary\ndata <- data %>%\n  mutate(origin_country = ifelse(data$origin %in% custom_mapping$code,\n                                 custom_mapping$name[match(data$origin, custom_mapping$code)], \n                                 countrycode(data$origin, origin = \"iso2c\", destination = \"country.name\")),\n         destination_country = ifelse(data$destination %in% custom_mapping$code,\n                                      custom_mapping$name[match(data$destination, custom_mapping$code)], \n                                      countrycode(data$destination, origin = \"iso2c\", destination = \"country.name\")))\n\n\n\n\n\n# merge with data on temporary protection and resettled refugees ------------------------------------\ndata2_annual <- rio::import(\"UKR_tempdata_annual.RData\")\ndata_resettled <- rio::import(\"resettled_annual.RData\")\n\nannual_decisions <- bind_rows(data, \n                              data2_annual, # load_data_temporary_protection_Ukraine\n                              data_resettled) # load_data_resettledpersons\nskimr::skim(annual_decisions)\n# factorise\n# annual_decisions[,1:5] <- lapply(annual_decisions[,1:5], factor)\n\n# export merged annual data\nsetwd(\"~/Library/CloudStorage/OneDrive-OsloMet/R/GOVREIN/Eurostat GOVREIN/API output data\")\nrio::export(annual_decisions, file = \"MERGED_annual.RData\")"
  },
  {
    "title": "Spatial regression",
    "authors": [
      "Kristian Tvedt"
    ],
    "language": "R",
    "data": [
      "spatial data"
    ],
    "themes": [
      "spatial regression",
      "spatial autocorrelation"
    ],
    "methods": [
      "spatial error model",
      "spatial lag model"
    ],
    "description": "Identifiserer romlig autokorrelasjon i r\u00e5data og regresjonsresidualer. Spesifiserer og tester alternative modeller: SEM og SAR.",
    "folder": "spatial-regression",
    "files": [
      "spatial-regression/Data",
      "spatial-regression/spatial_regression.R"
    ],
    "code": "# file: spatial_regression.R\n# Spatial regression\n# test for spatial autocorrelation in ols residuals, and test alternative models: \n# spatial autoregressive (SAR) and spatial error models (SEM)\n\n# load packages\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(tmap)\nlibrary(GGally)\nlibrary(cartography)\nlibrary(RColorBrewer)\nlibrary(ggspatial)\nlibrary(spatialreg)\nlibrary(texreg)\nlibrary(spdep)\n\n# running slow? turn off spherical geometry,\n# sf::sf_use_s2(FALSE)\n\n# read data\ndf <- readRDS(\"Data/data_spatial_africa_mortality.rds\")\ndim(df)\n\n# check geometry\n# plot(st_geometry(df))  # will be slow due to detailed polygons\n\n# neighbours ---------------\n# Identify neighbors\ndf2 <- st_make_valid(df)\n\n# remove missing\ndf2 <- df2 %>%\n  filter(!is.na(nevents) & !is.na(u5mr))\n\n# construct list of neighbours from polygons\ndat_nb <- spdep::poly2nb(pl = df2,queen = TRUE)  # queen neighbours (one boundary point) \nsummary(dat_nb)  # descriptive statistics of neighbour list\nstr(dat_nb)\n\n# plot\nplot(st_geometry(df2), border=\"grey\") # plot sf and neighbors\n\n# plot map with the list of neighbours (dat_nb)\nplot(dat_nb, st_geometry(df2), add=TRUE)\n\n\n# create spatial weights for neighbours\ndat_listw_w <- spdep::nb2listw(neighbours = dat_nb, \n                               style = \"C\", # choose style: B, W, C etc?\n                               zero.policy = TRUE)\n\n# What's the global spatial autocorrelation? \n# run Moran's I on the variable under 5 mortality rate\nmoran.test(df2$u5mr, \n           listw = dat_listw_w, \n           zero.policy = TRUE, na.action = na.omit)\n# output: 0.85, far larger than the near-0 null expectation, tiny p-value.\n# conclusion: under-5 mortality rates are strongly positively spatially autocorrelated.\n\n# spatial autocorrelation ------------------------------------------------------\n# explore spatial autocorrelation using different neighbor definitions and variables\n\n\n# linear regression model ------------------------------------------------------\n# simple OLS model\nols1 <- lm(nevents ~ u5mr, data = df2)\n\n# plot the residuals (unexplained variance)\ndf2$residuals <- residuals(ols1)\ntm_shape(df2) + \n  tm_fill(col = \"residuals\", palette = \"RdBu\", n = 9) + \n  tm_layout(title = \"Residuals of OLS model: The effect of mortality rate on events\")\n# it looks like there's clear spatial autocorrelation in the residuals\n\n# test for spatial autocorrelation in the residuals\nlm.morantest(model = ols1, listw = dat_listw_w, zero.policy = TRUE)\n# Moran's I \u2248 0.176 >> expectation (-0.003), highly significant. \n# conclusion: the residuals are not randomly spatially distributed, and the OLS model misses the spatial data structure.\n\n\n# Spatial regression models ----------------------------------------------------\n# Spatial lag model\nsar.fit <- lagsarlm(nevents ~ u5mr, \n                    df2, listw = dat_listw_w, \n                    na.action = na.omit, zero.policy = TRUE)\n\n# Spatial error model\nsem.fit <- errorsarlm(nevents ~ u5mr, \n                      df2, listw = dat_listw_w, \n                      na.action = na.omit, zero.policy = TRUE)\n\nscreenreg(list(ols1, sar.fit, sem.fit)) # LR test\n\n\n# Explore the models ------------------------------------\nAIC(ols1, sar.fit, sem.fit)  # model fit is worse on OLS, similar on SAR and SEM \n\n# ols: fix assumptions before testing\ndat_listw_w <- spdep::nb2listw(dat_nb, style = \"W\", zero.policy = TRUE)\n# run tests\nlm.LMtests(model = ols1, listw = dat_listw_w, zero.policy = TRUE, test = c(\"LMerr\", \"LMlag\",\"RLMerr\", \"RLMlag\"))\n# conclusion: mixed dependence? both the simple lag and error tests are significant, but the robust ones are not.\n# the jury's out on whether a spatilal lag (SAR) or error model (SEM) make the best fit.\n\n# Assess impacts in spatial lag models -------------------------------------------------\nspatialreg::impacts(obj = sar.fit, listw = dat_listw_w) # direct: avg change in Y given 1 unit increase in X.\n\n# impacts:\n# Direct Impact (4.194185): This value represents the average change in the dependent variable (the number of events, nevents) \n# in a given location due to a one-unit change in the independent variable (under-5 mortality rate, u5mr), \n# holding the values of u5mr constant in all other locations.\n# In simpler terms, it's the impact that changes in the under-5 mortality rate \n# have on the number of events in the same area. The positive value indicates that as the under-5 mortality rate increases, \n# the number of events in that same location tends to increase.\n\n\n# Indirect Impact (Spillover Effect)\n# Indirect Impact (1.952575): This value quantifies the spillover effect or the impact of changing the under-5 mortality rate \n# in one location on the number of events in neighboring locations. It captures the spatial externalities or the influence that \n# a unit's characteristics have on neighboring units. The positive indirect impact suggests that an increase in the \n# under-5 mortality rate in one area not only affects that area but also leads to an increase in the number of events in surrounding areas.\n\n\n# Total Impact (6.146759): This is the sum of the direct and indirect impacts, representing the overall effect of a change \n# in the under-5 mortality rate on the number of events, accounting for both the local and neighboring effects. \n# The positive total impact indicates that, overall, higher under-5 mortality rates are associated with a higher number of events \n# across the study area, considering both direct and spillover effects."
  },
  {
    "title": "Lage excel-fil med gjennomsnittsverdier fra survey",
    "authors": "Kjersti Stabell Wiggen",
    "language": "Stata",
    "data": "surveydata",
    "methods": [
      "bearbeiding"
    ],
    "themes": [
      "surveydata"
    ],
    "description": "Lager excel-ark med gjennomsnitt og N for f.eks. Likert-sp\u00f8rsm\u00e5l i survey. Ogs\u00e5 fordelt p\u00e5 undergrupper som Fylke, kj\u00f8nn, alder osv",
    "folder": "lage-gjennomsnitt",
    "files": [
      "lage-gjennomsnitt/lage gjennomsnitt.do"
    ],
    "code": "# file: lage gjennomsnitt.do\n\r\n*************************************************\r\n\r\n* Lager excel-ark med gjennomsnittsverdi p\u00e5 alle likert-sp\u00f8rsm\u00e5l i en survey**\r\n\r\n*************************************************\r\n\r\n//Hent inn fil med surveyresultater\r\n\r\nuse \"datafil.dta\", clear\r\n\r\n// beholde kun de variablene du vil ha med\r\n\r\nkeep var1-var9\r\ndrop varx\r\n\r\n// Lager en id-variabel som vi bruker til \u00e5 telle\r\n// plasser den f\u00f8rst i datasettet\r\n\r\ngen utvalgn = _n\r\norder utvalgn, before(var1)\r\ngen N = 1\r\norder N, before(var1)\r\n\r\n// legg ev bakgrunnsvariabler f\u00f8rst, f.eks. hvis man \u00f8nsker fordelt p\u00e5 kj\u00f8nn, alder eller Fylke som her\r\norder Fylke, before (var1)\r\norder Kjonn, before (var1)\r\n\r\n** antall som har svart pr fylke\r\nbysort Fylke: egen antall_fylke = count(utvalgn)\r\ntab Fylke antall_fylke\r\n\r\n\r\n** antall som har svart pr kj\u00f8nn\r\nbysort Kjonn: egen antall_kjonn = count(utvalgn)\r\ntab Kjonn antall_kjonn\r\n\r\n\r\n** TOTAL **\r\npreserve\r\ncollapse (mean) s_* x_* \r\nexport excel \"gjennomsnitt.xlsx\", sheet(\"I alt\") firstrow(variables) sheetreplace\r\nrestore\r\n\r\n** Fylke **\r\npreserve\r\ncollapse (mean) s_* x_*, by (Fylke antall_fylke)\r\nexport excel \"gjennomsnitt.xlsx\", sheet(\"Fylke\") firstrow(variables) sheetreplace\r\nrestore\r\n\r\n\r\n** Kj\u00f8nn **\r\npreserve\r\ncollapse (mean) s_* x_*, by (Kjonn antall_kjonn)\r\nexport excel \"gjennomsnitt.xlsx\", sheet(\"Kj\u00f8nn\") firstrow(variables) sheetreplace\r\nrestore"
  },
  {
    "title": "When Do Voters Punish Corrupt Politicians? Evidence from a Field and Survey Experiment",
    "authors": [
      "Yuri Kasahara",
      "Miguel P. De Figueiredo",
      "F. Daniel Hidalgo"
    ],
    "language": "R",
    "data": "survey experiment",
    "methods": [
      "OLS"
    ],
    "themes": [
      "corruption",
      "party bias",
      "polarization"
    ],
    "description": "Les mer: https://doi.org/10.1017/S0007123421000727",
    "folder": "policies-make-politicians",
    "files": [
      "policies-make-politicians/SPexperiment_data.RData",
      "policies-make-politicians/replication_code.R",
      "policies-make-politicians/log_file.txt",
      "policies-make-politicians/codebook.pdf"
    ],
    "code": "# file: replication_code.R\n### This code replicates tables and figures in\n### \"When Do Voters Punish Corrupt Politicians? Evidence from a Field and Survey Experiment\"\n### By Miguel P. De Figueiredo, F. Daniel Hidalgo, and Yuri Kasahara\n###\n\n## Tables are produced in latex format\n## See bottom of script for R and package versions\n\n\nlibrary(reshape)\nlibrary(xtable)\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(reporttools)\nlibrary(estimatr)\n\n\nload(\"SPexperiment_data.RData\")\n\nblocked.ate <- function(y, treat, block) {\n  data <- data.frame(y, treat, block)\n  block.ate <- ddply(data, \"block\", summarise, block.ate = mean(y[treat == 1], na.rm = TRUE) - mean(y[treat == 0], na.rm = TRUE), block.wt = length(y))\n  block.ate$block.wt <- block.ate$block.wt / nrow(data)\n  ate <- sum(block.ate$block.ate * block.ate$block.wt)\n  ate\n}\n\n# Function to get heteroskedastically robust SE\nsummaryR.lm <- function(model, type = c(\"hc3\", \"hc0\", \"hc1\", \"hc2\", \"hc4\"), ...) {\n  if (!require(car)) stop(\"Required car package is missing.\")\n  type <- match.arg(type)\n  V <- hccm(model, type = type)\n  sumry <- summary(model)\n  table <- coef(sumry)\n  table[, 2] <- sqrt(diag(V))\n  table[, 3] <- table[, 1] / table[, 2]\n  table[, 4] <- 2 * pt(abs(table[, 3]), df.residual(model), lower.tail = FALSE)\n  sumry$coefficients <- table\n  p <- nrow(table)\n  hyp <- cbind(0, diag(p - 1))\n  sumry$fstatistic[1] <- linearHypothesis(model, hyp, white.adjust = type)[2, \"F\"]\n  sumry\n}\n\nblocked.se <- function(y, treat, block) {\n  data <- data.frame(y, treat, block)\n  block.var <- ddply(data, \"block\", summarise, block.var = (var(y[treat == 0], na.rm = TRUE) / (length(y) - sum(treat)) + var(y[treat == 1], na.rm = TRUE) / (sum(treat))), block.wt = length(y))\n  block.var$block.wt <- (block.var$block.wt)^2 / nrow(data)^2\n  var <- sum(block.var$block.var * block.var$block.wt)\n  sqrt(var)\n}\n\n\n\n\n#### Table 1 and 2\n\n\nmarta.results <- list()\nkassab.results <- list()\nmartakassab.results <- list()\nmarta.data$marta.pr <- marta.data$marta.pr * 100\nmarta.data$turnout <- marta.data$turnout * 100\nkassab.data$kassab.pr <- kassab.data$kassab.pr * 100\nkassab.data$turnout <- kassab.data$turnout * 100\nmarta.data$nulo.votes <- (marta.data$nulo.votes / marta.data$voters) * 100\nkassab.data$nulo.votes <- (kassab.data$nulo.votes / kassab.data$voters) * 100\nmarta.data$branco.votes <- (marta.data$branco.votes / marta.data$voters) * 100\nkassab.data$branco.votes <- (kassab.data$branco.votes / kassab.data$voters) * 100\nmarta.data$branconulo.votes <- marta.data$branco.votes + marta.data$nulo.votes\nkassab.data$branconulo.votes <- kassab.data$branco.votes + kassab.data$nulo.votes\ncovariates <- c(\"treat\", \"match.id\", \"pt.pref.04\", \"voters\")\n\n\n#\n### Adjusted Estimates\n##\n## Effect on Marta Vote Share with covariates\nmarta.results$lm.marta.pr.cov <- summaryR.lm(lm(as.formula(paste(\"marta.pr ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Kassab Vote Share with covariates\nkassab.results$lm.kassab.pr.cov <- summaryR.lm(lm(as.formula(paste(\"kassab.pr ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Turnout (of Marta flier) with Covariates\nmarta.results$lm.turnout.marta.cov <- summaryR.lm(lm(as.formula(paste(\"turnout ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Turnout (Kassab Flier) with Covariates\nkassab.results$lm.turnout.kassab.cov <- summaryR.lm(lm(as.formula(paste(\"turnout ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Nulos (Marta flier) with Covariates\nmarta.results$lm.nulo.cov <- summaryR.lm(lm(as.formula(paste(\"nulo.votes ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Nulos (Kassab flier) with Covariates\nkassab.results$lm.nulo.cov <- summaryR.lm(lm(as.formula(paste(\"nulo.votes ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Brancos (Marta flier) with Covariates\nmarta.results$lm.branco.cov <- summaryR.lm(lm(as.formula(paste(\"branco.votes ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n## Effect on Brancos (Kassab flier) with Covariates\nkassab.results$lm.branco.cov <- summaryR.lm(lm(as.formula(paste(\"branco.votes ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n\n\n##\n### Unadjusted Estimates\n##\n## Effect on Marta vote share\nmarta.results$itt.marta.pr[1] <- sum(tapply(marta.data$marta.pr[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$marta.pr[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\nmarta.results$itt.marta.pr[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$marta.pr[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$marta.pr[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.marta.pr[1])^2))\nmarta.results$itt.marta.pr[3] <- pt(marta.results$itt.marta.pr[1] / marta.results$itt.marta.pr[2], 99) * 2\n## Effect on Turnout (Marta Flier)\nmarta.results$itt.turnout[1] <- sum(tapply(marta.data$turnout[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$turnout[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\nmarta.results$itt.turnout[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$turnout[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$turnout[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.turnout[1])^2))\nmarta.results$itt.turnout[3] <- pt(marta.results$itt.turnout[1] / marta.results$itt.turnout[2], 99) * 2\n\n## Effect on Nulos (Marta Flier)\nmarta.results$itt.nulo.votes[1] <- sum(tapply(marta.data$nulo.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$nulo.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\nmarta.results$itt.nulo.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$nulo.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$nulo.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.nulo.votes[1])^2))\nmarta.results$itt.nulo.votes[3] <- pt(marta.results$itt.nulo.votes[1] / marta.results$itt.nulo.votes[2], 99) * 2\n## Effect on Brancos (Marta Flier)\nmarta.results$itt.branco.votes[1] <- sum(tapply(marta.data$branco.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$branco.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\nmarta.results$itt.branco.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$branco.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$branco.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.branco.votes[1])^2))\nmarta.results$itt.branco.votes[3] <- (1 - pt(marta.results$itt.branco.votes[1] / marta.results$itt.branco.votes[2], 99)) * 2\n\n## Effect on Kassab Vote Share\nkassab.results$itt.kassab.pr[1] <- sum(tapply(kassab.data$kassab.pr[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$kassab.pr[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\nkassab.results$itt.kassab.pr[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$kassab.pr[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$kassab.pr[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.kassab.pr[1])^2))\nkassab.results$itt.kassab.pr[3] <- (1 - pt(kassab.results$itt.kassab.pr[1] / kassab.results$itt.kassab.pr[2], 99)) * 2\n#### Effect on Turnout (Kassab Flier)\nkassab.results$itt.turnout[1] <- sum(tapply(kassab.data$turnout[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$turnout[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\nkassab.results$itt.turnout[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$turnout[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$turnout[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.turnout[1])^2))\nkassab.results$itt.turnout[3] <- (1 - pt(kassab.results$itt.turnout[1] / kassab.results$itt.turnout[2], 99)) * 2\n## Effect on Nulos (Kassab Flier)\nkassab.results$itt.nulo.votes[1] <- sum(tapply(kassab.data$nulo.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$nulo.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\nkassab.results$itt.nulo.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$nulo.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$nulo.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.nulo.votes[1])^2))\nkassab.results$itt.nulo.votes[3] <- pt(kassab.results$itt.nulo.votes[1] / kassab.results$itt.nulo.votes[2], 99) * 2\n## Effect on Brancos (Kassab Flier)\nkassab.results$itt.branco.votes[1] <- sum(tapply(kassab.data$branco.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$branco.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\nkassab.results$itt.branco.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$branco.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$branco.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.branco.votes[1])^2))\nkassab.results$itt.branco.votes[3] <- pt(kassab.results$itt.branco.votes[1] / kassab.results$itt.branco.votes[2], 99) * 2\n\n\n\nconf.int <- function(x) paste(\"[\", round(x[1] - 1.96 * x[2], digits = 1), \", \", round(x[1] + 1.96 * x[2], digits = 1), \"]\", sep = \"\")\n\noptions(scipen = 999)\n\nmarta.table <- cbind(\n  rbind(round(marta.results$itt.marta.pr[1], 1), round(marta.results$itt.marta.pr[2], 2), conf.int(marta.results$itt.marta.pr), round(marta.results$itt.marta.pr[3], 2)),\n  rbind(round(marta.results$lm.marta.pr.cov[1], 1), round(marta.results$lm.marta.pr.cov[2], 2), conf.int(marta.results$lm.marta.pr.cov), round(marta.results$lm.marta.pr.cov[4], 2)),\n  rbind(round(marta.results$itt.turnout[1], 1), round(marta.results$itt.turnout[2], 2), conf.int(marta.results$itt.turnout), round(marta.results$itt.turnout[3], 4)),\n  rbind(round(marta.results$lm.turnout.marta.cov[1], 1), round(marta.results$lm.turnout.marta.cov[2], 2), conf.int(marta.results$lm.turnout.marta.cov), round(marta.results$lm.turnout.marta.cov[4], 4)),\n  rbind(round(marta.results$itt.branco.votes[1], 2), round(marta.results$itt.branco.votes[2], 2), conf.int(marta.results$itt.branco.votes), round(marta.results$itt.branco.votes[3], 2)),\n  rbind(round(marta.results$lm.branco.cov[1], 2), round(marta.results$lm.branco.cov[2], 2), conf.int(marta.results$lm.branco.cov), round(marta.results$lm.branco.cov[4], 2))\n)\nmarta.table <- rbind(marta.table, c(\"\", \"X\", \"\", \"X\", \"\", \"X\"))\n\n\n\n# col.names <- c(\"\", \"\\\\multicolumn{2}{c}{Vote Share (\\\\%)}\", \"\\\\multicolumn{2}{c}{Turnout (\\\\%)}\", \"\\\\multicolumn{2}{c}{Spoiled Ballots (\\\\%)}\")\nrownames(marta.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \"P-value\", \"Covariates\")\nmarta.table <- xtable(marta.table, digits = 4)\nalign(marta.table) <- \"c|cccccc\"\n\nprint(marta.table, add.to.row = list(pos = list(0), command = c(\"& \\\\multicolumn{2}{c}{Vote Share (\\\\%)} &  \\\\multicolumn{2}{c}{Turnout (\\\\%)}  & \\\\multicolumn{2}{c}{Spoiled Ballots (\\\\%)} \\\\\\\\\")), include.colnames = FALSE, floating = TRUE)\n\n\n\nkassab.table <- cbind(\n  rbind(round(kassab.results$itt.kassab.pr[1], 1), round(kassab.results$itt.kassab.pr[2], 2), conf.int(kassab.results$itt.kassab.pr), round(kassab.results$itt.kassab.pr[3], 2)),\n  rbind(round(kassab.results$lm.kassab.pr.cov[1], 1), round(kassab.results$lm.kassab.pr.cov[2], 2), conf.int(kassab.results$lm.kassab.pr.cov), round(kassab.results$lm.kassab.pr.cov[4], 2)),\n  rbind(round(kassab.results$itt.turnout[1], 1), round(kassab.results$itt.turnout[2], 2), conf.int(kassab.results$itt.turnout), round(kassab.results$itt.turnout[3], 2)),\n  rbind(round(kassab.results$lm.turnout.kassab.cov[1], 1), round(kassab.results$lm.turnout.kassab.cov[2], 2), conf.int(kassab.results$lm.turnout.kassab.cov), round(kassab.results$lm.turnout.kassab.cov[4], 2)),\n  rbind(round(kassab.results$itt.branco.votes[1], 2), round(kassab.results$itt.branco.votes[2], 2), conf.int(kassab.results$itt.branco.votes), round(kassab.results$itt.branco.votes[3], 2)),\n  rbind(round(kassab.results$lm.branco.cov[1], 2), round(kassab.results$lm.branco.cov[2], 2), conf.int(kassab.results$lm.branco.cov), round(kassab.results$lm.branco.cov[4], 2))\n)\nkassab.table <- rbind(kassab.table, c(\"\", \"X\", \"\", \"X\", \"\", \"X\"))\nrownames(kassab.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \"P-value\", \"Covariates\")\nkassab.table <- xtable(kassab.table)\nalign(kassab.table) <- \"c|cccccc\"\n\nprint(kassab.table, add.to.row = list(pos = list(0), command = c(\"& \\\\multicolumn{2}{c}{Vote Share (\\\\%)} &  \\\\multicolumn{2}{c}{Turnout (\\\\%)}  & \\\\multicolumn{2}{c}{Spoiled Ballots (\\\\%)} \\\\\\\\\")), include.colnames = FALSE, floating = TRUE)\n\n\n#### Figure 1\n\ncorrupt.ranking$id <- 1:nrow(corrupt.ranking)\ncorrupt.ranking <- melt(id = c(\"id\", \"vote04\"), data = corrupt.ranking)\ncorrupt.ranking.vote04 <- cast(corrupt.ranking[is.na(corrupt.ranking$vote04) == FALSE, ], vote04 ~ variable, mean)\ncorrupt.ranking.vote04 <- melt(corrupt.ranking.vote04, id = \"vote04\")\nlevels(corrupt.ranking.vote04$variable) <- c(\"Suplicy is more corrupt\", \"Kassab is more corrupt\", \"Both equally corrupt\", \"Don't Know\")\n\ncorrupt.ranking.plot.vote04 <- ggplot(corrupt.ranking.vote04, aes(value, variable)) +\n  geom_point(aes(color = vote04, shape = vote04), size = 4) +\n  xlab(\"Proportion\") +\n  theme_bw() +\n  labs(colour = \"\", shape = \"\") +\n  scale_colour_brewer(palette = \"Set1\") +\n  ylab(\"\")\n\n\ncorrupt.ranking.plot.vote04\n\n\n\n#### Table 3\n\nsvy.exp.data$marta.treat <- ifelse(svy.exp.data$treat == \"M\", 1, 0)\nsvy.exp.data$kassab.treat <- ifelse(svy.exp.data$treat == \"K\", 1, 0)\nsvy.exp.data$vote.marta.pre[is.na(svy.exp.data$vote.marta.pre)] <- 0\nsvy.exp.data$vote.kassab.pre[is.na(svy.exp.data$vote.kassab.pre)] <- 0\n\nconf.int <- function(ate, se) {\n  paste(\"[\", round(ate - 1.96 * se, digits = 2), \", \", round(ate + 1.96 * se, digits = 2), \"]\", sep = \"\")\n}\n\n\n\n# Marta Flier Effect on Feeling Therm\nmarta.placebo.mod <- difference_in_means(marta.therm.change ~ treat,\n  data = svy.exp.data[svy.exp.data$treat != \"K\", ],\n  blocks = block\n)\nmarta.placebo.est <- round(marta.placebo.mod$coefficients, 2)\nmarta.placebo.se <- round(marta.placebo.mod$std.error, 2)\nmarta.placebo.ci <- paste0(\"[\", round(marta.placebo.mod$conf.low, 2), \", \", round(marta.placebo.mod$conf.high, 2), \"]\")\nmarta.placebo.p <- round(marta.placebo.mod$p.value, 2)\n\n# Kassab Flier Effect on Feeling Therm\nkassab.placebo.mod <- difference_in_means(kassab.therm.change ~ treat,\n                                         data = svy.exp.data[svy.exp.data$treat != \"M\", ],\n                                         blocks = block\n)\nkassab.placebo.est <- round(kassab.placebo.mod$coefficients, 2)\nkassab.placebo.se <- round(kassab.placebo.mod$std.error, 2)\nkassab.placebo.ci <- paste0(\"[\", round(kassab.placebo.mod$conf.low, 2), \", \", round(kassab.placebo.mod$conf.high, 2), \"]\")\nkassab.placebo.p <- round(kassab.placebo.mod$p.value, 2)\n\nmarta.kassab.mod <- difference_in_means(both.therm.change ~ treat,\n                                          data = svy.exp.data[svy.exp.data$treat != \"C\", ],\n                                          blocks = block\n)\nmarta.kassab.est <- round(marta.kassab.mod$coefficients, 2)\nmarta.kassab.se <- round(marta.kassab.mod$std.error, 2)\nmarta.kassab.ci <- paste0(\"[\", round(marta.kassab.mod$conf.low, 2), \", \", round(marta.kassab.mod$conf.high, 2), \"]\")\nmarta.kassab.p <- round(marta.kassab.mod$p.value, 2)\n\nsvy.exp.table <- data.frame(rbind(cbind(marta.placebo.est, kassab.placebo.est, marta.kassab.est),\n                                  cbind(marta.placebo.se, kassab.placebo.se, marta.kassab.se),\n                                  cbind(marta.placebo.ci, kassab.placebo.ci, marta.kassab.ci),\n                                  cbind(marta.placebo.p, kassab.placebo.p, marta.kassab.p)))\nnames(svy.exp.table) <- c(\"Suplicy (PT) Flier vs Placebo\", \"Kassab (DEM/PFL) Flier vs Placebo\", \"Suplicy (PT) Flier vs Kassab (DEM/PFL) Flier\")\nrownames(svy.exp.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \" p-Value\")\nsvy.exp.table <- xtable(svy.exp.table, digits = 2)\nalign(svy.exp.table) <- \"c|ccc\"\nprint(svy.exp.table, include.colnames = TRUE)\n\n\n#### Table 4\n\n# Marta Flier Effect on Feeling Therm\nmarta.placebo.martavoter.mod <- difference_in_means(marta.therm.change ~ treat,\n                                                    data = svy.exp.data, subset = treat != \"K\" & vote.marta.pre == 1)\nmarta.placebo.martavoter.est <- round(marta.placebo.martavoter.mod$coefficients, 2)\nmarta.placebo.martavoter.se <- round(marta.placebo.martavoter.mod$std.error, 2)\nmarta.placebo.martavoter.ci <- paste0(\"[\", round(marta.placebo.martavoter.mod$conf.low, 2), \", \", round(marta.placebo.martavoter.mod$conf.high, 2), \"]\")\nmarta.placebo.martavoter.p <- round(marta.placebo.martavoter.mod$p.value, 2)\nmarta.placebo.martavoter.n <- marta.placebo.martavoter.mod$nobs\n\n\nmarta.placebo.nonmartavoter.mod <- difference_in_means(marta.therm.change ~ treat,\n                                                    data = svy.exp.data, subset = treat != \"K\" & vote.marta.pre == 0)\nmarta.placebo.nonmartavoter.est <- round(marta.placebo.nonmartavoter.mod$coefficients, 2)\nmarta.placebo.nonmartavoter.se <- round(marta.placebo.nonmartavoter.mod$std.error, 2)\nmarta.placebo.nonmartavoter.ci <- paste0(\"[\", round(marta.placebo.nonmartavoter.mod$conf.low, 2), \", \", round(marta.placebo.nonmartavoter.mod$conf.high, 2), \"]\")\nmarta.placebo.nonmartavoter.p <- round(marta.placebo.nonmartavoter.mod$p.value, 2)\nmarta.placebo.nonmartavoter.n <- marta.placebo.nonmartavoter.mod$nobs\n\n\nkassab.placebo.kassabvoter.mod <- difference_in_means(kassab.therm.change ~ treat,\n                                                    data = svy.exp.data, subset = treat != \"M\" & vote.kassab.pre == 1)\nkassab.placebo.kassabvoter.est <- round(kassab.placebo.kassabvoter.mod$coefficients, 2)\nkassab.placebo.kassabvoter.se <- round(kassab.placebo.kassabvoter.mod$std.error, 2)\nkassab.placebo.kassabvoter.ci <- paste0(\"[\", round(kassab.placebo.kassabvoter.mod$conf.low, 2), \", \", round(kassab.placebo.kassabvoter.mod$conf.high, 2), \"]\")\nkassab.placebo.kassabvoter.p <- round(kassab.placebo.kassabvoter.mod$p.value, 2)\nkassab.placebo.kassabvoter.n <- kassab.placebo.kassabvoter.mod$nobs\n\nkassab.placebo.nonkassabvoter.mod <- difference_in_means(kassab.therm.change ~ treat,\n                                                      data = svy.exp.data, subset = treat != \"M\" & vote.kassab.pre == 0)\nkassab.placebo.nonkassabvoter.est <- round(kassab.placebo.nonkassabvoter.mod$coefficients, 2)\nkassab.placebo.nonkassabvoter.se <- round(kassab.placebo.nonkassabvoter.mod$std.error, 2)\nkassab.placebo.nonkassabvoter.ci <- paste0(\"[\", round(kassab.placebo.nonkassabvoter.mod$conf.low, 2), \", \", round(kassab.placebo.nonkassabvoter.mod$conf.high, 2), \"]\")\nkassab.placebo.nonkassabvoter.p <- round(kassab.placebo.nonkassabvoter.mod$p.value, 2)\nkassab.placebo.nonkassabvoter.n <- kassab.placebo.nonkassabvoter.mod$nobs\n\nsvy.exp.hetero.table <- data.frame(rbind(cbind(marta.placebo.nonmartavoter.est, marta.placebo.martavoter.est, kassab.placebo.nonkassabvoter.est, kassab.placebo.kassabvoter.est),\n                                         cbind(marta.placebo.nonmartavoter.se, marta.placebo.martavoter.se, kassab.placebo.nonkassabvoter.se, kassab.placebo.kassabvoter.se),\n                                         cbind(marta.placebo.nonmartavoter.ci, marta.placebo.martavoter.ci, kassab.placebo.nonkassabvoter.ci, kassab.placebo.kassabvoter.ci),\n                                         cbind(marta.placebo.nonmartavoter.p, marta.placebo.martavoter.p, kassab.placebo.nonkassabvoter.p, kassab.placebo.kassabvoter.p),\n                                         cbind(marta.placebo.nonmartavoter.n, marta.placebo.martavoter.n, kassab.placebo.nonkassabvoter.n, kassab.placebo.kassabvoter.n)))\n names(svy.exp.table) <- c(\"Suplicy (PT) Flier vs Placebo\", \"Kassab (DEM/PFL) Flier vs Placebo\", \"Suplicy (PT) Flier vs Kassab (DEM/PFL) Flier\")\nrownames(svy.exp.hetero.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \"p-value\", \"n\")\nsvy.exp.hetero.table <- xtable(svy.exp.hetero.table, digits = 2)\nalign(svy.exp.hetero.table) <- \"c|cccc\"\nprint(svy.exp.hetero.table, include.colnames = TRUE)\n\n\n### Appendix Table 5\n\nexp.data <- exp.data[order(exp.data$match.id, exp.data$treat), ]\nbal.data <- exp.data[, c(\"voters\", \"pt.pres.06\", \"pt.pref.04\", \"pt.depfed.06\", \"psdb.depfed.06\", \"marta.1st.pr\", \"kassab.1st.pr\", \"branco.1st.pr\", \"nulo.1st.pr\", \"turnout.1st.pr\", \"ver.pt.1st.pr\", \"ver.psdb.1st.pr\", \"ver.dem.1st.pr\")]\nbal.data$pt.pres.06 <- bal.data$pt.pres.06 * 100\nbal.data$pt.pref.04 <- bal.data$pt.pref.04 * 100\nbal.data$pt.depfed.06 <- bal.data$pt.depfed.06 * 100\nbal.data$psdb.depfed.06 <- bal.data$psdb.depfed.06 * 100\nbal.data$marta.1st.pr <- bal.data$marta.1st.pr * 100\nbal.data$kassab.1st.pr <- bal.data$kassab.1st.pr * 100\nbal.data$branco.1st.pr <- bal.data$branco.1st.pr * 100\nbal.data$nulo.1st.pr <- bal.data$nulo.1st.pr * 100\nbal.data$turnout.1st.pr <- bal.data$turnout.1st.pr * 100\nbal.data$ver.pt.1st.pr <- bal.data$ver.pt.1st.pr * 100\nbal.data$ver.psdb.1st.pr <- bal.data$ver.psdb.1st.pr * 100\nbal.data$ver.dem.1st.pr <- bal.data$ver.dem.1st.pr * 100\n\nnames(bal.data) <- c(\"\\\\# of Registered Voters\", \"PT Pres. Vote \\\\% (2006)\", \"PT Mayor Vote \\\\% (2004)\", \"PT Congress Vote \\\\% (2006)\", \"PSDB Congress Vote \\\\% (2006)\", \"1st Round Suplicy Vote \\\\% (2008)\", \"1st Round Kassab Vote \\\\% (2008)\", \"1st Round Blank Vote \\\\% (2008)\", \"1st Round Invalid Vote \\\\% (2008)\", \"1st Round Turnout \\\\% (2008)\", \"PT City Council Vote \\\\% (2008)\", \"PSDB City Council Vote \\\\% (2008)\", \"DEM City Council Vote \\\\% (2008)\")\nbal.cap <- \"Balance on Baseline Variables\"\nstats <- list(\"Mean Difference\" = function(x) {\n  mean(x[exp.data$treat == 1] - x[exp.data$treat == 0])\n}, \"Standard Error\" = function(x) {\n  sd(x[exp.data$treat == 1] - x[exp.data$treat == 0]) / sqrt(200)\n}, \"t-Test p-Value\" = function(x) {\n  t.test(x[exp.data$treat == 1], x[exp.data$treat == 0], paired = TRUE)$p.value\n}, \"KS-test p-Value\" = function(x) {\n  ks.test(x[exp.data$treat == 1], x[exp.data$treat == 0])$p.value\n})\ntableContinuous(vars = bal.data, cap = bal.cap, lab = \"tab:bal\", longtable = FALSE, stats = stats, prec = 2)\n\n\n# > sessionInfo()\n# R version 4.1.0 (2021-05-18)\n# Platform: x86_64-apple-darwin17.0 (64-bit)\n# Running under: macOS Big Sur 11.4\n#\n# Matrix products: default\n# LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n#\n# locale:\n#   [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n#\n# attached base packages:\n#   [1] stats     graphics  grDevices utils     datasets  methods   base\n#\n# other attached packages:\n#   [1] car_3.0-11        carData_3.0-4     estimatr_0.30.2   reporttools_1.1.2 plyr_1.8.6        ggplot2_3.3.5     xtable_1.8-4\n# [8] reshape_0.8.8     usethis_2.0.1\n#\n# loaded via a namespace (and not attached):\n#   [1] zip_2.2.0          Rcpp_1.0.6         RColorBrewer_1.1-2 cellranger_1.1.0   pillar_1.6.1       compiler_4.1.0     forcats_0.5.1\n# [8] tools_4.1.0        digest_0.6.27      lifecycle_1.0.0    tibble_3.1.2       gtable_0.3.0       pkgconfig_2.0.3    rlang_0.4.11\n# [15] openxlsx_4.2.4     DBI_1.1.1          curl_4.3.2         parallel_4.1.0     haven_2.4.1        rio_0.5.27         withr_2.4.2\n# [22] dplyr_1.0.7        hms_1.1.0          generics_0.1.0     fs_1.5.0           vctrs_0.3.8        grid_4.1.0         tidyselect_1.1.1\n# [29] data.table_1.14.0  glue_1.4.2         R6_2.5.0           fansi_0.5.0        readxl_1.3.1       foreign_0.8-81     Formula_1.2-4\n# [36] farver_2.1.0       purrr_0.3.4        magrittr_2.0.1     scales_1.1.1       ellipsis_0.3.2     abind_1.4-5        assertthat_0.2.1\n# [43] colorspace_2.0-2   labeling_0.4.2     utf8_1.2.1         stringi_1.6.2      munsell_0.5.0      crayon_1.4.1\n\n# file: log_file.txt\n\nR version 4.1.1 (2021-08-10) -- \"Kick Things\"\nCopyright (C) 2021 The R Foundation for Statistical Computing\nPlatform: x86_64-apple-darwin17.0 (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\n  Natural language support but running in an English locale\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on how to cite R or R packages in publications.\n\nType 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n\n> ### This code replicates tables and figures in\n> ### \"When Do Voters Punish Corrupt Politicians? Evidence from a Field and Survey Experiment\"\n> ### By Miguel P. De Figueiredo, F. Daniel Hidalgo, and Yuri Kasahara\n> ###\n> \n> ## Tables are produced in latex format\n> ## See bottom of script for R and package versions\n> \n> \n> library(reshape)\n> library(xtable)\n> library(ggplot2)\n> library(plyr)\n\nAttaching package: \u2018plyr\u2019\n\nThe following objects are masked from \u2018package:reshape\u2019:\n\n    rename, round_any\n\n> library(reporttools)\n> library(estimatr)\n> \n> \n> load(\"SPexperiment_data.RData\")\n> \n> blocked.ate <- function(y, treat, block) {\n+   data <- data.frame(y, treat, block)\n+   block.ate <- ddply(data, \"block\", summarise, block.ate = mean(y[treat == 1], na.rm = TRUE) - mean(y[treat == 0], na.rm = TRUE), block.wt = length(y))\n+   block.ate$block.wt <- block.ate$block.wt / nrow(data)\n+   ate <- sum(block.ate$block.ate * block.ate$block.wt)\n+   ate\n+ }\n> \n> # Function to get heteroskedastically robust SE\n> summaryR.lm <- function(model, type = c(\"hc3\", \"hc0\", \"hc1\", \"hc2\", \"hc4\"), ...) {\n+   if (!require(car)) stop(\"Required car package is missing.\")\n+   type <- match.arg(type)\n+   V <- hccm(model, type = type)\n+   sumry <- summary(model)\n+   table <- coef(sumry)\n+   table[, 2] <- sqrt(diag(V))\n+   table[, 3] <- table[, 1] / table[, 2]\n+   table[, 4] <- 2 * pt(abs(table[, 3]), df.residual(model), lower.tail = FALSE)\n+   sumry$coefficients <- table\n+   p <- nrow(table)\n+   hyp <- cbind(0, diag(p - 1))\n+   sumry$fstatistic[1] <- linearHypothesis(model, hyp, white.adjust = type)[2, \"F\"]\n+   sumry\n+ }\n> \n> blocked.se <- function(y, treat, block) {\n+   data <- data.frame(y, treat, block)\n+   block.var <- ddply(data, \"block\", summarise, block.var = (var(y[treat == 0], na.rm = TRUE) / (length(y) - sum(treat)) + var(y[treat == 1], na.rm = TRUE) / (sum(treat))), block.wt = length(y))\n+   block.var$block.wt <- (block.var$block.wt)^2 / nrow(data)^2\n+   var <- sum(block.var$block.var * block.var$block.wt)\n+   sqrt(var)\n+ }\n> \n> \n> \n> \n> #### Table 1 and 2\n> \n> \n> marta.results <- list()\n> kassab.results <- list()\n> martakassab.results <- list()\n> marta.data$marta.pr <- marta.data$marta.pr * 100\n> marta.data$turnout <- marta.data$turnout * 100\n> kassab.data$kassab.pr <- kassab.data$kassab.pr * 100\n> kassab.data$turnout <- kassab.data$turnout * 100\n> marta.data$nulo.votes <- (marta.data$nulo.votes / marta.data$voters) * 100\n> kassab.data$nulo.votes <- (kassab.data$nulo.votes / kassab.data$voters) * 100\n> marta.data$branco.votes <- (marta.data$branco.votes / marta.data$voters) * 100\n> kassab.data$branco.votes <- (kassab.data$branco.votes / kassab.data$voters) * 100\n> marta.data$branconulo.votes <- marta.data$branco.votes + marta.data$nulo.votes\n> kassab.data$branconulo.votes <- kassab.data$branco.votes + kassab.data$nulo.votes\n> covariates <- c(\"treat\", \"match.id\", \"pt.pref.04\", \"voters\")\n> \n> \n> #\n> ### Adjusted Estimates\n> ##\n> ## Effect on Marta Vote Share with covariates\n> marta.results$lm.marta.pr.cov <- summaryR.lm(lm(as.formula(paste(\"marta.pr ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\nLoading required package: car\nLoading required package: carData\n> ## Effect on Kassab Vote Share with covariates\n> kassab.results$lm.kassab.pr.cov <- summaryR.lm(lm(as.formula(paste(\"kassab.pr ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n> ## Effect on Turnout (of Marta flier) with Covariates\n> marta.results$lm.turnout.marta.cov <- summaryR.lm(lm(as.formula(paste(\"turnout ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n> ## Effect on Turnout (Kassab Flier) with Covariates\n> kassab.results$lm.turnout.kassab.cov <- summaryR.lm(lm(as.formula(paste(\"turnout ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n> ## Effect on Nulos (Marta flier) with Covariates\n> marta.results$lm.nulo.cov <- summaryR.lm(lm(as.formula(paste(\"nulo.votes ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n> ## Effect on Nulos (Kassab flier) with Covariates\n> kassab.results$lm.nulo.cov <- summaryR.lm(lm(as.formula(paste(\"nulo.votes ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n> ## Effect on Brancos (Marta flier) with Covariates\n> marta.results$lm.branco.cov <- summaryR.lm(lm(as.formula(paste(\"branco.votes ~ \", paste(covariates, collapse = \"+\"))), data = marta.data), type = \"hc2\")[4]$coefficients[2, ]\n> ## Effect on Brancos (Kassab flier) with Covariates\n> kassab.results$lm.branco.cov <- summaryR.lm(lm(as.formula(paste(\"branco.votes ~ \", paste(covariates, collapse = \"+\"))), data = kassab.data), type = \"hc2\")[4]$coefficients[2, ]\n> \n> \n> ##\n> ### Unadjusted Estimates\n> ##\n> ## Effect on Marta vote share\n> marta.results$itt.marta.pr[1] <- sum(tapply(marta.data$marta.pr[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$marta.pr[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\n> marta.results$itt.marta.pr[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$marta.pr[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$marta.pr[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.marta.pr[1])^2))\n> marta.results$itt.marta.pr[3] <- pt(marta.results$itt.marta.pr[1] / marta.results$itt.marta.pr[2], 99) * 2\n> ## Effect on Turnout (Marta Flier)\n> marta.results$itt.turnout[1] <- sum(tapply(marta.data$turnout[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$turnout[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\n> marta.results$itt.turnout[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$turnout[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$turnout[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.turnout[1])^2))\n> marta.results$itt.turnout[3] <- pt(marta.results$itt.turnout[1] / marta.results$itt.turnout[2], 99) * 2\n> \n> ## Effect on Nulos (Marta Flier)\n> marta.results$itt.nulo.votes[1] <- sum(tapply(marta.data$nulo.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$nulo.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\n> marta.results$itt.nulo.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$nulo.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$nulo.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.nulo.votes[1])^2))\n> marta.results$itt.nulo.votes[3] <- pt(marta.results$itt.nulo.votes[1] / marta.results$itt.nulo.votes[2], 99) * 2\n> ## Effect on Brancos (Marta Flier)\n> marta.results$itt.branco.votes[1] <- sum(tapply(marta.data$branco.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$branco.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) / length(unique(marta.data$match.id))\n> marta.results$itt.branco.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(marta.data$branco.votes[marta.data$treat == 1], marta.data$match.id[marta.data$treat == 1], mean) - tapply(marta.data$branco.votes[marta.data$treat == 0], marta.data$match.id[marta.data$treat == 0], mean)) - marta.results$itt.branco.votes[1])^2))\n> marta.results$itt.branco.votes[3] <- (1 - pt(marta.results$itt.branco.votes[1] / marta.results$itt.branco.votes[2], 99)) * 2\n> \n> ## Effect on Kassab Vote Share\n> kassab.results$itt.kassab.pr[1] <- sum(tapply(kassab.data$kassab.pr[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$kassab.pr[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\n> kassab.results$itt.kassab.pr[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$kassab.pr[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$kassab.pr[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.kassab.pr[1])^2))\n> kassab.results$itt.kassab.pr[3] <- (1 - pt(kassab.results$itt.kassab.pr[1] / kassab.results$itt.kassab.pr[2], 99)) * 2\n> #### Effect on Turnout (Kassab Flier)\n> kassab.results$itt.turnout[1] <- sum(tapply(kassab.data$turnout[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$turnout[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\n> kassab.results$itt.turnout[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$turnout[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$turnout[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.turnout[1])^2))\n> kassab.results$itt.turnout[3] <- (1 - pt(kassab.results$itt.turnout[1] / kassab.results$itt.turnout[2], 99)) * 2\n> ## Effect on Nulos (Kassab Flier)\n> kassab.results$itt.nulo.votes[1] <- sum(tapply(kassab.data$nulo.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$nulo.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\n> kassab.results$itt.nulo.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$nulo.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$nulo.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.nulo.votes[1])^2))\n> kassab.results$itt.nulo.votes[3] <- pt(kassab.results$itt.nulo.votes[1] / kassab.results$itt.nulo.votes[2], 99) * 2\n> ## Effect on Brancos (Kassab Flier)\n> kassab.results$itt.branco.votes[1] <- sum(tapply(kassab.data$branco.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$branco.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) / length(unique(kassab.data$match.id))\n> kassab.results$itt.branco.votes[2] <- sqrt(1 / (100 * (100 - 1)) * sum(((tapply(kassab.data$branco.votes[kassab.data$treat == 1], kassab.data$match.id[kassab.data$treat == 1], mean) - tapply(kassab.data$branco.votes[kassab.data$treat == 0], kassab.data$match.id[kassab.data$treat == 0], mean)) - kassab.results$itt.branco.votes[1])^2))\n> kassab.results$itt.branco.votes[3] <- pt(kassab.results$itt.branco.votes[1] / kassab.results$itt.branco.votes[2], 99) * 2\n> \n> \n> \n> conf.int <- function(x) paste(\"[\", round(x[1] - 1.96 * x[2], digits = 1), \", \", round(x[1] + 1.96 * x[2], digits = 1), \"]\", sep = \"\")\n> \n> options(scipen = 999)\n> \n> marta.table <- cbind(\n+   rbind(round(marta.results$itt.marta.pr[1], 1), round(marta.results$itt.marta.pr[2], 2), conf.int(marta.results$itt.marta.pr), round(marta.results$itt.marta.pr[3], 2)),\n+   rbind(round(marta.results$lm.marta.pr.cov[1], 1), round(marta.results$lm.marta.pr.cov[2], 2), conf.int(marta.results$lm.marta.pr.cov), round(marta.results$lm.marta.pr.cov[4], 2)),\n+   rbind(round(marta.results$itt.turnout[1], 1), round(marta.results$itt.turnout[2], 2), conf.int(marta.results$itt.turnout), round(marta.results$itt.turnout[3], 4)),\n+   rbind(round(marta.results$lm.turnout.marta.cov[1], 1), round(marta.results$lm.turnout.marta.cov[2], 2), conf.int(marta.results$lm.turnout.marta.cov), round(marta.results$lm.turnout.marta.cov[4], 4)),\n+   rbind(round(marta.results$itt.branco.votes[1], 2), round(marta.results$itt.branco.votes[2], 2), conf.int(marta.results$itt.branco.votes), round(marta.results$itt.branco.votes[3], 2)),\n+   rbind(round(marta.results$lm.branco.cov[1], 2), round(marta.results$lm.branco.cov[2], 2), conf.int(marta.results$lm.branco.cov), round(marta.results$lm.branco.cov[4], 2))\n+ )\n> marta.table <- rbind(marta.table, c(\"\", \"X\", \"\", \"X\", \"\", \"X\"))\n> \n> \n> \n> # col.names <- c(\"\", \"\\\\multicolumn{2}{c}{Vote Share (\\\\%)}\", \"\\\\multicolumn{2}{c}{Turnout (\\\\%)}\", \"\\\\multicolumn{2}{c}{Spoiled Ballots (\\\\%)}\")\n> rownames(marta.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \"P-value\", \"Covariates\")\n> marta.table <- xtable(marta.table, digits = 4)\n> align(marta.table) <- \"c|cccccc\"\n> \n> print(marta.table, add.to.row = list(pos = list(0), command = c(\"& \\\\multicolumn{2}{c}{Vote Share (\\\\%)} &  \\\\multicolumn{2}{c}{Turnout (\\\\%)}  & \\\\multicolumn{2}{c}{Spoiled Ballots (\\\\%)} \\\\\\\\\")), include.colnames = FALSE, floating = TRUE)\n% latex table generated in R 4.1.1 by xtable 1.8-4 package\n% Wed Oct 20 10:39:02 2021\n\\begin{table}[ht]\n\\centering\n\\begin{tabular}{c|cccccc}\n  \\hline\n  & \\multicolumn{2}{c}{Vote Share (\\%)} &  \\multicolumn{2}{c}{Turnout (\\%)}  & \\multicolumn{2}{c}{Spoiled Ballots (\\%)} \\\\ \\hline\nEstimate & -2.6 & -2.6 & -1.8 & -1.8 & 0.03 & 0.01 \\\\ \n  Standard Error & 1.99 & 0.93 & 0.46 & 0.45 & 0.08 & 0.08 \\\\ \n  95 \\% Conf. Int. & [-6.5, 1.3] & [-4.4, -0.7] & [-2.7, -0.9] & [-2.7, -0.9] & [-0.1, 0.2] & [-0.1, 0.2] \\\\ \n  P-value & 0.2 & 0.01 & 0.0002 & 0.0001 & 0.72 & 0.86 \\\\ \n  Covariates &  & X &  & X &  & X \\\\ \n   \\hline\n\\end{tabular}\n\\end{table}\n> \n> \n> \n> kassab.table <- cbind(\n+   rbind(round(kassab.results$itt.kassab.pr[1], 1), round(kassab.results$itt.kassab.pr[2], 2), conf.int(kassab.results$itt.kassab.pr), round(kassab.results$itt.kassab.pr[3], 2)),\n+   rbind(round(kassab.results$lm.kassab.pr.cov[1], 1), round(kassab.results$lm.kassab.pr.cov[2], 2), conf.int(kassab.results$lm.kassab.pr.cov), round(kassab.results$lm.kassab.pr.cov[4], 2)),\n+   rbind(round(kassab.results$itt.turnout[1], 1), round(kassab.results$itt.turnout[2], 2), conf.int(kassab.results$itt.turnout), round(kassab.results$itt.turnout[3], 2)),\n+   rbind(round(kassab.results$lm.turnout.kassab.cov[1], 1), round(kassab.results$lm.turnout.kassab.cov[2], 2), conf.int(kassab.results$lm.turnout.kassab.cov), round(kassab.results$lm.turnout.kassab.cov[4], 2)),\n+   rbind(round(kassab.results$itt.branco.votes[1], 2), round(kassab.results$itt.branco.votes[2], 2), conf.int(kassab.results$itt.branco.votes), round(kassab.results$itt.branco.votes[3], 2)),\n+   rbind(round(kassab.results$lm.branco.cov[1], 2), round(kassab.results$lm.branco.cov[2], 2), conf.int(kassab.results$lm.branco.cov), round(kassab.results$lm.branco.cov[4], 2))\n+ )\n> kassab.table <- rbind(kassab.table, c(\"\", \"X\", \"\", \"X\", \"\", \"X\"))\n> rownames(kassab.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \"P-value\", \"Covariates\")\n> kassab.table <- xtable(kassab.table)\n> align(kassab.table) <- \"c|cccccc\"\n> \n> print(kassab.table, add.to.row = list(pos = list(0), command = c(\"& \\\\multicolumn{2}{c}{Vote Share (\\\\%)} &  \\\\multicolumn{2}{c}{Turnout (\\\\%)}  & \\\\multicolumn{2}{c}{Spoiled Ballots (\\\\%)} \\\\\\\\\")), include.colnames = FALSE, floating = TRUE)\n% latex table generated in R 4.1.1 by xtable 1.8-4 package\n% Wed Oct 20 10:39:02 2021\n\\begin{table}[ht]\n\\centering\n\\begin{tabular}{c|cccccc}\n  \\hline\n  & \\multicolumn{2}{c}{Vote Share (\\%)} &  \\multicolumn{2}{c}{Turnout (\\%)}  & \\multicolumn{2}{c}{Spoiled Ballots (\\%)} \\\\ \\hline\nEstimate & 1.9 & 1.5 & 0.1 & 0 & -0.05 & -0.09 \\\\ \n  Standard Error & 1.87 & 0.99 & 0.42 & 0.41 & 0.12 & 0.13 \\\\ \n  95 \\% Conf. Int. & [-1.8, 5.5] & [-0.5, 3.4] & [-0.7, 0.9] & [-0.8, 0.8] & [-0.3, 0.2] & [-0.4, 0.2] \\\\ \n  P-value & 0.32 & 0.15 & 0.77 & 0.95 & 0.68 & 0.49 \\\\ \n  Covariates &  & X &  & X &  & X \\\\ \n   \\hline\n\\end{tabular}\n\\end{table}\n> \n> \n> #### Figure 1\n> \n> corrupt.ranking$id <- 1:nrow(corrupt.ranking)\n> corrupt.ranking <- melt(id = c(\"id\", \"vote04\"), data = corrupt.ranking)\n> corrupt.ranking.vote04 <- cast(corrupt.ranking[is.na(corrupt.ranking$vote04) == FALSE, ], vote04 ~ variable, mean)\n> corrupt.ranking.vote04 <- melt(corrupt.ranking.vote04, id = \"vote04\")\n> levels(corrupt.ranking.vote04$variable) <- c(\"Suplicy is more corrupt\", \"Kassab is more corrupt\", \"Both equally corrupt\", \"Don't Know\")\n> \n> corrupt.ranking.plot.vote04 <- ggplot(corrupt.ranking.vote04, aes(value, variable)) +\n+   geom_point(aes(color = vote04, shape = vote04), size = 4) +\n+   xlab(\"Proportion\") +\n+   theme_bw() +\n+   labs(colour = \"\", shape = \"\") +\n+   scale_colour_brewer(palette = \"Set1\") +\n+   ylab(\"\")\n> \n> \n> corrupt.ranking.plot.vote04\n> \n> \n> \n> #### Table 3\n> \n> svy.exp.data$marta.treat <- ifelse(svy.exp.data$treat == \"M\", 1, 0)\n> svy.exp.data$kassab.treat <- ifelse(svy.exp.data$treat == \"K\", 1, 0)\n> svy.exp.data$vote.marta.pre[is.na(svy.exp.data$vote.marta.pre)] <- 0\n> svy.exp.data$vote.kassab.pre[is.na(svy.exp.data$vote.kassab.pre)] <- 0\n> \n> conf.int <- function(ate, se) {\n+   paste(\"[\", round(ate - 1.96 * se, digits = 2), \", \", round(ate + 1.96 * se, digits = 2), \"]\", sep = \"\")\n+ }\n> \n> \n> \n> # Marta Flier Effect on Feeling Therm\n> marta.placebo.mod <- difference_in_means(marta.therm.change ~ treat,\n+   data = svy.exp.data[svy.exp.data$treat != \"K\", ],\n+   blocks = block\n+ )\n> marta.placebo.est <- round(marta.placebo.mod$coefficients, 2)\n> marta.placebo.se <- round(marta.placebo.mod$std.error, 2)\n> marta.placebo.ci <- paste0(\"[\", round(marta.placebo.mod$conf.low, 2), \", \", round(marta.placebo.mod$conf.high, 2), \"]\")\n> marta.placebo.p <- round(marta.placebo.mod$p.value, 2)\n> \n> # Kassab Flier Effect on Feeling Therm\n> kassab.placebo.mod <- difference_in_means(kassab.therm.change ~ treat,\n+                                          data = svy.exp.data[svy.exp.data$treat != \"M\", ],\n+                                          blocks = block\n+ )\n> kassab.placebo.est <- round(kassab.placebo.mod$coefficients, 2)\n> kassab.placebo.se <- round(kassab.placebo.mod$std.error, 2)\n> kassab.placebo.ci <- paste0(\"[\", round(kassab.placebo.mod$conf.low, 2), \", \", round(kassab.placebo.mod$conf.high, 2), \"]\")\n> kassab.placebo.p <- round(kassab.placebo.mod$p.value, 2)\n> \n> marta.kassab.mod <- difference_in_means(both.therm.change ~ treat,\n+                                           data = svy.exp.data[svy.exp.data$treat != \"C\", ],\n+                                           blocks = block\n+ )\n> marta.kassab.est <- round(marta.kassab.mod$coefficients, 2)\n> marta.kassab.se <- round(marta.kassab.mod$std.error, 2)\n> marta.kassab.ci <- paste0(\"[\", round(marta.kassab.mod$conf.low, 2), \", \", round(marta.kassab.mod$conf.high, 2), \"]\")\n> marta.kassab.p <- round(marta.kassab.mod$p.value, 2)\n> \n> svy.exp.table <- data.frame(rbind(cbind(marta.placebo.est, kassab.placebo.est, marta.kassab.est),\n+                                   cbind(marta.placebo.se, kassab.placebo.se, marta.kassab.se),\n+                                   cbind(marta.placebo.ci, kassab.placebo.ci, marta.kassab.ci),\n+                                   cbind(marta.placebo.p, kassab.placebo.p, marta.kassab.p)))\n> names(svy.exp.table) <- c(\"Suplicy (PT) Flier vs Placebo\", \"Kassab (DEM/PFL) Flier vs Placebo\", \"Suplicy (PT) Flier vs Kassab (DEM/PFL) Flier\")\n> rownames(svy.exp.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \" p-Value\")\n> svy.exp.table <- xtable(svy.exp.table, digits = 2)\n> align(svy.exp.table) <- \"c|ccc\"\n> print(svy.exp.table, include.colnames = TRUE)\n% latex table generated in R 4.1.1 by xtable 1.8-4 package\n% Wed Oct 20 10:39:03 2021\n\\begin{table}[ht]\n\\centering\n\\begin{tabular}{c|ccc}\n  \\hline\n & Suplicy (PT) Flier vs Placebo & Kassab (DEM/PFL) Flier vs Placebo & Suplicy (PT) Flier vs Kassab (DEM/PFL) Flier \\\\ \n  \\hline\nEstimate & -0.78 & -0.36 & -0.54 \\\\ \n  Standard Error & 0.32 & 0.34 & 0.42 \\\\ \n  95 \\% Conf. Int. & [-1.41, -0.15] & [-1.04, 0.32] & [-1.37, 0.3] \\\\ \n   p-Value & 0.02 & 0.29 & 0.2 \\\\ \n   \\hline\n\\end{tabular}\n\\end{table}\n> \n> \n> #### Table 4\n> \n> # Marta Flier Effect on Feeling Therm\n> marta.placebo.martavoter.mod <- difference_in_means(marta.therm.change ~ treat,\n+                                                     data = svy.exp.data, subset = treat != \"K\" & vote.marta.pre == 1)\n> marta.placebo.martavoter.est <- round(marta.placebo.martavoter.mod$coefficients, 2)\n> marta.placebo.martavoter.se <- round(marta.placebo.martavoter.mod$std.error, 2)\n> marta.placebo.martavoter.ci <- paste0(\"[\", round(marta.placebo.martavoter.mod$conf.low, 2), \", \", round(marta.placebo.martavoter.mod$conf.high, 2), \"]\")\n> marta.placebo.martavoter.p <- round(marta.placebo.martavoter.mod$p.value, 2)\n> marta.placebo.martavoter.n <- marta.placebo.martavoter.mod$nobs\n> \n> \n> marta.placebo.nonmartavoter.mod <- difference_in_means(marta.therm.change ~ treat,\n+                                                     data = svy.exp.data, subset = treat != \"K\" & vote.marta.pre == 0)\n> marta.placebo.nonmartavoter.est <- round(marta.placebo.nonmartavoter.mod$coefficients, 2)\n> marta.placebo.nonmartavoter.se <- round(marta.placebo.nonmartavoter.mod$std.error, 2)\n> marta.placebo.nonmartavoter.ci <- paste0(\"[\", round(marta.placebo.nonmartavoter.mod$conf.low, 2), \", \", round(marta.placebo.nonmartavoter.mod$conf.high, 2), \"]\")\n> marta.placebo.nonmartavoter.p <- round(marta.placebo.nonmartavoter.mod$p.value, 2)\n> marta.placebo.nonmartavoter.n <- marta.placebo.nonmartavoter.mod$nobs\n> \n> \n> kassab.placebo.kassabvoter.mod <- difference_in_means(kassab.therm.change ~ treat,\n+                                                     data = svy.exp.data, subset = treat != \"M\" & vote.kassab.pre == 1)\n> kassab.placebo.kassabvoter.est <- round(kassab.placebo.kassabvoter.mod$coefficients, 2)\n> kassab.placebo.kassabvoter.se <- round(kassab.placebo.kassabvoter.mod$std.error, 2)\n> kassab.placebo.kassabvoter.ci <- paste0(\"[\", round(kassab.placebo.kassabvoter.mod$conf.low, 2), \", \", round(kassab.placebo.kassabvoter.mod$conf.high, 2), \"]\")\n> kassab.placebo.kassabvoter.p <- round(kassab.placebo.kassabvoter.mod$p.value, 2)\n> kassab.placebo.kassabvoter.n <- kassab.placebo.kassabvoter.mod$nobs\n> \n> kassab.placebo.nonkassabvoter.mod <- difference_in_means(kassab.therm.change ~ treat,\n+                                                       data = svy.exp.data, subset = treat != \"M\" & vote.kassab.pre == 0)\n> kassab.placebo.nonkassabvoter.est <- round(kassab.placebo.nonkassabvoter.mod$coefficients, 2)\n> kassab.placebo.nonkassabvoter.se <- round(kassab.placebo.nonkassabvoter.mod$std.error, 2)\n> kassab.placebo.nonkassabvoter.ci <- paste0(\"[\", round(kassab.placebo.nonkassabvoter.mod$conf.low, 2), \", \", round(kassab.placebo.nonkassabvoter.mod$conf.high, 2), \"]\")\n> kassab.placebo.nonkassabvoter.p <- round(kassab.placebo.nonkassabvoter.mod$p.value, 2)\n> kassab.placebo.nonkassabvoter.n <- kassab.placebo.nonkassabvoter.mod$nobs\n> \n> svy.exp.hetero.table <- data.frame(rbind(cbind(marta.placebo.nonmartavoter.est, marta.placebo.martavoter.est, kassab.placebo.nonkassabvoter.est, kassab.placebo.kassabvoter.est),\n+                                          cbind(marta.placebo.nonmartavoter.se, marta.placebo.martavoter.se, kassab.placebo.nonkassabvoter.se, kassab.placebo.kassabvoter.se),\n+                                          cbind(marta.placebo.nonmartavoter.ci, marta.placebo.martavoter.ci, kassab.placebo.nonkassabvoter.ci, kassab.placebo.kassabvoter.ci),\n+                                          cbind(marta.placebo.nonmartavoter.p, marta.placebo.martavoter.p, kassab.placebo.nonkassabvoter.p, kassab.placebo.kassabvoter.p),\n+                                          cbind(marta.placebo.nonmartavoter.n, marta.placebo.martavoter.n, kassab.placebo.nonkassabvoter.n, kassab.placebo.kassabvoter.n)))\n>  names(svy.exp.table) <- c(\"Suplicy (PT) Flier vs Placebo\", \"Kassab (DEM/PFL) Flier vs Placebo\", \"Suplicy (PT) Flier vs Kassab (DEM/PFL) Flier\")\n> rownames(svy.exp.hetero.table) <- c(\"Estimate\", \"Standard Error\", \"95 % Conf. Int.\", \"p-value\", \"n\")\n> svy.exp.hetero.table <- xtable(svy.exp.hetero.table, digits = 2)\n> align(svy.exp.hetero.table) <- \"c|cccc\"\n> print(svy.exp.hetero.table, include.colnames = TRUE)\n% latex table generated in R 4.1.1 by xtable 1.8-4 package\n% Wed Oct 20 10:39:03 2021\n\\begin{table}[ht]\n\\centering\n\\begin{tabular}{c|cccc}\n  \\hline\n & marta.placebo.nonmartavoter.est & marta.placebo.martavoter.est & kassab.placebo.nonkassabvoter.est & kassab.placebo.kassabvoter.est \\\\ \n  \\hline\nEstimate & -0.38 & -1.29 & -1.24 & 0.42 \\\\ \n  Standard Error & 0.32 & 0.53 & 0.5 & 0.49 \\\\ \n  95 \\% Conf. Int. & [-1.02, 0.26] & [-2.36, -0.22] & [-2.24, -0.24] & [-0.57, 1.41] \\\\ \n  p-value & 0.24 & 0.02 & 0.02 & 0.4 \\\\ \n  n & 85 & 48 & 61 & 72 \\\\ \n   \\hline\n\\end{tabular}\n\\end{table}\n> \n> \n> ### Appendix Table 5\n> \n> exp.data <- exp.data[order(exp.data$match.id, exp.data$treat), ]\n> bal.data <- exp.data[, c(\"voters\", \"pt.pres.06\", \"pt.pref.04\", \"pt.depfed.06\", \"psdb.depfed.06\", \"marta.1st.pr\", \"kassab.1st.pr\", \"branco.1st.pr\", \"nulo.1st.pr\", \"turnout.1st.pr\", \"ver.pt.1st.pr\", \"ver.psdb.1st.pr\", \"ver.dem.1st.pr\")]\n> bal.data$pt.pres.06 <- bal.data$pt.pres.06 * 100\n> bal.data$pt.pref.04 <- bal.data$pt.pref.04 * 100\n> bal.data$pt.depfed.06 <- bal.data$pt.depfed.06 * 100\n> bal.data$psdb.depfed.06 <- bal.data$psdb.depfed.06 * 100\n> bal.data$marta.1st.pr <- bal.data$marta.1st.pr * 100\n> bal.data$kassab.1st.pr <- bal.data$kassab.1st.pr * 100\n> bal.data$branco.1st.pr <- bal.data$branco.1st.pr * 100\n> bal.data$nulo.1st.pr <- bal.data$nulo.1st.pr * 100\n> bal.data$turnout.1st.pr <- bal.data$turnout.1st.pr * 100\n> bal.data$ver.pt.1st.pr <- bal.data$ver.pt.1st.pr * 100\n> bal.data$ver.psdb.1st.pr <- bal.data$ver.psdb.1st.pr * 100\n> bal.data$ver.dem.1st.pr <- bal.data$ver.dem.1st.pr * 100\n> \n> names(bal.data) <- c(\"\\\\# of Registered Voters\", \"PT Pres. Vote \\\\% (2006)\", \"PT Mayor Vote \\\\% (2004)\", \"PT Congress Vote \\\\% (2006)\", \"PSDB Congress Vote \\\\% (2006)\", \"1st Round Suplicy Vote \\\\% (2008)\", \"1st Round Kassab Vote \\\\% (2008)\", \"1st Round Blank Vote \\\\% (2008)\", \"1st Round Invalid Vote \\\\% (2008)\", \"1st Round Turnout \\\\% (2008)\", \"PT City Council Vote \\\\% (2008)\", \"PSDB City Council Vote \\\\% (2008)\", \"DEM City Council Vote \\\\% (2008)\")\n> bal.cap <- \"Balance on Baseline Variables\"\n> stats <- list(\"Mean Difference\" = function(x) {\n+   mean(x[exp.data$treat == 1] - x[exp.data$treat == 0])\n+ }, \"Standard Error\" = function(x) {\n+   sd(x[exp.data$treat == 1] - x[exp.data$treat == 0]) / sqrt(200)\n+ }, \"t-Test p-Value\" = function(x) {\n+   t.test(x[exp.data$treat == 1], x[exp.data$treat == 0], paired = TRUE)$p.value\n+ }, \"KS-test p-Value\" = function(x) {\n+   ks.test(x[exp.data$treat == 1], x[exp.data$treat == 0])$p.value\n+ })\n> tableContinuous(vars = bal.data, cap = bal.cap, lab = \"tab:bal\", longtable = FALSE, stats = stats, prec = 2)\n% latex table generated in R 4.1.1 by xtable 1.8-4 package\n% Wed Oct 20 10:39:03 2021\n\\begin{table}[ht]\n\\centering\n\\begingroup\\footnotesize\n\\begin{tabular}{lrrrr}\n \\textbf{Variable} & Mean Difference & Standard Error & t-Test p-Value & KS-test p-Value \\\\ \n  \\hline\n\\# of Registered Voters & -298.38 & 133.42 & 0.03 & 0.09 \\\\ \n  PT Pres. Vote \\% (2006) &    0.07 &   1.12 & 0.95 & 0.86 \\\\ \n  PT Mayor Vote \\% (2004) &   -0.32 &   0.98 & 0.74 & 0.54 \\\\ \n  PT Congress Vote \\% (2006) &   -0.06 &   0.72 & 0.93 & 0.99 \\\\ \n  PSDB Congress Vote \\% (2006) &    0.32 &   0.63 & 0.62 & 0.14 \\\\ \n  1st Round Suplicy Vote \\% (2008) &   -1.10 &   1.37 & 0.42 & 0.54 \\\\ \n  1st Round Kassab Vote \\% (2008) &    0.14 &   0.74 & 0.86 & 0.79 \\\\ \n  1st Round Blank Vote \\% (2008) &   -0.02 &   0.08 & 0.78 & 0.92 \\\\ \n  1st Round Invalid Vote \\% (2008) &   -0.07 &   0.08 & 0.41 & 0.79 \\\\ \n  1st Round Turnout \\% (2008) &    0.20 &   0.32 & 0.52 & 0.18 \\\\ \n  PT City Council Vote \\% (2008) &   -0.65 &   0.83 & 0.43 & 0.54 \\\\ \n  PSDB City Council Vote \\% (2008) &    0.86 &   0.60 & 0.15 & 0.33 \\\\ \n  DEM City Council Vote \\% (2008) &    0.22 &   0.44 & 0.62 & 0.47 \\\\ \n  \\end{tabular}\n\\endgroup\n\\caption{Balance on Baseline Variables} \n\\label{tab:bal}\n\\end{table}\nThere were 26 warnings (use warnings() to see them)\n> \n> \n> # > sessionInfo()\n> # R version 4.1.0 (2021-05-18)\n> # Platform: x86_64-apple-darwin17.0 (64-bit)\n> # Running under: macOS Big Sur 11.4\n> #\n> # Matrix products: default\n> # LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n> #\n> # locale:\n> #   [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n> #\n> # attached base packages:\n> #   [1] stats     graphics  grDevices utils     datasets  methods   base\n> #\n> # other attached packages:\n> #   [1] car_3.0-11        carData_3.0-4     estimatr_0.30.2   reporttools_1.1.2 plyr_1.8.6        ggplot2_3.3.5     xtable_1.8-4\n> # [8] reshape_0.8.8     usethis_2.0.1\n> #\n> # loaded via a namespace (and not attached):\n> #   [1] zip_2.2.0          Rcpp_1.0.6         RColorBrewer_1.1-2 cellranger_1.1.0   pillar_1.6.1       compiler_4.1.0     forcats_0.5.1\n> # [8] tools_4.1.0        digest_0.6.27      lifecycle_1.0.0    tibble_3.1.2       gtable_0.3.0       pkgconfig_2.0.3    rlang_0.4.11\n> # [15] openxlsx_4.2.4     DBI_1.1.1          curl_4.3.2         parallel_4.1.0     haven_2.4.1        rio_0.5.27         withr_2.4.2\n> # [22] dplyr_1.0.7        hms_1.1.0          generics_0.1.0     fs_1.5.0           vctrs_0.3.8        grid_4.1.0         tidyselect_1.1.1\n> # [29] data.table_1.14.0  glue_1.4.2         R6_2.5.0           fansi_0.5.0        readxl_1.3.1       foreign_0.8-81     Formula_1.2-4\n> # [36] farver_2.1.0       purrr_0.3.4        magrittr_2.0.1     scales_1.1.1       ellipsis_0.3.2     abind_1.4-5        assertthat_0.2.1\n> # [43] colorspace_2.0-2   labeling_0.4.2     utf8_1.2.1         stringi_1.6.2      munsell_0.5.0      crayon_1.4.1"
  },
  {
    "title": "Lage svarfordelinger fra survey",
    "authors": [
      "Kjersti Stabell Wiggen",
      "Marte"
    ],
    "language": "Stata",
    "data": "surveydata",
    "methods": [
      "bearbeiding"
    ],
    "themes": [
      "surveydata",
      "svarfordeling"
    ],
    "description": "Lager excel-ark med svarfordeling i prosent, N, gjennomsnitt og standardavvik for alle sp\u00f8rsm\u00e5l i survey",
    "folder": "lage-svarfordelinger",
    "files": [
      "lage-svarfordelinger/lage svarfordelinger.do"
    ],
    "code": "# file: lage svarfordelinger.do\n\r\n\r\n\r\n\r\n*************************************************************\r\n* Beholder kun variabler vi skal bruke, lagrer som egen fil * \r\n*************************************************************\r\n\r\n\r\nuse  \"datafil.dta\", clear\r\nkeep var1-var9 // angi variablene du vil beholde\r\ndrop *_txt //fjerner tekstvariabler\r\ndrop varx // dropper ev andre variabler\r\nsave \"datagrunnlag_svarfordelinger.dta\", replace\r\n\r\nuse \"datagrunnlag_svarfordelinger.dta\", clear\r\n\r\n*****************************************************************\r\n* Lag en fil med variablene i riktig rekkef\u00f8lge i excel *\r\n* Denne vil du trenge senere *\r\n\r\n***************************************************************** \r\nexport excel using \"variabler_til_sortering.xlsx\", firstrow(variables) replace\r\n\r\n*** Fikse i excel s\u00e5nn at det kun er variabelnavnene i filen, som ligger loddrett nedover p\u00e5 f\u00f8rste kolonne (kolonne A). \r\n*** Overskrift for kolonnen skal v\u00e6re Spm\r\n*** Kolonnen B kalles \"sortering\" og variablene nummereres fra 1 og nedover, s\u00e5 mange antall variabler det er.  \r\n*** Lagre som \"variabler_sortering.xlsx\". Deretter lage den som stata-fil.\r\n\r\nimport excel \"variabler_sortering.xlsx\", sheet(\"Sheet1\") firstrow clear \r\nsave  \"variabler_sortering.dta\", replace\r\n\r\n************************************************************************************************\r\n* Lager svarfordeling, standardavvik og gjennomsnitt for hvert sp\u00f8rsm\u00e5l *\r\n* dersom man ikke \u00f8nsker \u00e5 ha det i prosent, men i hundredeler, fjerne man *100 i nederste del *\r\n************************************************************************************************\r\n\r\n\r\n\r\nuse \"datagrunnlag_svarfordelinger.dta\", clear\r\n\r\n\r\n//Sjekk alle variablene og se hva som er maks antall svaralternativer. \r\n// I eksempelet her er 6 er det meste.\r\n// Lager hjelpevariabler for \u00e5 beregne prosent\r\n\r\n//angi variablene som du vil ha svarfordeling p\u00e5\r\nforeach y of varlist var1-var9 {  \r\n*Lager svarfordelingsvariabler i prosent\r\negen c_`y' = count(`y')\r\n\r\negen y_0_`y' = count(`y') if `y' == 0\r\negen x_0_`y' = max(y_0_`y')\r\ngen _0_`y' = (x_0_`y' / c_`y')*100\r\n\r\negen y_1_`y' = count(`y') if `y' == 1\r\negen x_1_`y' = max(y_1_`y')\r\ngen _1_`y' = (x_1_`y' / c_`y')*100\r\n\r\negen y_2_`y' = count(`y') if `y' == 2\r\negen x_2_`y' = max(y_2_`y')\r\ngen _2_`y' = (x_2_`y' / c_`y')*100\r\n\r\negen y_3_`y' = count(`y') if `y' == 3\r\negen x_3_`y' = max(y_3_`y')\r\ngen _3_`y' = (x_3_`y' / c_`y')*100\r\n\r\negen y_4_`y' = count(`y') if `y' == 4\r\negen x_4_`y' = max(y_4_`y')\r\ngen _4_`y' = (x_4_`y' / c_`y')*100\r\n\r\negen y_5_`y' = count(`y') if `y' == 5\r\negen x_5_`y' = max(y_5_`y')\r\ngen _5_`y' = (x_5_`y' / c_`y')*100\r\n\r\negen y_9999_`y' = count(`y') if `y' == 9999 //I dette tilfellet er \"vet ikke\" kodet til 9999\r\negen x_9999_`y' = max(y_9999_`y')\r\ngen _9999_`y' = (x_9999_`y' / c_`y')*100\r\n\r\n// Hvis du har flere svaralternativer, s\u00e5 lager du det videre her\r\n/*egen y_6_`y' = count(`y') if `y' == 6\r\negen x_6_`y' = max(y_6_`y')\r\ngen _6_`y' = (x_6_`y' / c_`y')*100\r\n\r\negen y_7_`y' = count(`y') if `y' == 7\r\negen x_7_`y' = max(y_7_`y')\r\ngen _7_`y' = (x_7_`y' / c_`y')*100\r\n\r\negen y_8_`y' = count(`y') if `y' == 8\r\negen x_8_`y' = max(y_8_`y')\r\ngen _8_`y' = (x_8_`y' / c_`y')*100\r\n\r\negen y_9_`y' = count(`y') if `y' == 9\r\negen x_9_`y' = max(y_9_`y')\r\ngen _9_`y' = (x_9_`y' / c_`y')*100\r\n\r\negen y_10_`y' = count(`y') if `y' == 10\r\negen x_10_`y' = max(y_10_`y')\r\ngen _10_`y' = (x_10_`y' / c_`y')*100\r\n*/\r\n\r\n// fjerner hjelpevariablene du lagde\r\ndrop c_`y'\r\ndrop y_0_`y' y_1_`y'  y_2_`y'  y_3_`y'  y_4_`y'  y_5_`y'  y_9999_`y' // y_6_`y' y_7_`y' y_8_`y' y_9_`y' y_10_`y' \r\ndrop x_0_`y' x_1_`y'  x_2_`y'  x_3_`y'  x_4_`y'  x_5_`y'  x_9999_`y' // x_6_`y' x_7_`y' x_8_`y' x_9_`y' x_10_`y' \r\n\r\n*Lager detaljvariabler\r\n\r\n*I antall svarende skal \"Vet ikke\" (9999) medregnes\r\negen _as_`y' = count(`y') /*antall svarende*/\r\n\r\n*Setter \"Vet ikke\" lik missing for \u00e5 unng\u00e5 at verdien 9999 medregnes i snitt og standardavvik:\r\n* Denne kan fjernes dersom du \u00f8nsker at vet ikke skal inng\u00e5 i beregningen . Is\u00e5fall b\u00f8r ikke vet ikke v\u00e6re 9999\r\nreplace `y' = . if `y' == 9999\r\n\r\negen _sn_`y' = mean(`y') /*gjennomsnitt*/\r\negen _std_`y' = sd(`y') /*standardavvik*/\r\n}\r\n\r\n**********************************\r\n* Tar kun vare p\u00e5 en observasjon *\r\n**********************************\r\n\r\ngenerate caseid = _n\r\nkeep if caseid == 1\r\n\r\n******************************************************************\r\n* Dropper opprinnelige variabler fordi dette er individvariabler *\r\n******************************************************************\r\n\r\ndrop var1-var9\r\n\r\n\r\n***************************************\r\n* Lager long-format ut av wide-format *\r\n***************************************\r\n\r\nreshape long _0 _1 _2 _3 _4 _5 _9999 _as _sn _std , i(caseid) j(Spm) string\r\nbrowse\r\n\r\n** Ordner variabelnavnene og sletter un\u00f8dvendige variabler **\r\ngen newvar = substr(Spm, 2, .)\r\nreplace Spm = newvar\r\ndrop newvar caseid\r\n\r\n\r\n*****************************************\r\n* Legger variablene i riktig rekkef\u00f8lge *\r\n*****************************************\r\n\r\n\r\nmerge 1:1 Spm using \"variabler_sortering.dta\"\r\n\r\nsort sortering\r\nbrowse\r\n\r\ndrop sortering _merge\r\n\r\n**************************************\r\n* Lager mer forst\u00e5elige variabelnavn *\r\n**************************************\r\n\r\nrename Spm Sp\u00f8rsm\u00e5l\r\nrename _9999 Vet_ikke\r\nrename _as N\r\nrename _sn Gjennomsnitt\r\nrename _std Standardavvik\r\n\r\nbrowse\r\n\r\n******************\r\n* Lager excelfil *\r\n******************\r\n\r\nexport excel using \"svarfordelinger.xlsx\", firstrow(variables) replace"
  },
  {
    "title": "Sosialhjelp i microdata.no",
    "authors": [
      "Kristian Tvedt"
    ],
    "language": "microdata.no",
    "data": [
      "registerdata"
    ],
    "themes": [
      "sosialhjelp",
      "innvandring",
      "kommuneanalyse"
    ],
    "methods": [
      "deskriptiv statistikk",
      "logit"
    ],
    "description": "Definerer sosialhjelpsmottakere, langtidsmottakere og gjengangere i Microdata.no. Inkluderer deskriptiv statistikk p\u00e5 kommuneniv\u00e5 og logistisk regresjon.",
    "folder": "microdata-sosialhjelp",
    "files": [
      "microdata-sosialhjelp/microdata logit sosialhjelpsmottakere.txt"
    ],
    "code": "# file: microdata logit sosialhjelpsmottakere.txt\nrequire no.ssb.fdb:36 as ds\r\n\r\ncreate-dataset data\r\nimport ds/BEFOLKNING_MRK_FNR as ident\r\ndrop if ident == '3'\r\n\r\nimport ds/BEFOLKNING_STATUSKODE 2024-01-01 as regstat\r\ndrop if regstat == '5'  // fjerner d\u00f8de, men beholder utvandrede. fjerner dette personer med d-nummer?\r\ntabulate regstat ident, missing\r\n\r\n// import alder\r\nimport ds/BEFOLKNING_FOEDSELS_AAR_MND as faarmnd\r\ngenerate alder = 2023 - int(faarmnd/100) // baseline-\u00e5r 2023 hvis populasjon per 1.1.2024\r\nsummarize alder\r\n// filtrere til normal arbeidsalder (ILO-definisjon)\r\n// keep if alder > 24 & alder < 55 // 25-54 \u00e5r\r\nkeep if alder >= 18\r\n\r\n// populasjon per kommune\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2024-01-01 as kommune\r\n\r\n// Innvandrere: F\u00f8deland, landbakgrunn, innvandringsgrunn, botid\r\n// import f\u00f8deland\r\nimport ds/BEFOLKNING_FODELAND as f\u00f8deland\r\n\r\n// Landbakgrunn: Foreldres f\u00f8deland for personer f\u00f8dt i Norge.\r\nimport ds/BEFOLKNING_LANDBAK3GEN as landbakgrunn\r\n\r\n// import innvandringsgrunn: flukt, arbeid, familie eller utdanning?\r\nimport ds/BEFOLKNING_INNGRUNN1 as innvandringsgrunn\r\n\r\n// SSBs innvandringskategorier \r\nimport ds/BEFOLKNING_INVKAT as innvandringskategori // innvandrere, etterkommere etc\r\ngenerate innvkat = 0 if inlist(innvandringskategori, 'A', 'E', 'F', 'G')  // majoritetsbefolkning\r\nreplace innvkat = 1 if innvandringskategori == 'B'\r\nreplace innvkat = 2 if inlist(innvandringskategori, 'C')  // C = norskf\u00f8dte med innvandrerforeldre\r\ndefine-labels innv 0 'Majoritetsbefolkning' 1 'Innvandrere' 2 'Etterkommere'\r\nassign-labels innvkat innv\r\n\r\n// import botid (omfatter 1.5M personer)\r\nimport ds/BEFOLKNING_FORSTDATO as oppholdsdato \r\nsummarize oppholdsdato\r\ngenerate ankomst\u00e5r = substr(oppholdsdato, 1,4) // henter ut \u00e5r med substring, start 1 og slutt 4\r\ndestring ankomst\u00e5r\r\ndrop if ankomst\u00e5r > 3000 // 32 personer har ankomst\u00e5r 8888\r\ngenerate botid = 2023 - ankomst\u00e5r  // ankomne i 2023 vil f\u00e5 0 \u00e5r (= 0-1 \u00e5r)\r\ntabulate botid\r\n\r\n// lager botid-kategorier\r\ngenerate botid_kat = '0: Personer uten botid'\r\nreplace botid_kat = '1: Maks 5 \u00e5r' if botid <= 5 // maks 5 \u00e5r\r\nreplace botid_kat = '2: 6-10 \u00e5r' if botid > 5 & botid <= 10 // 6-10 \u00e5r\r\nreplace botid_kat = '3: Over 10 \u00e5r' if botid > 10 // minst 10 \u00e5r\r\ntabulate botid_kat, missing\r\n\r\n// aggregerer landbakgrunn til verdensregion\r\nclone-variables landbakgrunn -> verdensregion // backup for kontroll etter omkoding\r\ndestring verdensregion // destring til numerisk variabel (kreves ved recode)\r\ndrop if verdensregion == 990 // Uoppgitt land, for f\u00e5 personer\r\nrecode verdensregion (101/106 = 1) (111/142 144/199 500 = 2) (203/399 = 3) (143 404/496 502/599 802/899 = 4) (612 684 = 5) (601/799 = 6) (980 = 8) (990 = 9)\r\ndefine-labels vregion 0 'Norge' 1 'Norden' 2 'Resten av Europa' 3 'Afrika' 4 'Midt\u00f8sten, Asia, Oseania' 5 'USA+Canada' 6 'Latin-Amerika' 8 'Statsl\u00f8se' 9 'Uoppgitt'\r\nassign-labels verdensregion vregion\r\ntabulate landbakgrunn verdensregion // sjekk ny og gammel koding\r\n\r\n// utvalgte landbakgrunner\r\ngenerate landbakgrunn_utvalg = landbakgrunn \r\ndestring landbakgrunn_utvalg\r\nrecode landbakgrunn_utvalg (0 = 0 'Norge') (148 = 1 'Ukraina') (241 = 2 'Eritrea') (564 = 3 'Syria') (404 = 4 'Afghanistan') (346 = 5 'Somalia') (452 = 6 'Irak') (106 = 7 'Sverige') (1/990 = 9 'Andre land')\r\ntabulate landbakgrunn_utvalg, missing\r\n\r\n\r\n\r\n// ------------------ Sosialhjelpsmottakere ------------------\r\n// 2023: sosialhjelpsmottakere\r\ncreate-dataset sosialhjelp_2023\r\nimport-event ds/SOSHJLPZFDT_MNDUTBET 2023-01-01 to 2023-12-31 as sosial_2023 \r\ngenerate mottaker_2023 = 1 if sosial_2023 > 0\r\ngenerate langtidsmottaker_2023 = 1 if sosial_2023 >= 6\r\ntabulate langtidsmottaker_2023 mottaker_2023, missing\r\n// 61 027 personer er langtidsmottakere. Dette er n\u00e6r fasit: 60 084.\r\n\r\n// collapse til personer\r\ncollapse (sum) sosial_2023 (sum) langtidsmottaker_2023 (sum) mottaker_2023, by(PERSONID_1)\r\n// merge med hoveddata\r\nmerge sosial_2023 langtidsmottaker_2023 mottaker_2023 into data\r\ntabulate langtidsmottaker_2023 mottaker_2023, missing\r\n\r\n\r\n// 2022: sosialhjelpsmottakere\r\ncreate-dataset sosialhjelp_2022\r\nimport-event ds/SOSHJLPZFDT_MNDUTBET 2022-01-01 to 2022-12-31 as sosial_2022\r\ngenerate mottaker_2022 = 1 if sosial_2022 > 0\r\ngenerate langtidsmottaker_2022 = 1 if sosial_2022 >= 6\r\ntabulate langtidsmottaker_2022 mottaker_2022, missing\r\n// collapse til personer\r\ncollapse (sum) sosial_2022 (sum) langtidsmottaker_2022 (sum) mottaker_2022, by(PERSONID_1)\r\n// merge med hoveddata\r\nmerge sosial_2022 langtidsmottaker_2022 mottaker_2022 into data\r\ntabulate langtidsmottaker_2022 mottaker_2022, missing\r\n\r\n\r\n// 2021: sosialhjelpsmottakere\r\ncreate-dataset sosialhjelp_2021\r\nimport-event ds/SOSHJLPZFDT_MNDUTBET 2021-01-01 to 2021-12-31 as sosial_2021\r\ngenerate mottaker_2021 = 1 if sosial_2021 > 0\r\ngenerate langtidsmottaker_2021 = 1 if sosial_2021 >= 6\r\ntabulate langtidsmottaker_2021 mottaker_2021, missing\r\n// collapse til personer\r\ncollapse (sum) sosial_2021 (sum) langtidsmottaker_2021 (sum) mottaker_2021, by(PERSONID_1)\r\n// merge med hoveddata\r\nmerge sosial_2021 langtidsmottaker_2021 mottaker_2021 into data\r\ntabulate langtidsmottaker_2021 mottaker_2021, missing\r\n\r\n\r\n// 2020: sosialhjelpsmottakere\r\ncreate-dataset sosialhjelp_2020\r\nimport-event ds/SOSHJLPZFDT_MNDUTBET 2020-01-01 to 2020-12-31 as sosial_2020\r\ngenerate mottaker_2020 = 1 if sosial_2020 > 0\r\ngenerate langtidsmottaker_2020 = 1 if sosial_2020 >= 6\r\ntabulate langtidsmottaker_2020 mottaker_2020, missing\r\n// collapse til personer\r\ncollapse (sum) sosial_2020 (sum) langtidsmottaker_2020 (sum) mottaker_2020, by(PERSONID_1)\r\n// merge med hoveddata\r\nmerge sosial_2020 langtidsmottaker_2020 mottaker_2020 into data\r\ntabulate langtidsmottaker_2020 mottaker_2020, missing\r\n\r\n\r\n// 2019: sosialhjelpsmottakere\r\ncreate-dataset sosialhjelp_2019\r\nimport-event ds/SOSHJLPZFDT_MNDUTBET 2019-01-01 to 2019-12-31 as sosial_2019\r\ngenerate mottaker_2019 = 1 if sosial_2019 > 0\r\ngenerate langtidsmottaker_2019 = 1 if sosial_2019 >= 6\r\ntabulate langtidsmottaker_2019 mottaker_2019, missing\r\n// collapse til personer\r\ncollapse (sum) sosial_2019 (sum) langtidsmottaker_2019 (sum) mottaker_2019, by(PERSONID_1)\r\ntabulate sosial_2019\r\n// merge med hoveddata\r\nmerge sosial_2019 langtidsmottaker_2019 mottaker_2019 into data\r\ntabulate langtidsmottaker_2019 mottaker_2019, missing\r\n\r\n// prep output-variabler\r\nuse data\r\ntabulate landbakgrunn_utvalg mottaker_2023, missing\r\n\r\n\r\n// mottakere etter mottakslengde\r\ngenerate mottak_2023 = '0: Ikke mottatt'\r\nreplace mottak_2023 = '1: Korttidsmottaker' if mottaker_2023\r\nreplace mottak_2023 = '2: Langtidsmottaker' if langtidsmottaker_2023\r\n// output:\r\ntabulate kommune mottak_2023, flatten\r\n\r\n// -------------- Mottaksgrupper ----------\r\n// INNVANDRERE\r\ngenerate mottaksgruppe_innv = langtidsmottaker_2023\r\ntabulate mottaksgruppe_innv\r\nreplace mottaksgruppe_innv = 2 if langtidsmottaker_2023 & innvkat == 1\r\nreplace mottaksgruppe_innv = 3 if langtidsmottaker_2023 == 0 & innvkat == 1\r\ndefine-labels mottaker_innv 0 'Korttid rest' 1 'Langtid rest' 2 'Langtid innvandrere' 3 'Korttid innvandrere' \r\nassign-labels mottaksgruppe_innv mottaker_innv\r\ntabulate mottaksgruppe_innv\r\n// OUTPUT: mottaksrater justert for innvandrere\r\ntabulate kommune mottaksgruppe_innv, flatten\r\ntabulate kommune innvkat, missing flatten // kontroll: fordeling i kommunen\r\n\r\n// FLUKT\r\ngenerate mottaksgruppe_flu = langtidsmottaker_2023\r\ntabulate mottaksgruppe_flu\r\nreplace mottaksgruppe_flu = 2 if langtidsmottaker_2023 & innvandringsgrunn == 'FLU'\r\nreplace mottaksgruppe_flu = 3 if langtidsmottaker_2023 == 0 & innvandringsgrunn == 'FLU'\r\ndefine-labels mottaker_flu 0 'Korttid rest' 1 'Langtid rest' 2 'Langtid flukt' 3 'Korttid flukt' \r\nassign-labels mottaksgruppe_flu mottaker_flu\r\ntabulate mottaksgruppe_flu\r\n// OUTPUT: mottaksrater justert for flukt\r\ntabulate kommune mottaksgruppe_flu, flatten\r\ntabulate kommune innvandringsgrunn, missing flatten\r\n\r\n\r\n// Innvandrere, LANDUTVALG\r\ngenerate mottaksgruppe_land = langtidsmottaker_2023 if innvkat == 1\r\ntabulate mottaksgruppe_land\r\ntabulate landbakgrunn_utvalg\r\nreplace mottaksgruppe_land = 2 if langtidsmottaker_2023 & innvkat == 1 & inrange(landbakgrunn_utvalg, 1, 6)\r\nreplace mottaksgruppe_land = 3 if langtidsmottaker_2023 & innvkat == 1 & inlist(landbakgrunn_utvalg, 0, 9)\r\ntabulate mottaksgruppe_land\r\ntabulate mottaksgruppe_land landbakgrunn_utvalg\r\n\r\ndefine-labels mottaker_landutvalg 0 'Korttid innv' 1 'Langtid innv' 2 'Langtid innv landutvalg' 3 'Langtid innv andre land' \r\nassign-labels mottaksgruppe_land mottaker_landutvalg\r\ntabulate mottaksgruppe_land\r\n\r\n// OUTPUT: innvandreres mottaksrater justert for utvalgte land\r\ntabulate kommune mottaksgruppe_land, flatten\r\ntabulate kommune landbakgrunn_utvalg if innvkat == 1, flatten\r\n\r\n\r\n\r\n// mottakere etter innvandringskategori\r\ngenerate mottaker_invkat = 0\r\nreplace mottaker_invkat = 1 if mottaker_2023 & innvkat == 0  // A: Maj\r\nreplace mottaker_invkat = 2 if mottaker_2023 & innvkat == 1  // B: Innvandrere\r\nreplace mottaker_invkat = 3 if mottaker_2023 & innvkat == 2  // C: norskf\u00f8dte med innvandrerforeldre\r\n\r\ntabulate kommune innvkat\r\n\r\n// mottakere etter innvandringsgrunn\r\ngenerate mottaker_innvandringsgrunn = 0 \r\nreplace mottaker_innvandringsgrunn = 1 if mottaker_2023 & innvandringsgrunn == 'FLU'  // flyktninger\r\nreplace mottaker_innvandringsgrunn = 2 if mottaker_2023 & innvandringsgrunn == 'ARB'  // arbeidsinnvandrere\r\nreplace mottaker_innvandringsgrunn = 3 if mottaker_2023 & innvandringsgrunn == 'FAM'  // familiegjenforente\r\n\r\ntabulate kommune mottaker_invkat\r\ntabulate kommune mottaker_innvandringsgrunn\r\n\r\n// OUTPUT: antall mottakere\r\ntabulate kommune mottaker_2023, flatten\r\ntabulate kommune mottaker_2022, flatten\r\ntabulate kommune mottaker_2021, flatten\r\ntabulate kommune mottaker_2020, flatten\r\ntabulate kommune mottaker_2019, flatten\r\n\r\n// OUTPUT: n mottaksm\u00e5neder -- lage fordeling? ridge plot innad i KOSTRA-grupper?\r\ntabulate kommune sosial_2023, flatten\r\ntabulate kommune sosial_2022, flatten\r\ntabulate kommune sosial_2021, flatten\r\ntabulate kommune sosial_2020, flatten\r\ntabulate kommune sosial_2019, flatten\r\n\r\n\r\n// OUTPUT: n mottaksm\u00e5neder, antall mottakere, n langtidsmottakere\r\ntabulate kommune langtidsmottaker_2023, flatten\r\ntabulate kommune langtidsmottaker_2022, flatten\r\ntabulate kommune langtidsmottaker_2021, flatten\r\ntabulate kommune langtidsmottaker_2020, flatten\r\ntabulate kommune langtidsmottaker_2019, flatten\r\n\r\n\r\n// Gjengangere\r\n// vi kan her definere gjengangere som mottakere i 2023 som ogs\u00e5 fikk sosialhjelp i minst ett av de forrige fire \u00e5rene\r\ngenerate gjenganger_2022 = 0\r\nreplace gjenganger_2022 = 1 if mottaker_2023 & mottaker_2022\r\n\r\ngenerate gjenganger_2021 = 1 if mottaker_2023 & mottaker_2021\r\nreplace gjenganger_2021 = 0 if mottaker_2023 & sysmiss(mottaker_2021)\r\n\r\ngenerate gjenganger_2020 = 1 if mottaker_2023 & mottaker_2020\r\nreplace gjenganger_2020 = 0 if mottaker_2023 & sysmiss(mottaker_2020)\r\n\r\ngenerate gjenganger_2019 = 1 if mottaker_2023 & mottaker_2019\r\nreplace gjenganger_2019 = 0 if mottaker_2023 & sysmiss(mottaker_2019)\r\n\r\nsummarize mottaker_2023  // 148 000 mottakere i 2023. dette er i n\u00e6rheten av SSB-tallet 152600\r\ntabulate mottaker_2023 mottaker_2022, missing  \r\ntabulate gjenganger_2022 mottaker_2022, missing  // korrekt: mottakere begge \u00e5r er gjenganger = 1\r\ntabulate gjenganger_2022 mottaker_2023, missing\r\ntabulate gjenganger_2022 gjenganger_2021, missing // 52k er gjengangere begge \u00e5r (alts\u00e5 mottatt 3 \u00e5r p\u00e5 rad)\r\n\r\nsankey mottaker_2023 gjenganger_2022 gjenganger_2021 gjenganger_2020 gjenganger_2019\r\nsankey mottaker_2023 mottaker_2022 mottaker_2021 mottaker_2020 mottaker_2019\r\n\r\n// gjenganger\r\ngenerate gjenganger_2023_2019 = 1 if gjenganger_2022 | gjenganger_2021 | gjenganger_2020 | gjenganger_2019\r\ntabulate gjenganger_2023_2019 mottaker_2023, missing\r\n\r\n// -------------- Logit: Sannsynlighet for \u00e5 v\u00e6re mottaker --------------\r\n// variabler til logit: \r\nkeep if alder < 67\r\n\r\n// import sysselsettingsdata for \u00e5 redusere populasjonen tidlig\r\nimport ds/REGSYS_ARB_ARBMARK_STATUS 2023-11-16 as jobb2023\r\ndestring jobb2023\r\n\r\nimport ds/REGSYS_ARB_ARBMARK_STATUS 2022-11-16 as jobb2022\r\nimport ds/REGSYS_ARB_ARBMARK_STATUS 2022-11-16 as jobb2020\r\nimport ds/REGSYS_ARB_ARBMARK_STATUS 2022-11-16 as jobb2021\r\nimport ds/REGSYS_ARB_ARBMARK_STATUS 2022-11-16 as jobb2019\r\ndestring jobb2022\r\ndestring jobb2021\r\ndestring jobb2020\r\ndestring jobb2019\r\n\r\n// import kj\u00f8nn\r\nimport ds/BEFOLKNING_KJOENN as kjonn \r\ngenerate mann = kjonn == '1'\r\ngenerate innvandrer = innvkat == 1\r\n\r\nimport ds/SIVSTANDFDT_SIVSTAND 2023-01-01 as sivstand\r\ngenerate gift = sivstand == '2'\r\n\r\nimport ds/BEFOLKNING_BARN_I_REGSTAT_FAMNR 2023-01-01 as barn\r\ngenerate barn_flere = barn > 1\r\ngenerate barn_ett = barn == 1\r\n\r\nimport ds/NUDB_BU 2023-01-01 as utdanning\r\ndestring utdanning\r\ngenerate utdanning_h\u00f8y = inrange(utdanning,700000,899999)\r\n\r\nimport ds/NUDB_SOSBAK as sosbakgrunn\r\ntabulate sosbakgrunn\r\ngenerate h\u00f8yutd_foreldre = sosbakgrunn == '1'\r\npiechart h\u00f8yutd_foreldre\r\n\r\n// formue\r\nimport ds/SKATT_BRUTTOFORMUE 2022-12-31 as formue\r\ngenerate formue_over100k = formue > 100000\r\ntabulate formue_over100k, missing\r\nreplace formue = formue / 100000\r\nhistogram formue if formue < 20 // under 2 mill\r\n// inntekt\r\nimport ds/INNTEKT_WYRKINNT 2022-12-31 as inntekt_2023\r\n\r\n// arbeidss\u00f8kere fra NAV\r\nimport ds/ARBSOEK2001FDT_HOVED 2023-01-01 as arbs\u00f8kerstatus_2023\r\ndestring arbs\u00f8kerstatus_2023\r\ngenerate ledig = arbs\u00f8kerstatus_2023 == 1\r\ngenerate tiltak = arbs\u00f8kerstatus_2023 == 3\r\ngenerate yrkeshemmet = arbs\u00f8kerstatus_2023 == 5 | arbs\u00f8kerstatus_2023 >= 10\r\ngenerate arbs\u00f8k_andre = arbs\u00f8kerstatus_2023 == 2 | arbs\u00f8kerstatus_2023 == 4 | arbs\u00f8kerstatus_2023 == 7 \r\n// uf\u00f8re\r\nimport ds/UFOERP2011FDT_GRAD 2023-01-01 as uf\u00f8regrad\r\ngenerate uf\u00f8r = !sysmiss(uf\u00f8regrad)\r\n\r\n// mer marginaliserte: hva med de som aldri var l\u00f8nnstakere?\r\ncreate-dataset aordningen_2019\r\nimport-event ds/ARBLONN_ARB_ARBMARK_STATUS 2019-01-16 to 2019-12-16 as lonnstaker\r\n// collapse: antall m\u00e5neder med registrert arbeid per jobb\r\ncollapse (count) lonnstaker -> lonnstaker_2019, by(JOBBID_1)\r\n// i forl\u00f8psdatasett m\u00e5 en f\u00f8rst collapse til enhetstype JOBBID f\u00f8r en kan importere nye variabler\r\nimport ds/ARBEIDSFORHOLD_PERSON as personid\r\n// collapse: maks m\u00e5neder hver person er l\u00f8nnstaker\r\ncollapse (max) lonnstaker_2019, by(personid)\r\ntabulate lonnstaker_2019  // 3.1M l\u00f8nnstakere\r\nmerge lonnstaker_2019 into data\r\n\r\n// l\u00f8nnstakere 2023\r\ncreate-dataset aordningen_2023\r\nimport-event ds/ARBLONN_ARB_ARBMARK_STATUS 2023-01-16 to 2023-12-16 as lonnstaker\r\n// collapse: antall m\u00e5neder med registrert arbeid per jobb\r\ncollapse (count) lonnstaker -> lonnstaker_2023, by(JOBBID_1)\r\n// i forl\u00f8psdatasett m\u00e5 en f\u00f8rst collapse til enhetstype JOBBID f\u00f8r en kan importere nye variabler\r\nimport ds/ARBEIDSFORHOLD_PERSON as personid\r\n// collapse: maks m\u00e5neder hver person er l\u00f8nnstaker\r\ncollapse (max) lonnstaker_2023, by(personid)\r\ntabulate lonnstaker_2023  // 3.1M l\u00f8nnstakere\r\nmerge lonnstaker_2023 into data\r\n\r\n// switch datasett og kryssjekk\r\nuse data\r\nrecode lonnstaker_2023 (1/12 = 1) \r\nreplace lonnstaker_2023 = 0 if sysmiss(lonnstaker_2023)\r\nrecode lonnstaker_2019 (1/12 = 1)\r\nreplace lonnstaker_2019 = 0 if sysmiss(lonnstaker_2019)\r\ntabulate lonnstaker_2023\r\ntabulate lonnstaker_2019\r\n\r\n// dette er n\u00f8yaktig samme syntaks som for \u00e5 hente mottakere. \r\n// kryssjekk mot annen offentlig statistikk? hvor mange var l\u00f8nnstakere i minst 1 mnd i 2019?\r\n// TODO: estimater av arbeidsledighet i befolkningen 18-66 \u00e5r er en n\u00f8tt. hvordan finne riktig nevner = hele arbeidstyrken?\r\ntabulate jobb2023, cellpct\r\ntabulate jobb2023 jobb2022, missing\r\ntabulate lonnstaker_2019 jobb2019, missing\r\n\r\n// vedvarende sysselsatte\r\ngenerate jobb2023_2022 = 0\r\nreplace jobb2023_2022 = 1 if inrange(jobb2023, 1,2) & inrange(jobb2022, 1,2)\r\ntabulate jobb2023_2022 jobb2023, missing\r\ntabulate jobb2023_2022, missing\r\n\r\nbarchart(sum) ledig tiltak yrkeshemmet arbs\u00f8k_andre uf\u00f8r\r\n\r\n// reduser datasettet for logit: personer med D-nummer har ingen informasjon p\u00e5 andre variabler\r\n// sjekk missing: personer med D-nummer settes som innvandrer = 0\r\ntabulate innvandrer ident, missing\r\ntabulate ident regstat, missing\r\nkeep if regstat == '1'\r\n\r\n\r\n// tilrettelegger variabler for regresjonsmodell\r\ngenerate verdensregion_afrika = verdensregion == 3\r\ngenerate verdensregion_asia = verdensregion == 4\r\ngenerate verdensregion_latam = verdensregion == 6\r\ntabulate verdensregion_afrika verdensregion_asia\r\ngenerate flyktning = innvandringsgrunn == 'FLU'\r\ntabulate flyktning\r\ngenerate botid_dummy = 0\r\nreplace botid_dummy = 1 if botid < 3\r\n\r\nreplace inntekt_2023 = inntekt_2023/100000\r\ngenerate lav_inntekt = inntekt_2023 < 5 // 500k i \u00e5ret\r\nsummarize inntekt_2023\r\ntabulate lav_inntekt\r\ngenerate formue_over300k = formue > 300000\r\ngenerate formue_over200k = formue > 200000\r\n\r\n// logit: Sannsynlighet for \u00e5 v\u00e6re mottaker i 2023 \r\nreplace mottaker_2023 = 0 if sysmiss(mottaker_2023)\r\ntabulate mottaker_2023 // N = 141 000\r\n// drop if sysmiss(formue) // 120 000 droppet\r\n// drop if sysmiss(inntekt_2023) // 436 000 droppet\r\n// m\u00e5 kontrollere for arbeidsinnvandrere \r\ngenerate arbeidsinnvandrer = innvandringsgrunn == 'ARB'\r\ngenerate ukrainer = landbakgrunn_utvalg == 1\r\n\r\n// tabulate lonnstaker_2023 jobb2023_2022 if mottaker_2023 == 1 // 1000 vedvarende sysselsatte er ikke registrert som l\u00f8nnstakere. vi legger de til:\r\nreplace lonnstaker_2023 = 1 if jobb2023_2022 == 1\r\ngenerate etterkommer = innvandringskategori == 'C'\r\n\r\n// test model: separasjon i dataene?\r\nlogit mottaker_2023 innvandrer flyktning arbeidsinnvandrer inntekt_2023 lonnstaker_2023 formue alder mann gift barn, mfx(dydx) mfx_at(median)\r\n\r\n// f\u00f8lgende modell er uten innvandrer-variabel, og printer konstantledd\r\nlogit mottaker_2023 flyktning arbeidsinnvandrer inntekt_2023 lonnstaker_2023 formue alder mann gift barn, mfx(dydx) mfx_at(median)\r\n\r\n// \r\n\r\n// logit: Sannsynlighet for \u00e5 v\u00e6re mottaker i 2023\r\n// enkel modell\r\nlogit mottaker_2023 innvandrer etterkommer flyktning arbeidsinnvandrer inntekt_2023 lonnstaker_2023 formue alder mann gift barn, mfx(dydx) mfx_at(median)\r\n\r\n// full modell\r\nlogit mottaker_2023 etterkommer flyktning arbeidsinnvandrer ukrainer verdensregion_afrika verdensregion_asia verdensregion_latam i.botid_kat inntekt_2023 lonnstaker_2023 formue utdanning_h\u00f8y h\u00f8yutd_foreldre alder mann gift barn ledig tiltak uf\u00f8r yrkeshemmet arbs\u00f8k_andre, mfx(dydx) mfx_at(median)\r\n\r\n\r\n\r\n// logit: Sannsynlighet for \u00e5 v\u00e6re langtidsmottaker i 2023\r\ngenerate langtidsmottaker_2023_kat = langtidsmottaker_2023 \r\nreplace langtidsmottaker_2023_kat = 0 if sysmiss(langtidsmottaker_2023_kat)\r\ntabulate langtidsmottaker_2023_kat\r\n\r\ntabulate langtidsmottaker_2023_kat if sysmiss(innvandrer) == 0 & sysmiss(flyktning) == 0 & sysmiss(arbeidsinnvandrer) == 0 & sysmiss(inntekt_2023) == 0 & sysmiss(lonnstaker_2023) == 0 & sysmiss(formue) == 0 & sysmiss(alder) == 0 & sysmiss(mann) == 0 & sysmiss(gift) == 0 & sysmiss(barn) == 0\r\n\r\n// 56 700 langtidsmottakere. hvis vi dropper de med sysmiss formue og inntekt faller dette ti 19 000\r\n// simpel modell\r\nlogit langtidsmottaker_2023_kat innvandrer flyktning arbeidsinnvandrer inntekt_2023 lonnstaker_2023 formue alder mann gift barn, mfx(dydx) mfx_at(median)\r\n\r\nlogit langtidsmottaker_2023_kat flyktning arbeidsinnvandrer ukrainer verdensregion_afrika verdensregion_asia verdensregion_latam i.botid_kat inntekt_2023 lonnstaker_2023 formue utdanning_h\u00f8y h\u00f8yutd_foreldre alder mann gift barn ledig tiltak uf\u00f8r yrkeshemmet arbs\u00f8k_andre, mfx(dydx) mfx_at(median)\r\n// N = 2.6M\r\n\r\n\r\n\r\n\r\n// logit: Sannsynlighet for \u00e5 v\u00e6re gjenganger (mottakere i 2023 som har f\u00e5tt sosialhjelp mellom 2022-2019)\r\nreplace gjenganger_2023_2019 = 0 if sysmiss(gjenganger_2023_2019) & mottaker_2023 == 1\r\ntabulate gjenganger_2023_2019 mottaker_2023 \r\n\r\n// simpel modell\r\nlogit gjenganger_2023_2019 innvandrer etterkommer flyktning arbeidsinnvandrer inntekt_2023 lonnstaker_2023 formue alder mann gift barn, mfx(dydx) mfx_at(median)\r\n\r\n// gjenganger\r\nlogit gjenganger_2023_2019 etterkommer flyktning arbeidsinnvandrer ukrainer verdensregion_afrika verdensregion_asia verdensregion_latam i.botid_kat inntekt_2023 lonnstaker_2023 formue utdanning_h\u00f8y h\u00f8yutd_foreldre alder mann gift barn ledig tiltak uf\u00f8r yrkeshemmet arbs\u00f8k_andre, mfx(dydx) mfx_at(median)\r\n\r\n\r\n// OUTPUT: Kommunedata om gjengangere\r\n\r\ntabulate kommune gjenganger_2023_2019, flatten\r\ntabulate kommune gjenganger_2023_2019 if flyktning, flatten\r\ntabulate kommune gjenganger_2023_2019 if innvandrer, flatten\r\n\r\n\r\n\r\n// St\u00f8nad utbetalt: utgifter til sosialhjelp/mottaksbel\u00f8p\r\n// sosialhjelpsmottakerens mottatte bidrag/l\u00e5n i kroner i l\u00f8pet av rapporterings\u00e5ret\r\nimport ds/SOSHJLPZFDT_BIDB 2023-12-31 as sh_bidrag_2023 \r\nimport ds/SOSHJLPZFDT_LAAN 2023-12-31 as sh_laan_2023\r\n// import ds/SOSHJELPM_KOMMUNE 2023-12-31 as sh_utbetalingskommune // NB: ikke tilgjengelig for 2023.....\r\n\r\ntabulate kommune, summarize(sh_bidrag_2023) mean flatten // gjennomsnittlige utbetalinger per kommune. er dette langt unna st\u00f8nadssatsene?\r\ntabulate kommune, summarize(sh_bidrag_2023) sum flatten // totalsum bidrag: 8.84 mrd (8.84\u00d710^9)\r\n// det betyr at vi kanskje kan ignorere l\u00e5n?\r\ntabulate kommune, summarize(sh_laan_2023) sum flatten // totalsum l\u00e5n: 0.118 mrd (1.18\u00d710^8)\r\n// sum bidrag + l\u00e5n = 8,958 mrd. Fasit er 9,7 mrd NOK i 2023. Avviket skyldes at vi har avgrenset p\u00e5 alder og f-nr mm. \r\n\r\n// generate soshjelp_sum = sh_laan_2023 + sh_bidrag_2023\r\n// funker det \u00e5 summere? nei. \r\n\r\ntabulate kommune, summarize(sh_bidrag_2023) sum flatten\r\ntabulate innvandrer, summarize(sh_bidrag_2023) sum flatten\r\n\r\n\r\n// TODO: output andel av bidragene som kan forklares av innvandrermottakere\r\n// trenger mottakervariabel som skiller mellom langtid/korttid \r\n// og mottakervariabel som skiller mellom innvandrer/rest\r\ntabulate kommune innvandrer, summarize(sh_bidrag_2023) sum flatten\r\n\r\n\r\n\r\n// testing\r\ncreate-dataset kommunedata\r\nimport ds/BEFOLKNING_KOMMNR_FORMELL 2024-01-01 as kommune\r\nimport ds/SOSHJLPZFDT_BIDB 2023-12-31 as sh_bidrag_2023\r\nsummarize sh_bidrag_2023\r\n\r\ncollapse (sum) sh_bidrag_2023 -> sh_bidrag_kommune, by(kommune)\r\nmerge sh_bidrag_kommune into data on kommune\r\n\r\nuse data\r\ntabulate kommune sh_bidrag_kommune if kommune == '0301'\r\n\r\n\r\n\r\n\r\n// husholdningsinntekt/formue\r\n// create-dataset husholdning\r\n// import db/BEFOLKNING_REGSTAT_FAMNR 2023-01-01 as famnr\r\n// import db/INNTEKT_WYRKINNT 2023-01-01 as yrkesinnt\r\n// collapse (sum) yrkesinnt, by(famnr)\r\n// rename yrkesinnt familieinnt\r\n\r\n// // Kobler familieinntekt p\u00e5 persondatasettet (enhet = personer)\r\n// merge familieinnt into data on PERSONID_1"
  }
]